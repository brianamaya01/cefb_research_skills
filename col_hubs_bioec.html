<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-04-20">
<meta name="description" content="Explore Colombia’s enabling networks in bioeconomy: discover key phases, thematic focuses, and research areas">

<title>Bioeconomy enabling networks in Colombia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="col_hubs_bioec_files/libs/clipboard/clipboard.min.js"></script>
<script src="col_hubs_bioec_files/libs/quarto-html/quarto.js"></script>
<script src="col_hubs_bioec_files/libs/quarto-html/popper.min.js"></script>
<script src="col_hubs_bioec_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="col_hubs_bioec_files/libs/quarto-html/anchor.min.js"></script>
<link href="col_hubs_bioec_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="col_hubs_bioec_files/libs/quarto-html/quarto-syntax-highlighting-2486e1f0a3ee9ee1fc393803a1361cdb.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="col_hubs_bioec_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="col_hubs_bioec_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="col_hubs_bioec_files/libs/bootstrap/bootstrap-5bdc1ec511977dd36301403cf8f4f68d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script type="module" src="col_hubs_bioec_files/libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="col_hubs_bioec_files/libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#phases" id="toc-phases" class="nav-link active" data-scroll-target="#phases">Phases</a></li>
  <li><a href="#thematic-focus" id="toc-thematic-focus" class="nav-link" data-scroll-target="#thematic-focus">Thematic Focus</a></li>
  <li><a href="#research-lines" id="toc-research-lines" class="nav-link" data-scroll-target="#research-lines">Research Lines</a></li>
  <li><a href="#tool" id="toc-tool" class="nav-link" data-scroll-target="#tool">Tool</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Bioeconomy enabling networks in Colombia</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Bioeconomy</div>
    <div class="quarto-category">Departments</div>
    <div class="quarto-category">D3</div>
    <div class="quarto-category">Humboldt Institute</div>
  </div>
  </div>

<div>
  <div class="description">
    Explore Colombia’s enabling networks in bioeconomy: discover key phases, thematic focuses, and research areas
  </div>
</div>


<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 20, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>In Colombia, various Science, Technology, and Innovation (STI) networks have emerged as pivotal enablers for the bioeconomy, even when not directly dedicated to it. These networks provide supportive conditions that strengthen bioeconomic initiatives across different phases of development. Understanding and categorizing these networks allows for a clearer view of how bioeconomy-supportive platforms evolve and impact the sector. The following categories highlight the stages, thematic focuses, and research lines relevant to these platforms.</p>
<section id="phases" class="level2">
<h2 class="anchored" data-anchor-id="phases">Phases</h2>
<p>The strengthening of the bioeconomy can be categorized into the following phases:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="header">
<th>Phase Types</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Ideation</td>
<td>Platforms that originated as ideas but had limited influence on the bioeconomy</td>
</tr>
<tr class="even">
<td>Planning</td>
<td>Platforms presenting a structured pathway aimed at supporting the bioeconomy</td>
</tr>
<tr class="odd">
<td>Scaling</td>
<td>Platforms that provide planning and scale up bioeconomy-associated businesses</td>
</tr>
<tr class="even">
<td>Execution</td>
<td>Platforms that deploy resources to scale and support bioeconomy-focused businesses</td>
</tr>
<tr class="odd">
<td>Consolidation</td>
<td>Platforms that stabilize and strengthen bioeconomy-related businesses</td>
</tr>
</tbody>
</table>
</section>
<section id="thematic-focus" class="level2">
<h2 class="anchored" data-anchor-id="thematic-focus">Thematic Focus</h2>
<p>Thematic focus refers to the function or role that each platform plays in fulfilling the mission of its respective project, categorized as follows:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 86%">
</colgroup>
<thead>
<tr class="header">
<th>Thematic Types</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Connects</td>
<td>Platforms aimed at connecting stakeholders and information to strengthen the bioeconomy</td>
</tr>
<tr class="even">
<td>Tools</td>
<td>Platforms that connect and create tools to facilitate bioeconomic actions</td>
</tr>
<tr class="odd">
<td>Accelerates</td>
<td>Platforms that connect, provide tools, and mobilize resources to accelerate bioeconomic enterprises</td>
</tr>
</tbody>
</table>
</section>
<section id="research-lines" class="level2">
<h2 class="anchored" data-anchor-id="research-lines">Research Lines</h2>
<p>Research lines represent the economic sectors each platform targets, grounded in the core mission of each project. (For better visualization, select the research lines that most capture your interest.)</p>
<p>This framework outlines the structure of Colombia’s enabling networks for the bioeconomy, showcasing how various STI networks contribute to fostering and accelerating bioeconomic growth across distinct phases and through specialized thematic roles and research initiatives.</p>
</section>
<section id="tool" class="level2">
<h2 class="anchored" data-anchor-id="tool">Tool</h2>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="49" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 48;"><span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>d3 <span class="op">=</span> <span class="pp">require</span>(<span class="st">"d3@7"</span>)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>navio_npm <span class="op">=</span> <span class="pp">require</span>(<span class="st">"navio@0.0.75"</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>Inputs <span class="op">=</span> <span class="pp">require</span>(<span class="st">"@observablehq/inputs"</span>)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>htl <span class="op">=</span> <span class="pp">require</span>(<span class="st">"htl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="57" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 56;"><span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>aq <span class="op">=</span> {</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> aq <span class="op">=</span> <span class="cf">await</span> <span class="pp">require</span>(<span class="vs">`arquero@</span><span class="sc">${</span>aq_version<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add HTML table view method to tables</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>  <span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(aq<span class="op">.</span><span class="at">ColumnTable</span><span class="op">.</span><span class="at">prototype</span><span class="op">,</span> {</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">view</span>(options) { <span class="cf">return</span> <span class="fu">toView</span>(<span class="kw">this</span><span class="op">,</span> options)<span class="op">;</span> }</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> aq<span class="op">;</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="72" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 71;"><span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>aq_version <span class="op">=</span> <span class="st">'7.2.0'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="78" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 77;"><span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>op <span class="op">=</span> aq<span class="op">.</span><span class="at">op</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="83" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 82;"><span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>toView <span class="op">=</span> {</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> DEFAULT_LIMIT <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> DEFAULT_NULL <span class="op">=</span> value <span class="kw">=&gt;</span> <span class="vs">`&lt;span style="color: #999;"&gt;</span><span class="sc">${</span>value<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tableStyle <span class="op">=</span> <span class="st">'margin: 0; border-collapse: separate; border-spacing: 0; width: initial;'</span><span class="op">;</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cellStyle <span class="op">=</span> <span class="st">'padding: 1px 5px; white-space: nowrap; overflow-x: hidden; text-overflow: ellipsis; font-variant-numeric: tabular-nums;'</span><span class="op">;</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> rowStyle <span class="op">=</span> <span class="st">'border-bottom: 1px solid #eee;'</span><span class="op">;</span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>  <span class="co">// given an Arquero data table, provide an HTML table view</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">function</span>(dt<span class="op">,</span> opt <span class="op">=</span> {}) {</span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>    <span class="co">// permit shorthand for limit</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="kw">typeof</span> opt <span class="op">===</span> <span class="st">'number'</span>) opt <span class="op">=</span> { <span class="dt">limit</span><span class="op">:</span> opt }<span class="op">;</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>    <span class="co">// marshal cell color options</span></span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> color <span class="op">=</span> { <span class="op">...</span>opt<span class="op">.</span><span class="at">color</span> }<span class="op">;</span></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="kw">typeof</span> opt<span class="op">.</span><span class="at">color</span> <span class="op">===</span> <span class="st">'function'</span>) {</span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>      <span class="co">// if function, apply to all columns</span></span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>      dt<span class="op">.</span><span class="fu">columnNames</span>()<span class="op">.</span><span class="fu">forEach</span>(name <span class="kw">=&gt;</span> color[name] <span class="op">=</span> opt<span class="op">.</span><span class="at">color</span>)<span class="op">;</span></span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a>      <span class="co">// otherwise, gather per-column color options</span></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (<span class="kw">const</span> key <span class="kw">in</span> color) {</span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> value <span class="op">=</span> color[key]<span class="op">;</span></span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>        color[key] <span class="op">=</span> <span class="kw">typeof</span> value <span class="op">===</span> <span class="st">'function'</span> <span class="op">?</span> value <span class="op">:</span> () <span class="kw">=&gt;</span> value<span class="op">;</span></span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>    <span class="co">// marshal CSS styles as toHTML() options</span></span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> table <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>tableStyle<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> cell <span class="op">=</span> (name<span class="op">,</span> index<span class="op">,</span> row<span class="op">,</span> th) <span class="kw">=&gt;</span> {</span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>cellStyle<span class="sc">}</span><span class="vs"> max-width: </span><span class="sc">${</span><span class="op">+</span>opt<span class="op">.</span><span class="at">maxCellWidth</span> <span class="op">||</span> <span class="dv">300</span><span class="sc">}</span><span class="vs">px;`</span></span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> <span class="vs">` border-bottom: solid 1px </span><span class="sc">${</span>th <span class="op">?</span> <span class="st">'#ccc'</span> <span class="op">:</span> <span class="st">'#eee'</span><span class="sc">}</span><span class="vs">;`</span></span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> (color[name] <span class="op">?</span> <span class="vs">` background-color: </span><span class="sc">${</span>color[name](index<span class="op">,</span> row)<span class="sc">}</span><span class="vs">;`</span> <span class="op">:</span> <span class="st">''</span>)<span class="op">;</span></span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> td <span class="op">=</span> (name<span class="op">,</span> index<span class="op">,</span> row) <span class="kw">=&gt;</span> <span class="fu">cell</span>(name<span class="op">,</span> index<span class="op">,</span> row<span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> th <span class="op">=</span> (name<span class="op">,</span> index<span class="op">,</span> row) <span class="kw">=&gt;</span> <span class="vs">`position: sticky; top: 0; background: #fff; `</span></span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> <span class="fu">cell</span>(name<span class="op">,</span> index<span class="op">,</span> row<span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>    opt <span class="op">=</span> {</span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>      <span class="dt">limit</span><span class="op">:</span> DEFAULT_LIMIT<span class="op">,</span></span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>      <span class="dt">null</span><span class="op">:</span> DEFAULT_NULL<span class="op">,</span></span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>opt<span class="op">,</span></span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>      <span class="dt">style</span><span class="op">:</span> { table<span class="op">,</span> td<span class="op">,</span> th }</span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a>    <span class="co">// return container div, bind table value to support viewof operator</span></span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> size <span class="op">=</span> <span class="vs">`max-height: </span><span class="sc">${</span><span class="op">+</span>opt<span class="op">.</span><span class="at">height</span> <span class="op">||</span> <span class="dv">270</span><span class="sc">}</span><span class="vs">px`</span><span class="op">;</span></span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> style <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>size<span class="sc">}</span><span class="vs">; overflow-x: auto; overflow-y: auto;`</span><span class="op">;</span></span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> view <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div style="</span><span class="sc">${</span>style<span class="sc">}</span><span class="vs">"&gt;</span><span class="sc">${</span>dt<span class="op">.</span><span class="fu">toHTML</span>(opt)<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(view<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> dt })<span class="op">;</span></span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="137" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 136;"><span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">Scrubber</span>(values<span class="op">,</span> {</span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a>  format <span class="op">=</span> value <span class="kw">=&gt;</span> value<span class="op">,</span></span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a>  initial <span class="op">=</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a>  direction <span class="op">=</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a>  delay <span class="op">=</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a>  autoplay <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a>  loop <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a>  loopDelay <span class="op">=</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a>  alternate <span class="op">=</span> <span class="kw">false</span></span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a>} <span class="op">=</span> {}) {</span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a>  values <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(values)<span class="op">;</span></span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> form <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;form style="font: 12px var(--sans-serif); font-variant-numeric: tabular-nums; display: flex; height: 33px; align-items: center;"&gt;</span></span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;button name=b type=button style="margin-right: 0.4em; width: 5em;"&gt;&lt;/button&gt;</span></span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;label style="display: flex; align-items: center;"&gt;</span></span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;input name=i type=range min=0 max=</span><span class="sc">${</span>values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span><span class="sc">}</span><span class="vs"> value=</span><span class="sc">${</span>initial<span class="sc">}</span><span class="vs"> step=1 style="width: 180px;"&gt;</span></span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;output name=o style="margin-left: 0.4em;"&gt;&lt;/output&gt;</span></span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/label&gt;</span></span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/form&gt;`</span><span class="op">;</span></span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> frame <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> timer <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> interval <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">start</span>() {</span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">"Pause"</span><span class="op">;</span></span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (delay <span class="op">===</span> <span class="kw">null</span>) frame <span class="op">=</span> <span class="fu">requestAnimationFrame</span>(tick)<span class="op">;</span></span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> interval <span class="op">=</span> <span class="pp">setInterval</span>(tick<span class="op">,</span> delay)<span class="op">;</span></span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">stop</span>() {</span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">"Play"</span><span class="op">;</span></span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (frame <span class="op">!==</span> <span class="kw">null</span>) <span class="fu">cancelAnimationFrame</span>(frame)<span class="op">,</span> frame <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (timer <span class="op">!==</span> <span class="kw">null</span>) <span class="pp">clearTimeout</span>(timer)<span class="op">,</span> timer <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (interval <span class="op">!==</span> <span class="kw">null</span>) <span class="pp">clearInterval</span>(interval)<span class="op">,</span> interval <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">running</span>() {</span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> frame <span class="op">!==</span> <span class="kw">null</span> <span class="op">||</span> timer <span class="op">!==</span> <span class="kw">null</span> <span class="op">||</span> interval <span class="op">!==</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">tick</span>() {</span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">===</span> (direction <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">:</span> direction <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> <span class="kw">NaN</span>)) {</span>
<span id="cb6-174"><a href="#cb6-174" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>loop) <span class="cf">return</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb6-175"><a href="#cb6-175" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (alternate) direction <span class="op">=</span> <span class="op">-</span>direction<span class="op">;</span></span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (loopDelay <span class="op">!==</span> <span class="kw">null</span>) {</span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (frame <span class="op">!==</span> <span class="kw">null</span>) <span class="fu">cancelAnimationFrame</span>(frame)<span class="op">,</span> frame <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (interval <span class="op">!==</span> <span class="kw">null</span>) <span class="pp">clearInterval</span>(interval)<span class="op">,</span> interval <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-179"><a href="#cb6-179" aria-hidden="true" tabindex="-1"></a>        timer <span class="op">=</span> <span class="pp">setTimeout</span>(() <span class="kw">=&gt;</span> (<span class="fu">step</span>()<span class="op">,</span> <span class="fu">start</span>())<span class="op">,</span> loopDelay)<span class="op">;</span></span>
<span id="cb6-180"><a href="#cb6-180" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb6-182"><a href="#cb6-182" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-183"><a href="#cb6-183" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (delay <span class="op">===</span> <span class="kw">null</span>) frame <span class="op">=</span> <span class="fu">requestAnimationFrame</span>(tick)<span class="op">;</span></span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step</span>()<span class="op">;</span></span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-186"><a href="#cb6-186" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">step</span>() {</span>
<span id="cb6-187"><a href="#cb6-187" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">=</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">+</span> direction <span class="op">+</span> values<span class="op">.</span><span class="at">length</span>) <span class="op">%</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">oninput</span> <span class="op">=</span> <span class="bu">event</span> <span class="kw">=&gt;</span> {</span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">event</span> <span class="op">&amp;&amp;</span> <span class="bu">event</span><span class="op">.</span><span class="at">isTrusted</span> <span class="op">&amp;&amp;</span> <span class="fu">running</span>()) <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">value</span> <span class="op">=</span> values[form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span>]<span class="op">;</span></span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">o</span><span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="fu">format</span>(form<span class="op">.</span><span class="at">value</span><span class="op">,</span> form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span><span class="op">,</span> values)<span class="op">;</span></span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">running</span>()) <span class="cf">return</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a>    direction <span class="op">=</span> alternate <span class="op">&amp;&amp;</span> form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">===</span> values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">?</span> <span class="op">-</span><span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">=</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">+</span> direction) <span class="op">%</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a>    <span class="fu">start</span>()<span class="op">;</span></span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb6-202"><a href="#cb6-202" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">oninput</span>()<span class="op">;</span></span>
<span id="cb6-203"><a href="#cb6-203" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (autoplay) <span class="fu">start</span>()<span class="op">;</span></span>
<span id="cb6-204"><a href="#cb6-204" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb6-205"><a href="#cb6-205" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">disposal</span>(form)<span class="op">.</span><span class="fu">then</span>(stop)<span class="op">;</span></span>
<span id="cb6-206"><a href="#cb6-206" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form<span class="op">;</span></span>
<span id="cb6-207"><a href="#cb6-207" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="212" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 211;"><span id="cb7-212"><a href="#cb7-212" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">navio</span>(data<span class="op">,</span> _options <span class="op">=</span> {}) {</span>
<span id="cb7-213"><a href="#cb7-213" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> options <span class="op">=</span> {</span>
<span id="cb7-214"><a href="#cb7-214" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> <span class="dv">300</span><span class="op">,</span> <span class="co">// Navio's height</span></span>
<span id="cb7-215"><a href="#cb7-215" aria-hidden="true" tabindex="-1"></a>    <span class="dt">attribs</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="co">// array of attrib names to be used, leave as null for all of them</span></span>
<span id="cb7-216"><a href="#cb7-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-217"><a href="#cb7-217" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x0</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="co">//Where to start drawing navio in x</span></span>
<span id="cb7-218"><a href="#cb7-218" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y0</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span> <span class="co">//Where to start drawing navio in y, useful if your attrib names are too long</span></span>
<span id="cb7-219"><a href="#cb7-219" aria-hidden="true" tabindex="-1"></a>    <span class="dt">maxNumDistictForCategorical</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="co">// addAllAttribs uses this for deciding if an attribute is categorical (has less than     maxNumDistictForCategorical categories) or ordered</span></span>
<span id="cb7-220"><a href="#cb7-220" aria-hidden="true" tabindex="-1"></a>    <span class="dt">maxNumDistictForOrdered</span><span class="op">:</span> <span class="dv">90</span><span class="op">,</span> <span class="co">// addAllAttribs uses this for deciding if an attribute is ordered (has less than     maxNumDistictForCategorical categories) or text. Use    maxNumDistictForOrdered : Infinity for never choosing Text</span></span>
<span id="cb7-221"><a href="#cb7-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-222"><a href="#cb7-222" aria-hidden="true" tabindex="-1"></a>    <span class="dt">howManyItemsShouldSearchForNotNull</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span> <span class="co">// How many rows should addAllAttribs search to decide guess an attribute type</span></span>
<span id="cb7-223"><a href="#cb7-223" aria-hidden="true" tabindex="-1"></a>    <span class="dt">margin</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="co">// Margin around navio</span></span>
<span id="cb7-224"><a href="#cb7-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-225"><a href="#cb7-225" aria-hidden="true" tabindex="-1"></a>    <span class="dt">levelsSeparation</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span> <span class="co">// Separation between the levels</span></span>
<span id="cb7-226"><a href="#cb7-226" aria-hidden="true" tabindex="-1"></a>    <span class="dt">divisionsColor</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span> <span class="co">// Border color for the divisions</span></span>
<span id="cb7-227"><a href="#cb7-227" aria-hidden="true" tabindex="-1"></a>    <span class="dt">levelConnectionsColor</span><span class="op">:</span> <span class="st">"rgba(205, 220, 163, 0.5)"</span><span class="op">,</span> <span class="co">// Color for the conections between levels</span></span>
<span id="cb7-228"><a href="#cb7-228" aria-hidden="true" tabindex="-1"></a>    <span class="dt">divisionsThreshold</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span> <span class="co">// What's the minimum row height needed to draw divisions</span></span>
<span id="cb7-229"><a href="#cb7-229" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fmtCounts</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">",.0d"</span>)<span class="op">,</span> <span class="co">// Format used to display the counts on the bottom</span></span>
<span id="cb7-230"><a href="#cb7-230" aria-hidden="true" tabindex="-1"></a>    <span class="dt">legendFont</span><span class="op">:</span> <span class="st">"14px sans-serif"</span><span class="op">,</span> <span class="co">// The font for the header</span></span>
<span id="cb7-231"><a href="#cb7-231" aria-hidden="true" tabindex="-1"></a>    <span class="dt">nestedFilters</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// Should navio use nested levels?</span></span>
<span id="cb7-232"><a href="#cb7-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-233"><a href="#cb7-233" aria-hidden="true" tabindex="-1"></a>    <span class="dt">showAttribTitles</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// Show headers?</span></span>
<span id="cb7-234"><a href="#cb7-234" aria-hidden="true" tabindex="-1"></a>    <span class="dt">attribWidth</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span> <span class="co">// Width of the columns</span></span>
<span id="cb7-235"><a href="#cb7-235" aria-hidden="true" tabindex="-1"></a>    <span class="dt">attribRotation</span><span class="op">:</span> <span class="op">-</span><span class="dv">45</span><span class="op">,</span> <span class="co">// Headers rotation</span></span>
<span id="cb7-236"><a href="#cb7-236" aria-hidden="true" tabindex="-1"></a>    <span class="dt">attribFontSize</span><span class="op">:</span> <span class="dv">13</span><span class="op">,</span> <span class="co">// Headers font size</span></span>
<span id="cb7-237"><a href="#cb7-237" aria-hidden="true" tabindex="-1"></a>    <span class="dt">attribFontSizeSelected</span><span class="op">:</span> <span class="dv">32</span><span class="op">,</span> <span class="co">// Headers font size when mouse over</span></span>
<span id="cb7-238"><a href="#cb7-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-239"><a href="#cb7-239" aria-hidden="true" tabindex="-1"></a>    <span class="dt">filterFontSize</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="co">// Font size of the filters explanations on the bottom</span></span>
<span id="cb7-240"><a href="#cb7-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-241"><a href="#cb7-241" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tooltipFontSize</span><span class="op">:</span> <span class="dv">12</span><span class="op">,</span> <span class="co">// Font size for the tooltip</span></span>
<span id="cb7-242"><a href="#cb7-242" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tooltipBgColor</span><span class="op">:</span> <span class="st">"#b2ddf1"</span><span class="op">,</span> <span class="co">// Font color for tooltip background</span></span>
<span id="cb7-243"><a href="#cb7-243" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tooltipMargin</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> <span class="co">// How much to separate the tooltip from the cursor</span></span>
<span id="cb7-244"><a href="#cb7-244" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tooltipArrowSize</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="co">// How big is the arrow on the tooltip</span></span>
<span id="cb7-245"><a href="#cb7-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-246"><a href="#cb7-246" aria-hidden="true" tabindex="-1"></a>    <span class="dt">digitsForText</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="co">// How many digits to use for text attributes</span></span>
<span id="cb7-247"><a href="#cb7-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-248"><a href="#cb7-248" aria-hidden="true" tabindex="-1"></a>    <span class="dt">addAllAttribsRecursionLevel</span><span class="op">:</span> <span class="kw">Infinity</span><span class="op">,</span> <span class="co">// How many levels depth do we keep on adding nested attributes</span></span>
<span id="cb7-249"><a href="#cb7-249" aria-hidden="true" tabindex="-1"></a>    <span class="dt">addAllAttribsIncludeObjects</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// Should addAllAttribs include objects</span></span>
<span id="cb7-250"><a href="#cb7-250" aria-hidden="true" tabindex="-1"></a>    <span class="dt">addAllAttribsIncludeArrays</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// Should addAllAttribs include arrays</span></span>
<span id="cb7-251"><a href="#cb7-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-252"><a href="#cb7-252" aria-hidden="true" tabindex="-1"></a>    <span class="dt">nullColor</span><span class="op">:</span> <span class="st">"#ffedfd"</span><span class="op">,</span> <span class="co">// Color for null values</span></span>
<span id="cb7-253"><a href="#cb7-253" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorInterpolator</span><span class="op">:</span> d3<span class="op">.</span><span class="at">interpolateBlues</span><span class="op">,</span></span>
<span id="cb7-254"><a href="#cb7-254" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorInterpolatorDate</span><span class="op">:</span> d3<span class="op">.</span><span class="at">interpolatePurples</span><span class="op">,</span></span>
<span id="cb7-255"><a href="#cb7-255" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorInterpolatorDiverging</span><span class="op">:</span> d3<span class="op">.</span><span class="at">interpolateBrBG</span><span class="op">,</span></span>
<span id="cb7-256"><a href="#cb7-256" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorInterpolatorOrdered</span><span class="op">:</span> d3<span class="op">.</span><span class="at">interpolateOranges</span><span class="op">,</span></span>
<span id="cb7-257"><a href="#cb7-257" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorInterpolatorText</span><span class="op">:</span> d3<span class="op">.</span><span class="at">interpolateGreys</span><span class="op">,</span></span>
<span id="cb7-258"><a href="#cb7-258" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorRangeBoolean</span><span class="op">:</span> [<span class="st">"#a1d76a"</span><span class="op">,</span> <span class="st">"#e9a3c9"</span><span class="op">,</span> <span class="st">"white"</span>]<span class="op">,</span> <span class="co">//true false null</span></span>
<span id="cb7-259"><a href="#cb7-259" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorRangeSelected</span><span class="op">:</span> [<span class="st">"white"</span><span class="op">,</span> <span class="st">"#b5cf6b"</span>]<span class="op">,</span></span>
<span id="cb7-260"><a href="#cb7-260" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorCategorical</span><span class="op">:</span> d3<span class="op">.</span><span class="at">schemeCategory10</span><span class="op">,</span></span>
<span id="cb7-261"><a href="#cb7-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-262"><a href="#cb7-262" aria-hidden="true" tabindex="-1"></a>    <span class="dt">showSelectedAttrib</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// Display the attribute that shows if a row is selected</span></span>
<span id="cb7-263"><a href="#cb7-263" aria-hidden="true" tabindex="-1"></a>    <span class="dt">showSequenceIDAttrib</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// Display the attribute with the sequence ID</span></span>
<span id="cb7-264"><a href="#cb7-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-265"><a href="#cb7-265" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>_options</span>
<span id="cb7-266"><a href="#cb7-266" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb7-267"><a href="#cb7-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-268"><a href="#cb7-268" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> div <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div  style="display:block; overflow-x:scroll"&gt;&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb7-269"><a href="#cb7-269" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-270"><a href="#cb7-270" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Create the navio</span></span>
<span id="cb7-271"><a href="#cb7-271" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> nv <span class="op">=</span> <span class="fu">navio_npm</span>(d3<span class="op">.</span><span class="fu">select</span>(div)<span class="op">,</span> options<span class="op">.</span><span class="at">height</span>)<span class="op">;</span></span>
<span id="cb7-272"><a href="#cb7-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-273"><a href="#cb7-273" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> opt <span class="kw">in</span> options) {</span>
<span id="cb7-274"><a href="#cb7-274" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (opt <span class="op">===</span> <span class="st">"id"</span>) {</span>
<span id="cb7-275"><a href="#cb7-275" aria-hidden="true" tabindex="-1"></a>      nv<span class="op">.</span><span class="fu">id</span>(options[opt])<span class="op">;</span></span>
<span id="cb7-276"><a href="#cb7-276" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (opt <span class="op">!==</span> <span class="st">"attribs"</span>) {</span>
<span id="cb7-277"><a href="#cb7-277" aria-hidden="true" tabindex="-1"></a>      nv[opt] <span class="op">=</span> options[opt]<span class="op">;</span></span>
<span id="cb7-278"><a href="#cb7-278" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-279"><a href="#cb7-279" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-280"><a href="#cb7-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-281"><a href="#cb7-281" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add the data</span></span>
<span id="cb7-282"><a href="#cb7-282" aria-hidden="true" tabindex="-1"></a>  nv<span class="op">.</span><span class="fu">data</span>(data)<span class="op">;</span></span>
<span id="cb7-283"><a href="#cb7-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-284"><a href="#cb7-284" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (options<span class="op">.</span><span class="at">attribs</span>) {</span>
<span id="cb7-285"><a href="#cb7-285" aria-hidden="true" tabindex="-1"></a>    nv<span class="op">.</span><span class="fu">addAllAttribs</span>(options<span class="op">.</span><span class="at">attribs</span>)<span class="op">;</span></span>
<span id="cb7-286"><a href="#cb7-286" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb7-287"><a href="#cb7-287" aria-hidden="true" tabindex="-1"></a>    nv<span class="op">.</span><span class="fu">addAllAttribs</span>()<span class="op">;</span></span>
<span id="cb7-288"><a href="#cb7-288" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-289"><a href="#cb7-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-290"><a href="#cb7-290" aria-hidden="true" tabindex="-1"></a>  nv<span class="op">.</span><span class="fu">updateCallback</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb7-291"><a href="#cb7-291" aria-hidden="true" tabindex="-1"></a>    div<span class="op">.</span><span class="at">value</span> <span class="op">=</span> nv<span class="op">.</span><span class="fu">getVisible</span>()<span class="op">;</span></span>
<span id="cb7-292"><a href="#cb7-292" aria-hidden="true" tabindex="-1"></a>    div<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb7-293"><a href="#cb7-293" aria-hidden="true" tabindex="-1"></a>    <span class="co">// notify(div);</span></span>
<span id="cb7-294"><a href="#cb7-294" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb7-295"><a href="#cb7-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-296"><a href="#cb7-296" aria-hidden="true" tabindex="-1"></a>  div<span class="op">.</span><span class="at">value</span> <span class="op">=</span> data<span class="op">;</span></span>
<span id="cb7-297"><a href="#cb7-297" aria-hidden="true" tabindex="-1"></a>  div<span class="op">.</span><span class="at">nv</span> <span class="op">=</span> nv<span class="op">;</span></span>
<span id="cb7-298"><a href="#cb7-298" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> div<span class="op">;</span></span>
<span id="cb7-299"><a href="#cb7-299" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="305" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 304;"><span id="cb8-305"><a href="#cb8-305" aria-hidden="true" tabindex="-1"></a>data_hubs0 <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"Hubs_bioec_col2.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({ <span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span> })</span>
<span id="cb8-306"><a href="#cb8-306" aria-hidden="true" tabindex="-1"></a>data_hubs <span class="op">=</span> data_hubs0<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({ <span class="op">...</span>d<span class="op">,</span> <span class="dt">name</span><span class="op">:</span> d<span class="op">.</span><span class="at">platform</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"Bioeconomy"</span> }))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="311" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 310;"><span id="cb9-311"><a href="#cb9-311" aria-hidden="true" tabindex="-1"></a>dData <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>(data_hubs<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> [d<span class="op">.</span><span class="at">name</span><span class="op">,</span> d]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="317" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 316;"><span id="cb10-317"><a href="#cb10-317" aria-hidden="true" tabindex="-1"></a>hullColor <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleOrdinal</span>(</span>
<span id="cb10-318"><a href="#cb10-318" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">quantize</span>(</span>
<span id="cb10-319"><a href="#cb10-319" aria-hidden="true" tabindex="-1"></a>    colorInterpolator<span class="op">,</span></span>
<span id="cb10-320"><a href="#cb10-320" aria-hidden="true" tabindex="-1"></a>    tidyData<span class="op">.</span><span class="fu">groupby</span>(groupBy)<span class="op">.</span><span class="fu">count</span>()<span class="op">.</span><span class="fu">objects</span>()<span class="op">.</span><span class="at">length</span></span>
<span id="cb10-321"><a href="#cb10-321" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-322"><a href="#cb10-322" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="328" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 327;"><span id="cb11-328"><a href="#cb11-328" aria-hidden="true" tabindex="-1"></a>dConnections <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="334" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 333;"><span id="cb12-334"><a href="#cb12-334" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> {</span>
<span id="cb12-335"><a href="#cb12-335" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> n <span class="kw">of</span> dData<span class="op">.</span><span class="fu">values</span>()) {</span>
<span id="cb12-336"><a href="#cb12-336" aria-hidden="true" tabindex="-1"></a>    n<span class="op">.</span><span class="at">degree</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-337"><a href="#cb12-337" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-338"><a href="#cb12-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-339"><a href="#cb12-339" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> linksArray <span class="op">=</span> links<span class="op">.</span><span class="fu">objects</span>()<span class="op">;</span></span>
<span id="cb12-340"><a href="#cb12-340" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> l <span class="kw">of</span> linksArray) {</span>
<span id="cb12-341"><a href="#cb12-341" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> source <span class="op">=</span> dData<span class="op">.</span><span class="fu">get</span>(l<span class="op">.</span><span class="at">source</span>)<span class="op">;</span></span>
<span id="cb12-342"><a href="#cb12-342" aria-hidden="true" tabindex="-1"></a>    <span class="co">// target = dNodes.get(l.target);</span></span>
<span id="cb12-343"><a href="#cb12-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-344"><a href="#cb12-344" aria-hidden="true" tabindex="-1"></a>    source<span class="op">.</span><span class="at">cluster</span> <span class="op">=</span> l<span class="op">.</span><span class="at">target</span><span class="op">;</span></span>
<span id="cb12-345"><a href="#cb12-345" aria-hidden="true" tabindex="-1"></a>    <span class="co">// target.cluster = l.target;</span></span>
<span id="cb12-346"><a href="#cb12-346" aria-hidden="true" tabindex="-1"></a>    source<span class="op">.</span><span class="at">degree</span> <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb12-347"><a href="#cb12-347" aria-hidden="true" tabindex="-1"></a>    <span class="co">// target.degree += 1;</span></span>
<span id="cb12-348"><a href="#cb12-348" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-349"><a href="#cb12-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-350"><a href="#cb12-350" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> getOrCreateNode <span class="op">=</span> (name) <span class="kw">=&gt;</span> {</span>
<span id="cb12-351"><a href="#cb12-351" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> node <span class="op">=</span> dConnections<span class="op">.</span><span class="fu">get</span>(name)<span class="op">;</span></span>
<span id="cb12-352"><a href="#cb12-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-353"><a href="#cb12-353" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>node) {</span>
<span id="cb12-354"><a href="#cb12-354" aria-hidden="true" tabindex="-1"></a>      node <span class="op">=</span> {</span>
<span id="cb12-355"><a href="#cb12-355" aria-hidden="true" tabindex="-1"></a>        name<span class="op">,</span></span>
<span id="cb12-356"><a href="#cb12-356" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"Connection"</span><span class="op">,</span></span>
<span id="cb12-357"><a href="#cb12-357" aria-hidden="true" tabindex="-1"></a>        <span class="dt">cluster</span><span class="op">:</span> name<span class="op">,</span></span>
<span id="cb12-358"><a href="#cb12-358" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> width <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> width) <span class="op">/</span> <span class="dv">10</span><span class="op">,</span></span>
<span id="cb12-359"><a href="#cb12-359" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> fheight_node<span class="op">.</span><span class="at">height</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> fheight_node<span class="op">.</span><span class="at">height</span>) <span class="op">/</span> <span class="dv">10</span></span>
<span id="cb12-360"><a href="#cb12-360" aria-hidden="true" tabindex="-1"></a>      }<span class="op">;</span></span>
<span id="cb12-361"><a href="#cb12-361" aria-hidden="true" tabindex="-1"></a>      dConnections<span class="op">.</span><span class="fu">set</span>(name<span class="op">,</span> node)<span class="op">;</span></span>
<span id="cb12-362"><a href="#cb12-362" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-363"><a href="#cb12-363" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node<span class="op">;</span></span>
<span id="cb12-364"><a href="#cb12-364" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb12-365"><a href="#cb12-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-366"><a href="#cb12-366" aria-hidden="true" tabindex="-1"></a>  <span class="co">// --------- Filter Links and Nodes --------------</span></span>
<span id="cb12-367"><a href="#cb12-367" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> filteredLinks <span class="op">=</span> linksArray<span class="op">.</span><span class="fu">map</span>((l) <span class="kw">=&gt;</span> {</span>
<span id="cb12-368"><a href="#cb12-368" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb12-369"><a href="#cb12-369" aria-hidden="true" tabindex="-1"></a>      <span class="dt">source</span><span class="op">:</span> dData<span class="op">.</span><span class="fu">get</span>(l<span class="op">.</span><span class="at">source</span>)<span class="op">,</span></span>
<span id="cb12-370"><a href="#cb12-370" aria-hidden="true" tabindex="-1"></a>      <span class="dt">target</span><span class="op">:</span> <span class="fu">getOrCreateNode</span>(l<span class="op">.</span><span class="at">target</span>)</span>
<span id="cb12-371"><a href="#cb12-371" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb12-372"><a href="#cb12-372" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb12-373"><a href="#cb12-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-374"><a href="#cb12-374" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> filteredNodesObject <span class="op">=</span> filteredLinks<span class="op">.</span><span class="fu">reduce</span>(</span>
<span id="cb12-375"><a href="#cb12-375" aria-hidden="true" tabindex="-1"></a>    (p<span class="op">,</span> l) <span class="kw">=&gt;</span> {</span>
<span id="cb12-376"><a href="#cb12-376" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>p<span class="op">.</span><span class="at">set</span><span class="op">.</span><span class="fu">has</span>(l<span class="op">.</span><span class="at">source</span><span class="op">.</span><span class="at">name</span>)) {</span>
<span id="cb12-377"><a href="#cb12-377" aria-hidden="true" tabindex="-1"></a>        p<span class="op">.</span><span class="at">set</span><span class="op">.</span><span class="fu">add</span>(l<span class="op">.</span><span class="at">source</span><span class="op">.</span><span class="at">name</span>)<span class="op">;</span></span>
<span id="cb12-378"><a href="#cb12-378" aria-hidden="true" tabindex="-1"></a>        p<span class="op">.</span><span class="at">list</span><span class="op">.</span><span class="fu">push</span>(l<span class="op">.</span><span class="at">source</span>)<span class="op">;</span></span>
<span id="cb12-379"><a href="#cb12-379" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb12-380"><a href="#cb12-380" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>p<span class="op">.</span><span class="at">set</span><span class="op">.</span><span class="fu">has</span>(l<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">name</span>)) {</span>
<span id="cb12-381"><a href="#cb12-381" aria-hidden="true" tabindex="-1"></a>        p<span class="op">.</span><span class="at">set</span><span class="op">.</span><span class="fu">add</span>(l<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">name</span>)<span class="op">;</span></span>
<span id="cb12-382"><a href="#cb12-382" aria-hidden="true" tabindex="-1"></a>        p<span class="op">.</span><span class="at">list</span><span class="op">.</span><span class="fu">push</span>(l<span class="op">.</span><span class="at">target</span>)<span class="op">;</span></span>
<span id="cb12-383"><a href="#cb12-383" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb12-384"><a href="#cb12-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-385"><a href="#cb12-385" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> p<span class="op">;</span></span>
<span id="cb12-386"><a href="#cb12-386" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb12-387"><a href="#cb12-387" aria-hidden="true" tabindex="-1"></a>    { <span class="kw">set</span><span class="op">:</span> <span class="kw">new</span> <span class="bu">Set</span>()<span class="op">,</span> <span class="dt">list</span><span class="op">:</span> [] }</span>
<span id="cb12-388"><a href="#cb12-388" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb12-389"><a href="#cb12-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-390"><a href="#cb12-390" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Clusters is used for the hulls</span></span>
<span id="cb12-391"><a href="#cb12-391" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> clusters <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollups</span>(</span>
<span id="cb12-392"><a href="#cb12-392" aria-hidden="true" tabindex="-1"></a>    filteredLinks<span class="op">,</span></span>
<span id="cb12-393"><a href="#cb12-393" aria-hidden="true" tabindex="-1"></a>    (v) <span class="kw">=&gt;</span> v<span class="op">.</span><span class="fu">map</span>((l) <span class="kw">=&gt;</span> l<span class="op">.</span><span class="at">source</span>)<span class="op">.</span><span class="fu">concat</span>([v[<span class="dv">0</span>]<span class="op">.</span><span class="at">target</span>])<span class="op">,</span></span>
<span id="cb12-394"><a href="#cb12-394" aria-hidden="true" tabindex="-1"></a>    (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">name</span></span>
<span id="cb12-395"><a href="#cb12-395" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb12-396"><a href="#cb12-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-397"><a href="#cb12-397" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb12-398"><a href="#cb12-398" aria-hidden="true" tabindex="-1"></a>    <span class="dt">nodes</span><span class="op">:</span> filteredNodesObject<span class="op">.</span><span class="at">list</span><span class="op">,</span></span>
<span id="cb12-399"><a href="#cb12-399" aria-hidden="true" tabindex="-1"></a>    <span class="dt">links</span><span class="op">:</span> linksArray<span class="op">,</span></span>
<span id="cb12-400"><a href="#cb12-400" aria-hidden="true" tabindex="-1"></a>    <span class="dt">clusters</span><span class="op">:</span> clusters</span>
<span id="cb12-401"><a href="#cb12-401" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb12-402"><a href="#cb12-402" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="408" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 407;"><span id="cb13-408"><a href="#cb13-408" aria-hidden="true" tabindex="-1"></a>dateFmt <span class="op">=</span> d3<span class="op">.</span><span class="fu">timeParse</span>(<span class="st">"%m/%d/%y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb14" data-startfrom="414" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 413;"><span id="cb14-414"><a href="#cb14-414" aria-hidden="true" tabindex="-1"></a>tidyData <span class="op">=</span> aq</span>
<span id="cb14-415"><a href="#cb14-415" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">from</span>(data_hubs)</span>
<span id="cb14-416"><a href="#cb14-416" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">derive</span>({</span>
<span id="cb14-417"><a href="#cb14-417" aria-hidden="true" tabindex="-1"></a>    <span class="st">"research_line"</span><span class="op">:</span> (d) <span class="kw">=&gt;</span></span>
<span id="cb14-418"><a href="#cb14-418" aria-hidden="true" tabindex="-1"></a>      d[<span class="st">"research_line"</span>] <span class="op">===</span> <span class="kw">null</span> <span class="op">?</span> [<span class="kw">null</span>] <span class="op">:</span> op<span class="op">.</span><span class="fu">split</span>(d[<span class="st">"research_line"</span>]<span class="op">,</span> <span class="st">";"</span>)<span class="op">,</span></span>
<span id="cb14-419"><a href="#cb14-419" aria-hidden="true" tabindex="-1"></a>    <span class="st">"departments"</span><span class="op">:</span> (d) <span class="kw">=&gt;</span></span>
<span id="cb14-420"><a href="#cb14-420" aria-hidden="true" tabindex="-1"></a>      d[<span class="st">"departments"</span>] <span class="op">===</span> <span class="kw">null</span> <span class="op">?</span> [<span class="kw">null</span>] <span class="op">:</span> op<span class="op">.</span><span class="fu">split</span>(d[<span class="st">"departments"</span>]<span class="op">,</span> <span class="st">";"</span>)</span>
<span id="cb14-421"><a href="#cb14-421" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb14-422"><a href="#cb14-422" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">unroll</span>(<span class="st">"research_line"</span>)</span>
<span id="cb14-423"><a href="#cb14-423" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">unroll</span>(<span class="st">"departments"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb15" data-startfrom="429" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 428;"><span id="cb15-429"><a href="#cb15-429" aria-hidden="true" tabindex="-1"></a>links <span class="op">=</span> tidyData</span>
<span id="cb15-430"><a href="#cb15-430" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(aq<span class="op">.</span><span class="fu">escape</span>((d) <span class="kw">=&gt;</span> <span class="op">!</span>d<span class="op">.</span><span class="at">year</span> <span class="op">||</span> d<span class="op">.</span><span class="at">year</span> <span class="op">&lt;=</span> minDate)) <span class="co">// Filter by Date</span></span>
<span id="cb15-431"><a href="#cb15-431" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">derive</span>({</span>
<span id="cb15-432"><a href="#cb15-432" aria-hidden="true" tabindex="-1"></a>    <span class="dt">source</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">name</span><span class="op">,</span></span>
<span id="cb15-433"><a href="#cb15-433" aria-hidden="true" tabindex="-1"></a>    <span class="dt">target</span><span class="op">:</span> aq<span class="op">.</span><span class="fu">escape</span>((d) <span class="kw">=&gt;</span> d[groupBy])</span>
<span id="cb15-434"><a href="#cb15-434" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb15-435"><a href="#cb15-435" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">groupby</span>([<span class="st">"source"</span><span class="op">,</span> <span class="st">"target"</span>])</span>
<span id="cb15-436"><a href="#cb15-436" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">count</span>()</span>
<span id="cb15-437"><a href="#cb15-437" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">target</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">source</span>) <span class="co">// Ignore nulls</span></span>
<span id="cb15-438"><a href="#cb15-438" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(aq<span class="op">.</span><span class="fu">escape</span>((d) <span class="kw">=&gt;</span> selectedTargets<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">target</span>))) <span class="co">// Filter by selectedTarget</span></span>
<span id="cb15-439"><a href="#cb15-439" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">select</span>([<span class="st">"source"</span><span class="op">,</span> <span class="st">"target"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb16" data-startfrom="445" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 444;"><span id="cb16-445"><a href="#cb16-445" aria-hidden="true" tabindex="-1"></a>targets <span class="op">=</span> links</span>
<span id="cb16-446"><a href="#cb16-446" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">groupby</span>(<span class="st">"target"</span>)</span>
<span id="cb16-447"><a href="#cb16-447" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">count</span>()</span>
<span id="cb16-448"><a href="#cb16-448" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">rename</span>({ <span class="dt">target</span><span class="op">:</span> <span class="st">"name"</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb17" data-startfrom="453" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 452;"><span id="cb17-453"><a href="#cb17-453" aria-hidden="true" tabindex="-1"></a>sources <span class="op">=</span> links</span>
<span id="cb17-454"><a href="#cb17-454" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">groupby</span>(<span class="st">"source"</span>)</span>
<span id="cb17-455"><a href="#cb17-455" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">count</span>()</span>
<span id="cb17-456"><a href="#cb17-456" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">rename</span>({ <span class="dt">source</span><span class="op">:</span> <span class="st">"name"</span> })</span>
<span id="cb17-457"><a href="#cb17-457" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">derive</span>({ <span class="dt">type</span><span class="op">:</span> () <span class="kw">=&gt;</span> <span class="st">"Bioeconomy"</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb18" data-startfrom="462" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 461;"><span id="cb18-462"><a href="#cb18-462" aria-hidden="true" tabindex="-1"></a>col_names <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(data_hubs[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-18" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb19" data-startfrom="468" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 467;"><span id="cb19-468"><a href="#cb19-468" aria-hidden="true" tabindex="-1"></a>template_2 <span class="op">=</span> (inputs) <span class="kw">=&gt;</span> </span>
<span id="cb19-469"><a href="#cb19-469" aria-hidden="true" tabindex="-1"></a>  htl<span class="op">.</span><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb19-470"><a href="#cb19-470" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div class="styled-template-2"&gt;</span></span>
<span id="cb19-471"><a href="#cb19-471" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span><span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(inputs)<span class="sc">}</span></span>
<span id="cb19-472"><a href="#cb19-472" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/div&gt;</span></span>
<span id="cb19-473"><a href="#cb19-473" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;style&gt;</span></span>
<span id="cb19-474"><a href="#cb19-474" aria-hidden="true" tabindex="-1"></a><span class="vs">      .styled-template-2 {</span></span>
<span id="cb19-475"><a href="#cb19-475" aria-hidden="true" tabindex="-1"></a><span class="vs">        text-align: left;</span></span>
<span id="cb19-476"><a href="#cb19-476" aria-hidden="true" tabindex="-1"></a><span class="vs">        column-count: 2; /* Mantiene 2 columnas */</span></span>
<span id="cb19-477"><a href="#cb19-477" aria-hidden="true" tabindex="-1"></a><span class="vs">        column-gap: 20px; /* Espacio entre columnas */</span></span>
<span id="cb19-478"><a href="#cb19-478" aria-hidden="true" tabindex="-1"></a><span class="vs">        max-width: 600px; /* Ancho máximo del formulario */</span></span>
<span id="cb19-479"><a href="#cb19-479" aria-hidden="true" tabindex="-1"></a><span class="vs">        margin-left: 0; /* Alinea a la izquierda */</span></span>
<span id="cb19-480"><a href="#cb19-480" aria-hidden="true" tabindex="-1"></a><span class="vs">      }</span></span>
<span id="cb19-481"><a href="#cb19-481" aria-hidden="true" tabindex="-1"></a><span class="vs">      .styled-template-2 label {</span></span>
<span id="cb19-482"><a href="#cb19-482" aria-hidden="true" tabindex="-1"></a><span class="vs">        font-weight: bold;</span></span>
<span id="cb19-483"><a href="#cb19-483" aria-hidden="true" tabindex="-1"></a><span class="vs">        line-height: 200%;</span></span>
<span id="cb19-484"><a href="#cb19-484" aria-hidden="true" tabindex="-1"></a><span class="vs">      }</span></span>
<span id="cb19-485"><a href="#cb19-485" aria-hidden="true" tabindex="-1"></a><span class="vs">      .styled-template-2 label:not(div&gt;label)::after {</span></span>
<span id="cb19-486"><a href="#cb19-486" aria-hidden="true" tabindex="-1"></a><span class="vs">        content: ":";</span></span>
<span id="cb19-487"><a href="#cb19-487" aria-hidden="true" tabindex="-1"></a><span class="vs">      }</span></span>
<span id="cb19-488"><a href="#cb19-488" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/style&gt;</span></span>
<span id="cb19-489"><a href="#cb19-489" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb20" data-startfrom="495" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 494;"><span id="cb20-495"><a href="#cb20-495" aria-hidden="true" tabindex="-1"></a>template_4 <span class="op">=</span> (inputs) <span class="kw">=&gt;</span> </span>
<span id="cb20-496"><a href="#cb20-496" aria-hidden="true" tabindex="-1"></a>  htl<span class="op">.</span><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb20-497"><a href="#cb20-497" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div class="styled"&gt;</span></span>
<span id="cb20-498"><a href="#cb20-498" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span><span class="bu">Object</span><span class="op">.</span><span class="fu">entries</span>(inputs)<span class="op">.</span><span class="fu">map</span>(([key<span class="op">,</span> input]) <span class="kw">=&gt;</span> {</span>
<span id="cb20-499"><a href="#cb20-499" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Extract the label text from the input, if any, and remove it to prevent duplication</span></span>
<span id="cb20-500"><a href="#cb20-500" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> labelText <span class="op">=</span> input<span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'label'</span>) <span class="op">?</span> input<span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'label'</span>)<span class="op">.</span><span class="at">textContent</span> <span class="op">:</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb20-501"><a href="#cb20-501" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (input<span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'label'</span>)) input<span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'label'</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb20-502"><a href="#cb20-502" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb20-503"><a href="#cb20-503" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div class="input-group"&gt;</span></span>
<span id="cb20-504"><a href="#cb20-504" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;label&gt;</span><span class="sc">${</span>labelText<span class="sc">}</span><span class="vs">&lt;/label&gt;</span></span>
<span id="cb20-505"><a href="#cb20-505" aria-hidden="true" tabindex="-1"></a><span class="vs">            </span><span class="sc">${</span>input<span class="sc">}</span></span>
<span id="cb20-506"><a href="#cb20-506" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;/div&gt;</span></span>
<span id="cb20-507"><a href="#cb20-507" aria-hidden="true" tabindex="-1"></a><span class="vs">        `</span><span class="op">;</span></span>
<span id="cb20-508"><a href="#cb20-508" aria-hidden="true" tabindex="-1"></a>      })<span class="sc">}</span></span>
<span id="cb20-509"><a href="#cb20-509" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/div&gt;</span></span>
<span id="cb20-510"><a href="#cb20-510" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;style&gt;</span></span>
<span id="cb20-511"><a href="#cb20-511" aria-hidden="true" tabindex="-1"></a><span class="vs">      div.styled {</span></span>
<span id="cb20-512"><a href="#cb20-512" aria-hidden="true" tabindex="-1"></a><span class="vs">        text-align: left;</span></span>
<span id="cb20-513"><a href="#cb20-513" aria-hidden="true" tabindex="-1"></a><span class="vs">        column-count: 4; /* Set to 4 columns */</span></span>
<span id="cb20-514"><a href="#cb20-514" aria-hidden="true" tabindex="-1"></a><span class="vs">        column-gap: 20px; /* Space between columns */</span></span>
<span id="cb20-515"><a href="#cb20-515" aria-hidden="true" tabindex="-1"></a><span class="vs">      }</span></span>
<span id="cb20-516"><a href="#cb20-516" aria-hidden="true" tabindex="-1"></a><span class="vs">      div.input-group {</span></span>
<span id="cb20-517"><a href="#cb20-517" aria-hidden="true" tabindex="-1"></a><span class="vs">        display: flex;</span></span>
<span id="cb20-518"><a href="#cb20-518" aria-hidden="true" tabindex="-1"></a><span class="vs">        flex-direction: column;</span></span>
<span id="cb20-519"><a href="#cb20-519" aria-hidden="true" tabindex="-1"></a><span class="vs">        margin-bottom: 10px; /* Space between inputs */</span></span>
<span id="cb20-520"><a href="#cb20-520" aria-hidden="true" tabindex="-1"></a><span class="vs">      }</span></span>
<span id="cb20-521"><a href="#cb20-521" aria-hidden="true" tabindex="-1"></a><span class="vs">      div.input-group label {</span></span>
<span id="cb20-522"><a href="#cb20-522" aria-hidden="true" tabindex="-1"></a><span class="vs">        font-weight: bold;</span></span>
<span id="cb20-523"><a href="#cb20-523" aria-hidden="true" tabindex="-1"></a><span class="vs">        margin-bottom: 5px; /* Space between label and control */</span></span>
<span id="cb20-524"><a href="#cb20-524" aria-hidden="true" tabindex="-1"></a><span class="vs">      }</span></span>
<span id="cb20-525"><a href="#cb20-525" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/style&gt;</span></span>
<span id="cb20-526"><a href="#cb20-526" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb21" data-startfrom="535" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 534;"><span id="cb21-535"><a href="#cb21-535" aria-hidden="true" tabindex="-1"></a>viewof minDate <span class="op">=</span> {</span>
<span id="cb21-536"><a href="#cb21-536" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dates <span class="op">=</span> data_hubs</span>
<span id="cb21-537"><a href="#cb21-537" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)</span>
<span id="cb21-538"><a href="#cb21-538" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d)</span>
<span id="cb21-539"><a href="#cb21-539" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">ascending</span>(<span class="op">+</span>a<span class="op">,</span> <span class="op">+</span>b))<span class="op">;</span></span>
<span id="cb21-540"><a href="#cb21-540" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">Scrubber</span>(dates<span class="op">,</span> {</span>
<span id="cb21-541"><a href="#cb21-541" aria-hidden="true" tabindex="-1"></a>    <span class="dt">delay</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span></span>
<span id="cb21-542"><a href="#cb21-542" aria-hidden="true" tabindex="-1"></a>    <span class="dt">autoplay</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb21-543"><a href="#cb21-543" aria-hidden="true" tabindex="-1"></a>    <span class="dt">loop</span><span class="op">:</span><span class="kw">false</span><span class="op">,</span></span>
<span id="cb21-544"><a href="#cb21-544" aria-hidden="true" tabindex="-1"></a>    <span class="dt">initial</span><span class="op">:</span> dates<span class="op">.</span><span class="at">length</span><span class="op">-</span><span class="dv">1</span></span>
<span id="cb21-545"><a href="#cb21-545" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb21-546"><a href="#cb21-546" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb22" data-startfrom="553" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 552;"><span id="cb22-553"><a href="#cb22-553" aria-hidden="true" tabindex="-1"></a>viewof groupBy <span class="op">=</span> {</span>
<span id="cb22-554"><a href="#cb22-554" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> attrs <span class="op">=</span> [</span>
<span id="cb22-555"><a href="#cb22-555" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"plataforma",</span></span>
<span id="cb22-556"><a href="#cb22-556" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"descripcion",</span></span>
<span id="cb22-557"><a href="#cb22-557" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"link",</span></span>
<span id="cb22-558"><a href="#cb22-558" aria-hidden="true" tabindex="-1"></a>  <span class="st">"thematic"</span><span class="op">,</span></span>
<span id="cb22-559"><a href="#cb22-559" aria-hidden="true" tabindex="-1"></a>  <span class="st">"phases"</span><span class="op">,</span></span>
<span id="cb22-560"><a href="#cb22-560" aria-hidden="true" tabindex="-1"></a>  <span class="st">"relation"</span><span class="op">,</span></span>
<span id="cb22-561"><a href="#cb22-561" aria-hidden="true" tabindex="-1"></a>  <span class="st">"research_line"</span><span class="op">,</span></span>
<span id="cb22-562"><a href="#cb22-562" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"partners",</span></span>
<span id="cb22-563"><a href="#cb22-563" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"country_host",</span></span>
<span id="cb22-564"><a href="#cb22-564" aria-hidden="true" tabindex="-1"></a>  <span class="co">////"year",</span></span>
<span id="cb22-565"><a href="#cb22-565" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"departamentos",</span></span>
<span id="cb22-566"><a href="#cb22-566" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"def_bioeconomia"</span></span>
<span id="cb22-567"><a href="#cb22-567" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"relaciones"</span></span>
<span id="cb22-568"><a href="#cb22-568" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"logo"</span></span>
<span id="cb22-569"><a href="#cb22-569" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"logo_viz"</span></span>
<span id="cb22-570"><a href="#cb22-570" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"lat_host"</span></span>
<span id="cb22-571"><a href="#cb22-571" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"long_host"</span></span>
<span id="cb22-572"><a href="#cb22-572" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb22-573"><a href="#cb22-573" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(attrs<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Group"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"phases"</span> })<span class="op">;</span></span>
<span id="cb22-574"><a href="#cb22-574" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb23" data-startfrom="581" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 580;"><span id="cb23-581"><a href="#cb23-581" aria-hidden="true" tabindex="-1"></a>viewof selectedTargets <span class="op">=</span> {</span>
<span id="cb23-582"><a href="#cb23-582" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> targetNames <span class="op">=</span> tidyData</span>
<span id="cb23-583"><a href="#cb23-583" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">groupby</span>(groupBy)</span>
<span id="cb23-584"><a href="#cb23-584" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">count</span>()</span>
<span id="cb23-585"><a href="#cb23-585" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">objects</span>()</span>
<span id="cb23-586"><a href="#cb23-586" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d[groupBy])</span>
<span id="cb23-587"><a href="#cb23-587" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb23-588"><a href="#cb23-588" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> selection <span class="op">=</span></span>
<span id="cb23-589"><a href="#cb23-589" aria-hidden="true" tabindex="-1"></a>    groupBy <span class="op">===</span> <span class="st">"research_line"</span></span>
<span id="cb23-590"><a href="#cb23-590" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> targetNames<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> <span class="op">!</span>[<span class="st">"Bioindustría"</span><span class="op">,</span><span class="st">"Bioenergía"</span><span class="op">,</span><span class="st">"Forestal"</span>]<span class="op">.</span><span class="fu">includes</span>(d))</span>
<span id="cb23-591"><a href="#cb23-591" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> targetNames<span class="op">;</span></span>
<span id="cb23-592"><a href="#cb23-592" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cr <span class="op">=</span> <span class="dv">15</span><span class="op">;</span></span>
<span id="cb23-593"><a href="#cb23-593" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>(targetNames<span class="op">,</span> {</span>
<span id="cb23-594"><a href="#cb23-594" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">"Show"</span><span class="op">,</span></span>
<span id="cb23-595"><a href="#cb23-595" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> selection<span class="op">,</span></span>
<span id="cb23-596"><a href="#cb23-596" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">html</span><span class="vs">`&lt;div style="height: </span><span class="sc">${</span>cr<span class="sc">}</span><span class="vs">px;</span></span>
<span id="cb23-597"><a href="#cb23-597" aria-hidden="true" tabindex="-1"></a><span class="vs">    line-height: </span><span class="sc">${</span>cr<span class="sc">}</span><span class="vs">px; </span></span>
<span id="cb23-598"><a href="#cb23-598" aria-hidden="true" tabindex="-1"></a><span class="vs">    display: flex;</span></span>
<span id="cb23-599"><a href="#cb23-599" aria-hidden="true" tabindex="-1"></a><span class="vs">    align-content: center;</span></span>
<span id="cb23-600"><a href="#cb23-600" aria-hidden="true" tabindex="-1"></a><span class="vs">    flex-wrap: wrap;</span></span>
<span id="cb23-601"><a href="#cb23-601" aria-hidden="true" tabindex="-1"></a><span class="vs">"&gt;&lt;svg width=</span><span class="sc">${</span>cr<span class="sc">}</span><span class="vs"> height=</span><span class="sc">${</span>cr<span class="sc">}</span><span class="vs"> style="margin-right:5px"&gt;</span></span>
<span id="cb23-602"><a href="#cb23-602" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;circle r=</span><span class="sc">${</span>cr <span class="op">/</span> <span class="dv">2</span><span class="sc">}</span><span class="vs"> cx=</span><span class="sc">${</span>cr <span class="op">/</span> <span class="dv">2</span><span class="sc">}</span><span class="vs"> cy=</span><span class="sc">${</span>cr <span class="op">/</span> <span class="dv">2</span><span class="sc">}</span><span class="vs"> fill="</span><span class="sc">${</span><span class="fu">hullColor</span>(d)<span class="sc">}</span><span class="vs">"/&gt; </span></span>
<span id="cb23-603"><a href="#cb23-603" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/svg&gt;</span></span>
<span id="cb23-604"><a href="#cb23-604" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>d<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb23-605"><a href="#cb23-605" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb23-606"><a href="#cb23-606" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-23" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb24" data-startfrom="612" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 611;"><span id="cb24-612"><a href="#cb24-612" aria-hidden="true" tabindex="-1"></a>viewof fheight_node <span class="op">=</span> (</span>
<span id="cb24-613"><a href="#cb24-613" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">form</span>({</span>
<span id="cb24-614"><a href="#cb24-614" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">200</span><span class="op">,</span> <span class="dv">1400</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Height"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span><span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">420</span>})<span class="op">,</span></span>
<span id="cb24-615"><a href="#cb24-615" aria-hidden="true" tabindex="-1"></a>  <span class="dt">nodeSize</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">2</span><span class="op">,</span> <span class="dv">30</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Node Size"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span> <span class="dv">23</span><span class="op">,</span><span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})}<span class="op">,</span></span>
<span id="cb24-616"><a href="#cb24-616" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb24-617"><a href="#cb24-617" aria-hidden="true" tabindex="-1"></a>    <span class="dt">template</span><span class="op">:</span> template_2 </span>
<span id="cb24-618"><a href="#cb24-618" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb24-619"><a href="#cb24-619" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-24" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb25" data-startfrom="626" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 625;"><span id="cb25-626"><a href="#cb25-626" aria-hidden="true" tabindex="-1"></a>chart <span class="op">=</span> {</span>
<span id="cb25-627"><a href="#cb25-627" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb25-628"><a href="#cb25-628" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width)</span>
<span id="cb25-629"><a href="#cb25-629" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> fheight_node<span class="op">.</span><span class="at">height</span>)</span>
<span id="cb25-630"><a href="#cb25-630" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> fheight_node<span class="op">.</span><span class="at">height</span>])</span>
<span id="cb25-631"><a href="#cb25-631" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"style"</span><span class="op">,</span> <span class="st">"max-width: 100%; height: auto; height: intrinsic; overflow: visible"</span>)<span class="op">;</span></span>
<span id="cb25-632"><a href="#cb25-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-633"><a href="#cb25-633" aria-hidden="true" tabindex="-1"></a>  graph<span class="op">.</span><span class="at">nodes</span><span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span> (d) {</span>
<span id="cb25-634"><a href="#cb25-634" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">r</span> <span class="op">=</span> d<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span> <span class="op">?</span> fheight_node<span class="op">.</span><span class="at">nodeSize</span> <span class="op">*</span> (d<span class="op">.</span><span class="at">degree</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>) <span class="op">:</span> fhpadding_box<span class="op">.</span><span class="at">greyNodeSize</span><span class="op">;</span></span>
<span id="cb25-635"><a href="#cb25-635" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb25-636"><a href="#cb25-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-637"><a href="#cb25-637" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> chargeScale <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb25-638"><a href="#cb25-638" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">20</span><span class="op">,</span> <span class="dv">160</span>])</span>
<span id="cb25-639"><a href="#cb25-639" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([width <span class="op">&lt;</span> <span class="dv">800</span> <span class="op">?</span> <span class="op">-</span><span class="dv">100</span> <span class="op">:</span> <span class="op">-</span><span class="dv">200</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">800</span> <span class="op">?</span> <span class="op">-</span><span class="dv">50</span> <span class="op">:</span> <span class="op">-</span><span class="dv">100</span>])<span class="op">;</span></span>
<span id="cb25-640"><a href="#cb25-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-641"><a href="#cb25-641" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> chargeStrength <span class="op">=</span> <span class="kw">function</span> (d) {</span>
<span id="cb25-642"><a href="#cb25-642" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (fheight_node<span class="op">.</span><span class="at">nodeSize</span> <span class="op">/</span> <span class="dv">10</span>) <span class="op">*</span> (d<span class="op">.</span><span class="at">degree</span> <span class="op">&gt;</span> <span class="dv">1</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="fl">0.7</span>) <span class="op">*</span> <span class="fu">chargeScale</span>(graph<span class="op">.</span><span class="at">nodes</span><span class="op">.</span><span class="at">length</span>)<span class="op">;</span></span>
<span id="cb25-643"><a href="#cb25-643" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb25-644"><a href="#cb25-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-645"><a href="#cb25-645" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> simulation <span class="op">=</span> d3<span class="op">.</span><span class="fu">forceSimulation</span>(graph<span class="op">.</span><span class="at">nodes</span>)</span>
<span id="cb25-646"><a href="#cb25-646" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">alpha</span>(<span class="dv">3</span>)</span>
<span id="cb25-647"><a href="#cb25-647" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">force</span>(</span>
<span id="cb25-648"><a href="#cb25-648" aria-hidden="true" tabindex="-1"></a>      <span class="st">"link"</span><span class="op">,</span></span>
<span id="cb25-649"><a href="#cb25-649" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">forceLink</span>(graph<span class="op">.</span><span class="at">links</span>)</span>
<span id="cb25-650"><a href="#cb25-650" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">id</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">name</span>)</span>
<span id="cb25-651"><a href="#cb25-651" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">distance</span>(<span class="dv">10</span>)</span>
<span id="cb25-652"><a href="#cb25-652" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">strength</span>(<span class="fl">0.1</span>)</span>
<span id="cb25-653"><a href="#cb25-653" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-654"><a href="#cb25-654" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">force</span>(<span class="st">"charge"</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">forceManyBody</span>()<span class="op">.</span><span class="fu">strength</span>(chargeStrength))</span>
<span id="cb25-655"><a href="#cb25-655" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">force</span>(<span class="st">"collide"</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">forceCollide</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">r</span> <span class="op">+</span> <span class="dv">3</span>)<span class="op">.</span><span class="fu">iterations</span>(<span class="dv">4</span>))</span>
<span id="cb25-656"><a href="#cb25-656" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">force</span>(<span class="st">"x"</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">forceX</span>(width <span class="op">/</span> <span class="dv">2</span>)<span class="op">.</span><span class="fu">strength</span>(<span class="fl">0.1</span>))</span>
<span id="cb25-657"><a href="#cb25-657" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">force</span>(<span class="st">"y"</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">forceY</span>(fheight_node<span class="op">.</span><span class="at">height</span> <span class="op">/</span> <span class="dv">2</span>)<span class="op">.</span><span class="fu">strength</span>((<span class="fl">0.07</span> <span class="op">*</span> width) <span class="op">/</span> fheight_node<span class="op">.</span><span class="at">height</span>))<span class="op">;</span></span>
<span id="cb25-658"><a href="#cb25-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-659"><a href="#cb25-659" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> area <span class="op">=</span> d3<span class="op">.</span><span class="fu">line</span>()<span class="op">.</span><span class="fu">curve</span>(d3<span class="op">.</span><span class="at">curveCardinalClosed</span>)<span class="op">;</span></span>
<span id="cb25-660"><a href="#cb25-660" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> hp <span class="op">=</span> fhpadding_box<span class="op">.</span><span class="at">hullPadding</span><span class="op">;</span></span>
<span id="cb25-661"><a href="#cb25-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-662"><a href="#cb25-662" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> getHull <span class="op">=</span> <span class="kw">function</span> (d) {</span>
<span id="cb25-663"><a href="#cb25-663" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> points <span class="op">=</span> d[<span class="dv">1</span>]</span>
<span id="cb25-664"><a href="#cb25-664" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> fclabels_check<span class="op">.</span><span class="at">showGroupingNodes</span> <span class="op">||</span> d<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span>)</span>
<span id="cb25-665"><a href="#cb25-665" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">map</span>(n <span class="kw">=&gt;</span> [</span>
<span id="cb25-666"><a href="#cb25-666" aria-hidden="true" tabindex="-1"></a>        [n<span class="op">.</span><span class="at">x</span> <span class="op">-</span> (n<span class="op">.</span><span class="at">r</span> <span class="op">+</span> hp)<span class="op">,</span> n<span class="op">.</span><span class="at">y</span>]<span class="op">,</span></span>
<span id="cb25-667"><a href="#cb25-667" aria-hidden="true" tabindex="-1"></a>        [n<span class="op">.</span><span class="at">x</span> <span class="op">+</span> n<span class="op">.</span><span class="at">r</span> <span class="op">+</span> hp<span class="op">,</span> n<span class="op">.</span><span class="at">y</span>]<span class="op">,</span></span>
<span id="cb25-668"><a href="#cb25-668" aria-hidden="true" tabindex="-1"></a>        [n<span class="op">.</span><span class="at">x</span><span class="op">,</span> n<span class="op">.</span><span class="at">y</span> <span class="op">+</span> n<span class="op">.</span><span class="at">r</span> <span class="op">+</span> hp]<span class="op">,</span></span>
<span id="cb25-669"><a href="#cb25-669" aria-hidden="true" tabindex="-1"></a>        [n<span class="op">.</span><span class="at">x</span><span class="op">,</span> n<span class="op">.</span><span class="at">y</span> <span class="op">-</span> (n<span class="op">.</span><span class="at">r</span> <span class="op">+</span> hp)]</span>
<span id="cb25-670"><a href="#cb25-670" aria-hidden="true" tabindex="-1"></a>      ])</span>
<span id="cb25-671"><a href="#cb25-671" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">flat</span>()<span class="op">;</span></span>
<span id="cb25-672"><a href="#cb25-672" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> hull <span class="op">=</span> d3<span class="op">.</span><span class="fu">polygonHull</span>(points)<span class="op">;</span></span>
<span id="cb25-673"><a href="#cb25-673" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hull <span class="op">&amp;&amp;</span> <span class="fu">area</span>(hull)<span class="op">;</span></span>
<span id="cb25-674"><a href="#cb25-674" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb25-675"><a href="#cb25-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-676"><a href="#cb25-676" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> hullG <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"gHulls"</span>)<span class="op">;</span></span>
<span id="cb25-677"><a href="#cb25-677" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> hull <span class="op">=</span> hullG</span>
<span id="cb25-678"><a href="#cb25-678" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"path.hull"</span>)</span>
<span id="cb25-679"><a href="#cb25-679" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(</span>
<span id="cb25-680"><a href="#cb25-680" aria-hidden="true" tabindex="-1"></a>      graph<span class="op">.</span><span class="at">clusters</span><span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> <span class="op">!</span><span class="kw">true</span> <span class="op">||</span> d[<span class="dv">0</span>] <span class="op">!==</span> <span class="st">"Khoury College of Computer Sciences"</span>)<span class="op">,</span></span>
<span id="cb25-681"><a href="#cb25-681" aria-hidden="true" tabindex="-1"></a>      d <span class="kw">=&gt;</span> d[<span class="dv">0</span>]</span>
<span id="cb25-682"><a href="#cb25-682" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-683"><a href="#cb25-683" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"path"</span>)</span>
<span id="cb25-684"><a href="#cb25-684" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hull"</span>)</span>
<span id="cb25-685"><a href="#cb25-685" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">hullColor</span>(d[<span class="dv">0</span>]))</span>
<span id="cb25-686"><a href="#cb25-686" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.3</span>)</span>
<span id="cb25-687"><a href="#cb25-687" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb25-688"><a href="#cb25-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-689"><a href="#cb25-689" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> linkG <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"gLinks"</span>)<span class="op">;</span></span>
<span id="cb25-690"><a href="#cb25-690" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> link <span class="op">=</span> linkG</span>
<span id="cb25-691"><a href="#cb25-691" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#999a"</span>)</span>
<span id="cb25-692"><a href="#cb25-692" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-opacity"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb25-693"><a href="#cb25-693" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">0.5</span>)</span>
<span id="cb25-694"><a href="#cb25-694" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-linecap"</span><span class="op">,</span> <span class="st">"round"</span>)</span>
<span id="cb25-695"><a href="#cb25-695" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb25-696"><a href="#cb25-696" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(</span>
<span id="cb25-697"><a href="#cb25-697" aria-hidden="true" tabindex="-1"></a>      graph<span class="op">.</span><span class="at">links</span><span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> fclabels_check<span class="op">.</span><span class="at">showGroupingNodes</span> <span class="op">||</span> d<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span>)<span class="op">,</span></span>
<span id="cb25-698"><a href="#cb25-698" aria-hidden="true" tabindex="-1"></a>      d <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="at">source</span><span class="op">.</span><span class="at">name</span><span class="sc">}</span><span class="vs">-</span><span class="sc">${</span>d<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">name</span><span class="sc">}</span><span class="vs">`</span></span>
<span id="cb25-699"><a href="#cb25-699" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-700"><a href="#cb25-700" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"line"</span>)<span class="op">;</span></span>
<span id="cb25-701"><a href="#cb25-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-702"><a href="#cb25-702" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> nodeG <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"gNodes"</span>)<span class="op">;</span></span>
<span id="cb25-703"><a href="#cb25-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-704"><a href="#cb25-704" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Crear labels para Bioeconomy y nodos grises primero</span></span>
<span id="cb25-705"><a href="#cb25-705" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> getNameArray <span class="op">=</span> <span class="kw">function</span> (d) {</span>
<span id="cb25-706"><a href="#cb25-706" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d<span class="op">.</span><span class="at">nameArray</span> <span class="op">?</span> d<span class="op">.</span><span class="at">nameArray</span> <span class="op">:</span> d<span class="op">.</span><span class="at">name</span><span class="op">.</span><span class="fu">split</span>(<span class="st">" "</span>)<span class="op">;</span></span>
<span id="cb25-707"><a href="#cb25-707" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb25-708"><a href="#cb25-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-709"><a href="#cb25-709" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> lineWidth <span class="op">=</span> <span class="fl">1.9</span><span class="op">;</span></span>
<span id="cb25-710"><a href="#cb25-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-711"><a href="#cb25-711" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> createLabels <span class="op">=</span> <span class="kw">function</span> (_data<span class="op">,</span> className <span class="op">=</span> <span class="st">"BioeconomyLabel"</span>) {</span>
<span id="cb25-712"><a href="#cb25-712" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> svg</span>
<span id="cb25-713"><a href="#cb25-713" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`text.</span><span class="sc">${</span>className<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb25-714"><a href="#cb25-714" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(_data<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">name</span>)</span>
<span id="cb25-715"><a href="#cb25-715" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">"text"</span>)</span>
<span id="cb25-716"><a href="#cb25-716" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> className)</span>
<span id="cb25-717"><a href="#cb25-717" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb25-718"><a href="#cb25-718" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>fhpadding_box<span class="op">.</span><span class="at">fontSize</span> <span class="op">*</span> (d<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span> <span class="op">?</span> d<span class="op">.</span><span class="at">r</span> <span class="op">/</span> fheight_node<span class="op">.</span><span class="at">nodeSize</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">:</span> <span class="fl">1.8</span>)<span class="sc">}</span><span class="vs">pt`</span>)</span>
<span id="cb25-719"><a href="#cb25-719" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> d <span class="kw">=&gt;</span> (d<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span> <span class="op">?</span> <span class="st">"light"</span> <span class="op">:</span> <span class="st">"bolder"</span>))</span>
<span id="cb25-720"><a href="#cb25-720" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"Oswald"</span>)</span>
<span id="cb25-721"><a href="#cb25-721" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb25-722"><a href="#cb25-722" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"clip-path"</span><span class="op">,</span> d <span class="kw">=&gt;</span> fclabels_check<span class="op">.</span><span class="at">clipLabels</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span> <span class="op">?</span> <span class="vs">`circle(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">r</span> <span class="op">-</span> <span class="dv">2</span><span class="sc">}</span><span class="vs">px)`</span> <span class="op">:</span> <span class="st">""</span>)</span>
<span id="cb25-723"><a href="#cb25-723" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">each</span>(<span class="kw">function</span> (d) {</span>
<span id="cb25-724"><a href="#cb25-724" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">select</span>(<span class="kw">this</span>)</span>
<span id="cb25-725"><a href="#cb25-725" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"tspan"</span>)</span>
<span id="cb25-726"><a href="#cb25-726" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">data</span>(<span class="fu">getNameArray</span>(d))</span>
<span id="cb25-727"><a href="#cb25-727" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">join</span>(<span class="st">"tspan"</span>)</span>
<span id="cb25-728"><a href="#cb25-728" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb25-729"><a href="#cb25-729" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> lineWidth <span class="op">+</span> <span class="st">"ch"</span>)</span>
<span id="cb25-730"><a href="#cb25-730" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">text</span>(n <span class="kw">=&gt;</span> n)<span class="op">;</span></span>
<span id="cb25-731"><a href="#cb25-731" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb25-732"><a href="#cb25-732" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> d <span class="kw">=&gt;</span> (<span class="fu">getNameArray</span>(d)<span class="op">.</span><span class="at">length</span> <span class="op">/</span> <span class="dv">2</span>) <span class="op">*</span> <span class="op">-</span>lineWidth <span class="op">+</span> <span class="st">"ch"</span>)<span class="op">;</span></span>
<span id="cb25-733"><a href="#cb25-733" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb25-734"><a href="#cb25-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-735"><a href="#cb25-735" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> label <span class="op">=</span> <span class="fu">createLabels</span>(</span>
<span id="cb25-736"><a href="#cb25-736" aria-hidden="true" tabindex="-1"></a>    graph<span class="op">.</span><span class="at">nodes</span><span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span> <span class="op">?</span> d<span class="op">.</span><span class="at">degree</span> <span class="op">&gt;=</span> fhpadding_box<span class="op">.</span><span class="at">minDegree</span> <span class="op">:</span> <span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb25-737"><a href="#cb25-737" aria-hidden="true" tabindex="-1"></a>    <span class="st">"BioeconomyLabel"</span></span>
<span id="cb25-738"><a href="#cb25-738" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb25-739"><a href="#cb25-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-740"><a href="#cb25-740" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> labelDepts <span class="op">=</span> <span class="fu">createLabels</span>(</span>
<span id="cb25-741"><a href="#cb25-741" aria-hidden="true" tabindex="-1"></a>    graph<span class="op">.</span><span class="at">nodes</span><span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">!==</span> <span class="st">"Bioeconomy"</span>)<span class="op">,</span></span>
<span id="cb25-742"><a href="#cb25-742" aria-hidden="true" tabindex="-1"></a>    <span class="st">"departmentLabel"</span></span>
<span id="cb25-743"><a href="#cb25-743" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb25-744"><a href="#cb25-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-745"><a href="#cb25-745" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Crear nodos y añadir imágenes sobre los labels</span></span>
<span id="cb25-746"><a href="#cb25-746" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> node <span class="op">=</span> nodeG</span>
<span id="cb25-747"><a href="#cb25-747" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"circle"</span>)</span>
<span id="cb25-748"><a href="#cb25-748" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(</span>
<span id="cb25-749"><a href="#cb25-749" aria-hidden="true" tabindex="-1"></a>      graph<span class="op">.</span><span class="at">nodes</span><span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> fclabels_check<span class="op">.</span><span class="at">showGroupingNodes</span> <span class="op">||</span> d<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span>)<span class="op">,</span></span>
<span id="cb25-750"><a href="#cb25-750" aria-hidden="true" tabindex="-1"></a>      d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">name</span></span>
<span id="cb25-751"><a href="#cb25-751" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-752"><a href="#cb25-752" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"circle"</span>)</span>
<span id="cb25-753"><a href="#cb25-753" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> (d<span class="op">.</span><span class="at">type</span> <span class="op">!==</span> <span class="st">"Bioeconomy"</span> <span class="op">?</span> <span class="st">"#999"</span> <span class="op">:</span> <span class="fu">hullColor</span>(d<span class="op">.</span><span class="at">cluster</span>)))</span>
<span id="cb25-754"><a href="#cb25-754" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-opacity"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb25-755"><a href="#cb25-755" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb25-756"><a href="#cb25-756" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">r</span>)</span>
<span id="cb25-757"><a href="#cb25-757" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(<span class="fu">drag</span>(simulation))<span class="op">;</span></span>
<span id="cb25-758"><a href="#cb25-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-759"><a href="#cb25-759" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> images <span class="op">=</span> nodeG</span>
<span id="cb25-760"><a href="#cb25-760" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"image"</span>)</span>
<span id="cb25-761"><a href="#cb25-761" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(</span>
<span id="cb25-762"><a href="#cb25-762" aria-hidden="true" tabindex="-1"></a>      fclabels_check<span class="op">.</span><span class="at">useImages</span></span>
<span id="cb25-763"><a href="#cb25-763" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> graph<span class="op">.</span><span class="at">nodes</span><span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">logo_viz</span>)</span>
<span id="cb25-764"><a href="#cb25-764" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> []<span class="op">,</span></span>
<span id="cb25-765"><a href="#cb25-765" aria-hidden="true" tabindex="-1"></a>      d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">name</span></span>
<span id="cb25-766"><a href="#cb25-766" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-767"><a href="#cb25-767" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"image"</span>)</span>
<span id="cb25-768"><a href="#cb25-768" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"href"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">logo_viz</span>)</span>
<span id="cb25-769"><a href="#cb25-769" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">r</span> <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">4</span>)</span>
<span id="cb25-770"><a href="#cb25-770" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">r</span> <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">4</span>)</span>
<span id="cb25-771"><a href="#cb25-771" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb25-772"><a href="#cb25-772" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"preserveAspectRatio"</span><span class="op">,</span> <span class="st">"xMidYMid slice"</span>)</span>
<span id="cb25-773"><a href="#cb25-773" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(-</span><span class="sc">${</span>d<span class="op">.</span><span class="at">r</span> <span class="op">-</span> <span class="dv">2</span><span class="sc">}</span><span class="vs">, -</span><span class="sc">${</span>d<span class="op">.</span><span class="at">r</span> <span class="op">-</span> <span class="dv">2</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb25-774"><a href="#cb25-774" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"clip-path"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`circle(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">r</span> <span class="op">-</span> <span class="dv">2</span><span class="sc">}</span><span class="vs">px)`</span>)</span>
<span id="cb25-775"><a href="#cb25-775" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(<span class="fu">drag</span>(simulation))<span class="op">;</span></span>
<span id="cb25-776"><a href="#cb25-776" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-777"><a href="#cb25-777" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateVisibility</span>() {</span>
<span id="cb25-778"><a href="#cb25-778" aria-hidden="true" tabindex="-1"></a>  label<span class="op">.</span><span class="fu">attr</span>(<span class="st">"display"</span><span class="op">,</span> fclabels_check<span class="op">.</span><span class="at">useImages</span> <span class="op">?</span> <span class="st">"none"</span> <span class="op">:</span> <span class="st">"block"</span>)<span class="op">;</span></span>
<span id="cb25-779"><a href="#cb25-779" aria-hidden="true" tabindex="-1"></a>  images<span class="op">.</span><span class="fu">attr</span>(<span class="st">"display"</span><span class="op">,</span> fclabels_check<span class="op">.</span><span class="at">useImages</span> <span class="op">?</span> <span class="st">"block"</span> <span class="op">:</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb25-780"><a href="#cb25-780" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-781"><a href="#cb25-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateVisibility</span>()<span class="op">;</span></span>
<span id="cb25-782"><a href="#cb25-782" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">ticked</span>() {</span>
<span id="cb25-783"><a href="#cb25-783" aria-hidden="true" tabindex="-1"></a>    link</span>
<span id="cb25-784"><a href="#cb25-784" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">source</span><span class="op">.</span><span class="at">x</span>)</span>
<span id="cb25-785"><a href="#cb25-785" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">source</span><span class="op">.</span><span class="at">y</span>)</span>
<span id="cb25-786"><a href="#cb25-786" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">x</span>)</span>
<span id="cb25-787"><a href="#cb25-787" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">y</span>)<span class="op">;</span></span>
<span id="cb25-788"><a href="#cb25-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-789"><a href="#cb25-789" aria-hidden="true" tabindex="-1"></a>    label<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">x</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>d<span class="op">.</span><span class="at">y</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">.</span><span class="fu">classed</span>(<span class="st">"shadow"</span><span class="op">,</span> simulation<span class="op">.</span><span class="fu">alpha</span>() <span class="op">&lt;=</span> <span class="fl">0.1</span>)<span class="op">;</span></span>
<span id="cb25-790"><a href="#cb25-790" aria-hidden="true" tabindex="-1"></a>    labelDepts<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">x</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>d<span class="op">.</span><span class="at">y</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">.</span><span class="fu">classed</span>(<span class="st">"shadow"</span><span class="op">,</span> simulation<span class="op">.</span><span class="fu">alpha</span>() <span class="op">&lt;=</span> <span class="fl">0.1</span>)<span class="op">;</span></span>
<span id="cb25-791"><a href="#cb25-791" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-792"><a href="#cb25-792" aria-hidden="true" tabindex="-1"></a>    node<span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">y</span>)<span class="op">.</span><span class="fu">classed</span>(<span class="st">"shadow"</span><span class="op">,</span> simulation<span class="op">.</span><span class="fu">alpha</span>() <span class="op">&lt;=</span> <span class="fl">0.1</span>)<span class="op">;</span></span>
<span id="cb25-793"><a href="#cb25-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-794"><a href="#cb25-794" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (fclabels_check<span class="op">.</span><span class="at">useImages</span>) {</span>
<span id="cb25-795"><a href="#cb25-795" aria-hidden="true" tabindex="-1"></a>      images<span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">y</span>)<span class="op">;</span></span>
<span id="cb25-796"><a href="#cb25-796" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-797"><a href="#cb25-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-798"><a href="#cb25-798" aria-hidden="true" tabindex="-1"></a>    hull<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> getHull)<span class="op">;</span></span>
<span id="cb25-799"><a href="#cb25-799" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-800"><a href="#cb25-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-801"><a href="#cb25-801" aria-hidden="true" tabindex="-1"></a>  simulation<span class="op">.</span><span class="fu">on</span>(<span class="st">"tick"</span><span class="op">,</span> ticked)<span class="op">;</span></span>
<span id="cb25-802"><a href="#cb25-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-803"><a href="#cb25-803" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drag</span>(simulation) {</span>
<span id="cb25-804"><a href="#cb25-804" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">dragstarted</span>(<span class="bu">event</span>) {</span>
<span id="cb25-805"><a href="#cb25-805" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span><span class="bu">event</span><span class="op">.</span><span class="at">active</span>) simulation<span class="op">.</span><span class="fu">alphaTarget</span>(<span class="fl">0.3</span>)<span class="op">.</span><span class="fu">restart</span>()<span class="op">;</span></span>
<span id="cb25-806"><a href="#cb25-806" aria-hidden="true" tabindex="-1"></a>      <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">fx</span> <span class="op">=</span> <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">x</span><span class="op">;</span></span>
<span id="cb25-807"><a href="#cb25-807" aria-hidden="true" tabindex="-1"></a>      <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">fy</span> <span class="op">=</span> <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">y</span><span class="op">;</span></span>
<span id="cb25-808"><a href="#cb25-808" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-809"><a href="#cb25-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-810"><a href="#cb25-810" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">dragged</span>(<span class="bu">event</span>) {</span>
<span id="cb25-811"><a href="#cb25-811" aria-hidden="true" tabindex="-1"></a>      <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">fx</span> <span class="op">=</span> <span class="bu">event</span><span class="op">.</span><span class="at">x</span><span class="op">;</span></span>
<span id="cb25-812"><a href="#cb25-812" aria-hidden="true" tabindex="-1"></a>      <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">fy</span> <span class="op">=</span> <span class="bu">event</span><span class="op">.</span><span class="at">y</span><span class="op">;</span></span>
<span id="cb25-813"><a href="#cb25-813" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-814"><a href="#cb25-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-815"><a href="#cb25-815" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">dragended</span>(<span class="bu">event</span>) {</span>
<span id="cb25-816"><a href="#cb25-816" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span><span class="bu">event</span><span class="op">.</span><span class="at">active</span>) simulation<span class="op">.</span><span class="fu">alphaTarget</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb25-817"><a href="#cb25-817" aria-hidden="true" tabindex="-1"></a>      <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">fx</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb25-818"><a href="#cb25-818" aria-hidden="true" tabindex="-1"></a>      <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">fy</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb25-819"><a href="#cb25-819" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-820"><a href="#cb25-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-821"><a href="#cb25-821" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d3</span>
<span id="cb25-822"><a href="#cb25-822" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">drag</span>()</span>
<span id="cb25-823"><a href="#cb25-823" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> dragstarted)</span>
<span id="cb25-824"><a href="#cb25-824" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"drag"</span><span class="op">,</span> dragged)</span>
<span id="cb25-825"><a href="#cb25-825" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"end"</span><span class="op">,</span> dragended)<span class="op">;</span></span>
<span id="cb25-826"><a href="#cb25-826" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-827"><a href="#cb25-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-828"><a href="#cb25-828" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> simulation<span class="op">.</span><span class="fu">stop</span>())<span class="op">;</span></span>
<span id="cb25-829"><a href="#cb25-829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ticked</span>()<span class="op">;</span></span>
<span id="cb25-830"><a href="#cb25-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-831"><a href="#cb25-831" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;div&gt;</span></span>
<span id="cb25-832"><a href="#cb25-832" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;h2&gt; bioeconomy enabling networks by </span><span class="sc">${</span>groupBy<span class="sc">}</span><span class="vs">&lt;/h2&gt;</span></span>
<span id="cb25-833"><a href="#cb25-833" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span><span class="sc">${</span>svg<span class="op">.</span><span class="fu">node</span>()<span class="sc">}</span></span>
<span id="cb25-834"><a href="#cb25-834" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb25-835"><a href="#cb25-835" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-25" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb26" data-startfrom="842" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 841;"><span id="cb26-842"><a href="#cb26-842" aria-hidden="true" tabindex="-1"></a>viewof colorInterpolator <span class="op">=</span> {</span>
<span id="cb26-843"><a href="#cb26-843" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> colorSchemes <span class="op">=</span> [</span>
<span id="cb26-844"><a href="#cb26-844" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateBlues"</span><span class="op">,</span></span>
<span id="cb26-845"><a href="#cb26-845" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateBrBG"</span><span class="op">,</span></span>
<span id="cb26-846"><a href="#cb26-846" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateRdBu"</span><span class="op">,</span></span>
<span id="cb26-847"><a href="#cb26-847" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateRdYlGn"</span><span class="op">,</span></span>
<span id="cb26-848"><a href="#cb26-848" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateReds"</span><span class="op">,</span></span>
<span id="cb26-849"><a href="#cb26-849" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateSinebow"</span><span class="op">,</span></span>
<span id="cb26-850"><a href="#cb26-850" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateSpectral"</span><span class="op">,</span></span>
<span id="cb26-851"><a href="#cb26-851" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateTurbo"</span><span class="op">,</span></span>
<span id="cb26-852"><a href="#cb26-852" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateViridis"</span><span class="op">,</span></span>
<span id="cb26-853"><a href="#cb26-853" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb26-854"><a href="#cb26-854" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> colors <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>(</span>
<span id="cb26-855"><a href="#cb26-855" aria-hidden="true" tabindex="-1"></a>    [[<span class="st">"Custom Turbo"</span><span class="op">,</span> (t) <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">interpolateTurbo</span>(<span class="fl">0.2</span> <span class="op">+</span> t <span class="op">*</span> <span class="fl">0.8</span>)]]<span class="op">.</span><span class="fu">concat</span>(</span>
<span id="cb26-856"><a href="#cb26-856" aria-hidden="true" tabindex="-1"></a>      colorSchemes<span class="op">.</span><span class="fu">map</span>((c) <span class="kw">=&gt;</span> [c<span class="op">,</span> d3[c]])</span>
<span id="cb26-857"><a href="#cb26-857" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-858"><a href="#cb26-858" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb26-859"><a href="#cb26-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-860"><a href="#cb26-860" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(colors<span class="op">,</span> {</span>
<span id="cb26-861"><a href="#cb26-861" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">"Color Scheme"</span><span class="op">,</span></span>
<span id="cb26-862"><a href="#cb26-862" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d[<span class="dv">0</span>]</span>
<span id="cb26-863"><a href="#cb26-863" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb26-864"><a href="#cb26-864" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-26" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb27" data-startfrom="871" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 870;"><span id="cb27-871"><a href="#cb27-871" aria-hidden="true" tabindex="-1"></a>viewof fhpadding_box <span class="op">=</span> (</span>
<span id="cb27-872"><a href="#cb27-872" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">form</span>({</span>
<span id="cb27-873"><a href="#cb27-873" aria-hidden="true" tabindex="-1"></a>    <span class="dt">hullPadding</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Hull Padding"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">9</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb27-874"><a href="#cb27-874" aria-hidden="true" tabindex="-1"></a>    <span class="dt">minDegree</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(graph<span class="op">.</span><span class="at">nodes</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">degree</span>) <span class="op">+</span> <span class="dv">1</span>]<span class="op">,</span> {</span>
<span id="cb27-875"><a href="#cb27-875" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="st">"Min Degree for Label"</span><span class="op">,</span></span>
<span id="cb27-876"><a href="#cb27-876" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb27-877"><a href="#cb27-877" aria-hidden="true" tabindex="-1"></a>      <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span></span>
<span id="cb27-878"><a href="#cb27-878" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb27-879"><a href="#cb27-879" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fontSize</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">36</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Font size"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb27-880"><a href="#cb27-880" aria-hidden="true" tabindex="-1"></a>    <span class="dt">greyNodeSize</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">30</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Connecting Node Size"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})</span>
<span id="cb27-881"><a href="#cb27-881" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb27-882"><a href="#cb27-882" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb27-883"><a href="#cb27-883" aria-hidden="true" tabindex="-1"></a>    <span class="dt">template</span><span class="op">:</span> template_4 <span class="co">// Específicamente usando template_4 para 4 columnas</span></span>
<span id="cb27-884"><a href="#cb27-884" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb27-885"><a href="#cb27-885" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-27" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb28" data-startfrom="892" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 891;"><span id="cb28-892"><a href="#cb28-892" aria-hidden="true" tabindex="-1"></a>viewof fclabels_check <span class="op">=</span> (</span>
<span id="cb28-893"><a href="#cb28-893" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">form</span>({</span>
<span id="cb28-894"><a href="#cb28-894" aria-hidden="true" tabindex="-1"></a>  <span class="dt">useImages</span><span class="op">:</span>Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"Use Images"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})<span class="op">,</span></span>
<span id="cb28-895"><a href="#cb28-895" aria-hidden="true" tabindex="-1"></a>  <span class="dt">showGroupingNodes</span><span class="op">:</span>Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"Show grey nodes"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})<span class="op">,</span></span>
<span id="cb28-896"><a href="#cb28-896" aria-hidden="true" tabindex="-1"></a>  <span class="dt">clipLabels</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"Clip Labels"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})<span class="op">,</span></span>
<span id="cb28-897"><a href="#cb28-897" aria-hidden="true" tabindex="-1"></a>  <span class="dt">useShadowsText</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"Use Text Shadows"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})}<span class="op">,</span></span>
<span id="cb28-898"><a href="#cb28-898" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb28-899"><a href="#cb28-899" aria-hidden="true" tabindex="-1"></a>    <span class="dt">template</span><span class="op">:</span> template_4 </span>
<span id="cb28-900"><a href="#cb28-900" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb28-901"><a href="#cb28-901" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-28" data-nodetype="declaration">

</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImQzID0gcmVxdWlyZShcImQzQDdcIilcclxubmF2aW9fbnBtID0gcmVxdWlyZShcIm5hdmlvQDAuMC43NVwiKVxyXG5JbnB1dHMgPSByZXF1aXJlKFwiQG9ic2VydmFibGVocS9pbnB1dHNcIilcclxuaHRsID0gcmVxdWlyZShcImh0bFwiKVxyXG5cclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiYXEgPSB7XHJcbiAgY29uc3QgYXEgPSBhd2FpdCByZXF1aXJlKGBhcnF1ZXJvQCR7YXFfdmVyc2lvbn1gKTtcclxuXHJcbiAgLy8gQWRkIEhUTUwgdGFibGUgdmlldyBtZXRob2QgdG8gdGFibGVzXHJcbiAgT2JqZWN0LmFzc2lnbihhcS5Db2x1bW5UYWJsZS5wcm90b3R5cGUsIHtcclxuICAgIHZpZXcob3B0aW9ucykgeyByZXR1cm4gdG9WaWV3KHRoaXMsIG9wdGlvbnMpOyB9XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBhcTtcclxufVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJhcV92ZXJzaW9uID0gJzcuMi4wJ1xyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJvcCA9IGFxLm9wXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InRvVmlldyA9IHtcclxuICBjb25zdCBERUZBVUxUX0xJTUlUID0gMTAwO1xyXG4gIGNvbnN0IERFRkFVTFRfTlVMTCA9IHZhbHVlID0+IGA8c3BhbiBzdHlsZT1cImNvbG9yOiAjOTk5O1wiPiR7dmFsdWV9PC9zcGFuPmA7XHJcbiAgY29uc3QgdGFibGVTdHlsZSA9ICdtYXJnaW46IDA7IGJvcmRlci1jb2xsYXBzZTogc2VwYXJhdGU7IGJvcmRlci1zcGFjaW5nOiAwOyB3aWR0aDogaW5pdGlhbDsnO1xyXG4gIGNvbnN0IGNlbGxTdHlsZSA9ICdwYWRkaW5nOiAxcHggNXB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy14OiBoaWRkZW47IHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOyBmb250LXZhcmlhbnQtbnVtZXJpYzogdGFidWxhci1udW1zOyc7XHJcbiAgY29uc3Qgcm93U3R5bGUgPSAnYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlZWU7JztcclxuXHJcbiAgLy8gZ2l2ZW4gYW4gQXJxdWVybyBkYXRhIHRhYmxlLCBwcm92aWRlIGFuIEhUTUwgdGFibGUgdmlld1xyXG4gIHJldHVybiBmdW5jdGlvbihkdCwgb3B0ID0ge30pIHtcclxuICAgIC8vIHBlcm1pdCBzaG9ydGhhbmQgZm9yIGxpbWl0XHJcbiAgICBpZiAodHlwZW9mIG9wdCA9PT0gJ251bWJlcicpIG9wdCA9IHsgbGltaXQ6IG9wdCB9O1xyXG4gICAgXHJcbiAgICAvLyBtYXJzaGFsIGNlbGwgY29sb3Igb3B0aW9uc1xyXG4gICAgY29uc3QgY29sb3IgPSB7IC4uLm9wdC5jb2xvciB9O1xyXG4gICAgaWYgKHR5cGVvZiBvcHQuY29sb3IgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgLy8gaWYgZnVuY3Rpb24sIGFwcGx5IHRvIGFsbCBjb2x1bW5zXHJcbiAgICAgIGR0LmNvbHVtbk5hbWVzKCkuZm9yRWFjaChuYW1lID0+IGNvbG9yW25hbWVdID0gb3B0LmNvbG9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIG90aGVyd2lzZSwgZ2F0aGVyIHBlci1jb2x1bW4gY29sb3Igb3B0aW9uc1xyXG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiBjb2xvcikge1xyXG4gICAgICAgIGNvbnN0IHZhbHVlID0gY29sb3Jba2V5XTtcclxuICAgICAgICBjb2xvcltrZXldID0gdHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nID8gdmFsdWUgOiAoKSA9PiB2YWx1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIG1hcnNoYWwgQ1NTIHN0eWxlcyBhcyB0b0hUTUwoKSBvcHRpb25zXHJcbiAgICBjb25zdCB0YWJsZSA9IGAke3RhYmxlU3R5bGV9YDtcclxuICAgIGNvbnN0IGNlbGwgPSAobmFtZSwgaW5kZXgsIHJvdywgdGgpID0+IHtcclxuICAgICAgcmV0dXJuIGAke2NlbGxTdHlsZX0gbWF4LXdpZHRoOiAkeytvcHQubWF4Q2VsbFdpZHRoIHx8IDMwMH1weDtgXHJcbiAgICAgICAgKyBgIGJvcmRlci1ib3R0b206IHNvbGlkIDFweCAke3RoID8gJyNjY2MnIDogJyNlZWUnfTtgXHJcbiAgICAgICAgKyAoY29sb3JbbmFtZV0gPyBgIGJhY2tncm91bmQtY29sb3I6ICR7Y29sb3JbbmFtZV0oaW5kZXgsIHJvdyl9O2AgOiAnJyk7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgdGQgPSAobmFtZSwgaW5kZXgsIHJvdykgPT4gY2VsbChuYW1lLCBpbmRleCwgcm93LCBmYWxzZSk7XHJcbiAgICBjb25zdCB0aCA9IChuYW1lLCBpbmRleCwgcm93KSA9PiBgcG9zaXRpb246IHN0aWNreTsgdG9wOiAwOyBiYWNrZ3JvdW5kOiAjZmZmOyBgXHJcbiAgICAgICAgKyBjZWxsKG5hbWUsIGluZGV4LCByb3csIHRydWUpO1xyXG5cclxuICAgIG9wdCA9IHtcclxuICAgICAgbGltaXQ6IERFRkFVTFRfTElNSVQsXHJcbiAgICAgIG51bGw6IERFRkFVTFRfTlVMTCxcclxuICAgICAgLi4ub3B0LFxyXG4gICAgICBzdHlsZTogeyB0YWJsZSwgdGQsIHRoIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gcmV0dXJuIGNvbnRhaW5lciBkaXYsIGJpbmQgdGFibGUgdmFsdWUgdG8gc3VwcG9ydCB2aWV3b2Ygb3BlcmF0b3JcclxuICAgIGNvbnN0IHNpemUgPSBgbWF4LWhlaWdodDogJHsrb3B0LmhlaWdodCB8fCAyNzB9cHhgO1xyXG4gICAgY29uc3Qgc3R5bGUgPSBgJHtzaXplfTsgb3ZlcmZsb3cteDogYXV0bzsgb3ZlcmZsb3cteTogYXV0bztgO1xyXG4gICAgY29uc3QgdmlldyA9IGh0bWxgPGRpdiBzdHlsZT1cIiR7c3R5bGV9XCI+JHtkdC50b0hUTUwob3B0KX08L2Rpdj5gO1xyXG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24odmlldywgeyB2YWx1ZTogZHQgfSk7XHJcbiAgfTtcclxufVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiBTY3J1YmJlcih2YWx1ZXMsIHtcclxuICBmb3JtYXQgPSB2YWx1ZSA9PiB2YWx1ZSxcclxuICBpbml0aWFsID0gMCxcclxuICBkaXJlY3Rpb24gPSAxLFxyXG4gIGRlbGF5ID0gbnVsbCxcclxuICBhdXRvcGxheSA9IHRydWUsXHJcbiAgbG9vcCA9IHRydWUsXHJcbiAgbG9vcERlbGF5ID0gbnVsbCxcclxuICBhbHRlcm5hdGUgPSBmYWxzZVxyXG59ID0ge30pIHtcclxuICB2YWx1ZXMgPSBBcnJheS5mcm9tKHZhbHVlcyk7XHJcbiAgY29uc3QgZm9ybSA9IGh0bWxgPGZvcm0gc3R5bGU9XCJmb250OiAxMnB4IHZhcigtLXNhbnMtc2VyaWYpOyBmb250LXZhcmlhbnQtbnVtZXJpYzogdGFidWxhci1udW1zOyBkaXNwbGF5OiBmbGV4OyBoZWlnaHQ6IDMzcHg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7XCI+XHJcbiAgPGJ1dHRvbiBuYW1lPWIgdHlwZT1idXR0b24gc3R5bGU9XCJtYXJnaW4tcmlnaHQ6IDAuNGVtOyB3aWR0aDogNWVtO1wiPjwvYnV0dG9uPlxyXG4gIDxsYWJlbCBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7XCI+XHJcbiAgICA8aW5wdXQgbmFtZT1pIHR5cGU9cmFuZ2UgbWluPTAgbWF4PSR7dmFsdWVzLmxlbmd0aCAtIDF9IHZhbHVlPSR7aW5pdGlhbH0gc3RlcD0xIHN0eWxlPVwid2lkdGg6IDE4MHB4O1wiPlxyXG4gICAgPG91dHB1dCBuYW1lPW8gc3R5bGU9XCJtYXJnaW4tbGVmdDogMC40ZW07XCI+PC9vdXRwdXQ+XHJcbiAgPC9sYWJlbD5cclxuPC9mb3JtPmA7XHJcbiAgbGV0IGZyYW1lID0gbnVsbDtcclxuICBsZXQgdGltZXIgPSBudWxsO1xyXG4gIGxldCBpbnRlcnZhbCA9IG51bGw7XHJcbiAgZnVuY3Rpb24gc3RhcnQoKSB7XHJcbiAgICBmb3JtLmIudGV4dENvbnRlbnQgPSBcIlBhdXNlXCI7XHJcbiAgICBpZiAoZGVsYXkgPT09IG51bGwpIGZyYW1lID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRpY2spO1xyXG4gICAgZWxzZSBpbnRlcnZhbCA9IHNldEludGVydmFsKHRpY2ssIGRlbGF5KTtcclxuICB9XHJcbiAgZnVuY3Rpb24gc3RvcCgpIHtcclxuICAgIGZvcm0uYi50ZXh0Q29udGVudCA9IFwiUGxheVwiO1xyXG4gICAgaWYgKGZyYW1lICE9PSBudWxsKSBjYW5jZWxBbmltYXRpb25GcmFtZShmcmFtZSksIGZyYW1lID0gbnVsbDtcclxuICAgIGlmICh0aW1lciAhPT0gbnVsbCkgY2xlYXJUaW1lb3V0KHRpbWVyKSwgdGltZXIgPSBudWxsO1xyXG4gICAgaWYgKGludGVydmFsICE9PSBudWxsKSBjbGVhckludGVydmFsKGludGVydmFsKSwgaW50ZXJ2YWwgPSBudWxsO1xyXG4gIH1cclxuICBmdW5jdGlvbiBydW5uaW5nKCkge1xyXG4gICAgcmV0dXJuIGZyYW1lICE9PSBudWxsIHx8IHRpbWVyICE9PSBudWxsIHx8IGludGVydmFsICE9PSBudWxsO1xyXG4gIH1cclxuICBmdW5jdGlvbiB0aWNrKCkge1xyXG4gICAgaWYgKGZvcm0uaS52YWx1ZUFzTnVtYmVyID09PSAoZGlyZWN0aW9uID4gMCA/IHZhbHVlcy5sZW5ndGggLSAxIDogZGlyZWN0aW9uIDwgMCA/IDAgOiBOYU4pKSB7XHJcbiAgICAgIGlmICghbG9vcCkgcmV0dXJuIHN0b3AoKTtcclxuICAgICAgaWYgKGFsdGVybmF0ZSkgZGlyZWN0aW9uID0gLWRpcmVjdGlvbjtcclxuICAgICAgaWYgKGxvb3BEZWxheSAhPT0gbnVsbCkge1xyXG4gICAgICAgIGlmIChmcmFtZSAhPT0gbnVsbCkgY2FuY2VsQW5pbWF0aW9uRnJhbWUoZnJhbWUpLCBmcmFtZSA9IG51bGw7XHJcbiAgICAgICAgaWYgKGludGVydmFsICE9PSBudWxsKSBjbGVhckludGVydmFsKGludGVydmFsKSwgaW50ZXJ2YWwgPSBudWxsO1xyXG4gICAgICAgIHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiAoc3RlcCgpLCBzdGFydCgpKSwgbG9vcERlbGF5KTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChkZWxheSA9PT0gbnVsbCkgZnJhbWUgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGljayk7XHJcbiAgICBzdGVwKCk7XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIHN0ZXAoKSB7XHJcbiAgICBmb3JtLmkudmFsdWVBc051bWJlciA9IChmb3JtLmkudmFsdWVBc051bWJlciArIGRpcmVjdGlvbiArIHZhbHVlcy5sZW5ndGgpICUgdmFsdWVzLmxlbmd0aDtcclxuICAgIGZvcm0uaS5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcImlucHV0XCIsIHtidWJibGVzOiB0cnVlfSkpO1xyXG4gIH1cclxuICBmb3JtLmkub25pbnB1dCA9IGV2ZW50ID0+IHtcclxuICAgIGlmIChldmVudCAmJiBldmVudC5pc1RydXN0ZWQgJiYgcnVubmluZygpKSBzdG9wKCk7XHJcbiAgICBmb3JtLnZhbHVlID0gdmFsdWVzW2Zvcm0uaS52YWx1ZUFzTnVtYmVyXTtcclxuICAgIGZvcm0uby52YWx1ZSA9IGZvcm1hdChmb3JtLnZhbHVlLCBmb3JtLmkudmFsdWVBc051bWJlciwgdmFsdWVzKTtcclxuICB9O1xyXG4gIGZvcm0uYi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgaWYgKHJ1bm5pbmcoKSkgcmV0dXJuIHN0b3AoKTtcclxuICAgIGRpcmVjdGlvbiA9IGFsdGVybmF0ZSAmJiBmb3JtLmkudmFsdWVBc051bWJlciA9PT0gdmFsdWVzLmxlbmd0aCAtIDEgPyAtMSA6IDE7XHJcbiAgICBmb3JtLmkudmFsdWVBc051bWJlciA9IChmb3JtLmkudmFsdWVBc051bWJlciArIGRpcmVjdGlvbikgJSB2YWx1ZXMubGVuZ3RoO1xyXG4gICAgZm9ybS5pLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwiaW5wdXRcIiwge2J1YmJsZXM6IHRydWV9KSk7XHJcbiAgICBzdGFydCgpO1xyXG4gIH07XHJcbiAgZm9ybS5pLm9uaW5wdXQoKTtcclxuICBpZiAoYXV0b3BsYXkpIHN0YXJ0KCk7XHJcbiAgZWxzZSBzdG9wKCk7XHJcbiAgSW5wdXRzLmRpc3Bvc2FsKGZvcm0pLnRoZW4oc3RvcCk7XHJcbiAgcmV0dXJuIGZvcm07XHJcbn1cclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiYXN5bmMgZnVuY3Rpb24gbmF2aW8oZGF0YSwgX29wdGlvbnMgPSB7fSkge1xyXG4gIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICBoZWlnaHQ6IDMwMCwgLy8gTmF2aW8ncyBoZWlnaHRcclxuICAgIGF0dHJpYnM6IG51bGwsIC8vIGFycmF5IG9mIGF0dHJpYiBuYW1lcyB0byBiZSB1c2VkLCBsZWF2ZSBhcyBudWxsIGZvciBhbGwgb2YgdGhlbVxyXG5cclxuICAgIHgwOiAwLCAvL1doZXJlIHRvIHN0YXJ0IGRyYXdpbmcgbmF2aW8gaW4geFxyXG4gICAgeTA6IDEwMCwgLy9XaGVyZSB0byBzdGFydCBkcmF3aW5nIG5hdmlvIGluIHksIHVzZWZ1bCBpZiB5b3VyIGF0dHJpYiBuYW1lcyBhcmUgdG9vIGxvbmdcclxuICAgIG1heE51bURpc3RpY3RGb3JDYXRlZ29yaWNhbDogMTAsIC8vIGFkZEFsbEF0dHJpYnMgdXNlcyB0aGlzIGZvciBkZWNpZGluZyBpZiBhbiBhdHRyaWJ1dGUgaXMgY2F0ZWdvcmljYWwgKGhhcyBsZXNzIHRoYW4gICAgIG1heE51bURpc3RpY3RGb3JDYXRlZ29yaWNhbCBjYXRlZ29yaWVzKSBvciBvcmRlcmVkXHJcbiAgICBtYXhOdW1EaXN0aWN0Rm9yT3JkZXJlZDogOTAsIC8vIGFkZEFsbEF0dHJpYnMgdXNlcyB0aGlzIGZvciBkZWNpZGluZyBpZiBhbiBhdHRyaWJ1dGUgaXMgb3JkZXJlZCAoaGFzIGxlc3MgdGhhbiAgICAgbWF4TnVtRGlzdGljdEZvckNhdGVnb3JpY2FsIGNhdGVnb3JpZXMpIG9yIHRleHQuIFVzZSAgICBtYXhOdW1EaXN0aWN0Rm9yT3JkZXJlZCA6IEluZmluaXR5IGZvciBuZXZlciBjaG9vc2luZyBUZXh0XHJcblxyXG4gICAgaG93TWFueUl0ZW1zU2hvdWxkU2VhcmNoRm9yTm90TnVsbDogMTAwLCAvLyBIb3cgbWFueSByb3dzIHNob3VsZCBhZGRBbGxBdHRyaWJzIHNlYXJjaCB0byBkZWNpZGUgZ3Vlc3MgYW4gYXR0cmlidXRlIHR5cGVcclxuICAgIG1hcmdpbjogMTAsIC8vIE1hcmdpbiBhcm91bmQgbmF2aW9cclxuXHJcbiAgICBsZXZlbHNTZXBhcmF0aW9uOiA0MCwgLy8gU2VwYXJhdGlvbiBiZXR3ZWVuIHRoZSBsZXZlbHNcclxuICAgIGRpdmlzaW9uc0NvbG9yOiBcIndoaXRlXCIsIC8vIEJvcmRlciBjb2xvciBmb3IgdGhlIGRpdmlzaW9uc1xyXG4gICAgbGV2ZWxDb25uZWN0aW9uc0NvbG9yOiBcInJnYmEoMjA1LCAyMjAsIDE2MywgMC41KVwiLCAvLyBDb2xvciBmb3IgdGhlIGNvbmVjdGlvbnMgYmV0d2VlbiBsZXZlbHNcclxuICAgIGRpdmlzaW9uc1RocmVzaG9sZDogNCwgLy8gV2hhdCdzIHRoZSBtaW5pbXVtIHJvdyBoZWlnaHQgbmVlZGVkIHRvIGRyYXcgZGl2aXNpb25zXHJcbiAgICBmbXRDb3VudHM6IGQzLmZvcm1hdChcIiwuMGRcIiksIC8vIEZvcm1hdCB1c2VkIHRvIGRpc3BsYXkgdGhlIGNvdW50cyBvbiB0aGUgYm90dG9tXHJcbiAgICBsZWdlbmRGb250OiBcIjE0cHggc2Fucy1zZXJpZlwiLCAvLyBUaGUgZm9udCBmb3IgdGhlIGhlYWRlclxyXG4gICAgbmVzdGVkRmlsdGVyczogdHJ1ZSwgLy8gU2hvdWxkIG5hdmlvIHVzZSBuZXN0ZWQgbGV2ZWxzP1xyXG5cclxuICAgIHNob3dBdHRyaWJUaXRsZXM6IHRydWUsIC8vIFNob3cgaGVhZGVycz9cclxuICAgIGF0dHJpYldpZHRoOiAxNSwgLy8gV2lkdGggb2YgdGhlIGNvbHVtbnNcclxuICAgIGF0dHJpYlJvdGF0aW9uOiAtNDUsIC8vIEhlYWRlcnMgcm90YXRpb25cclxuICAgIGF0dHJpYkZvbnRTaXplOiAxMywgLy8gSGVhZGVycyBmb250IHNpemVcclxuICAgIGF0dHJpYkZvbnRTaXplU2VsZWN0ZWQ6IDMyLCAvLyBIZWFkZXJzIGZvbnQgc2l6ZSB3aGVuIG1vdXNlIG92ZXJcclxuXHJcbiAgICBmaWx0ZXJGb250U2l6ZTogMTAsIC8vIEZvbnQgc2l6ZSBvZiB0aGUgZmlsdGVycyBleHBsYW5hdGlvbnMgb24gdGhlIGJvdHRvbVxyXG5cclxuICAgIHRvb2x0aXBGb250U2l6ZTogMTIsIC8vIEZvbnQgc2l6ZSBmb3IgdGhlIHRvb2x0aXBcclxuICAgIHRvb2x0aXBCZ0NvbG9yOiBcIiNiMmRkZjFcIiwgLy8gRm9udCBjb2xvciBmb3IgdG9vbHRpcCBiYWNrZ3JvdW5kXHJcbiAgICB0b29sdGlwTWFyZ2luOiA1MCwgLy8gSG93IG11Y2ggdG8gc2VwYXJhdGUgdGhlIHRvb2x0aXAgZnJvbSB0aGUgY3Vyc29yXHJcbiAgICB0b29sdGlwQXJyb3dTaXplOiAxMCwgLy8gSG93IGJpZyBpcyB0aGUgYXJyb3cgb24gdGhlIHRvb2x0aXBcclxuXHJcbiAgICBkaWdpdHNGb3JUZXh0OiAyLCAvLyBIb3cgbWFueSBkaWdpdHMgdG8gdXNlIGZvciB0ZXh0IGF0dHJpYnV0ZXNcclxuXHJcbiAgICBhZGRBbGxBdHRyaWJzUmVjdXJzaW9uTGV2ZWw6IEluZmluaXR5LCAvLyBIb3cgbWFueSBsZXZlbHMgZGVwdGggZG8gd2Uga2VlcCBvbiBhZGRpbmcgbmVzdGVkIGF0dHJpYnV0ZXNcclxuICAgIGFkZEFsbEF0dHJpYnNJbmNsdWRlT2JqZWN0czogdHJ1ZSwgLy8gU2hvdWxkIGFkZEFsbEF0dHJpYnMgaW5jbHVkZSBvYmplY3RzXHJcbiAgICBhZGRBbGxBdHRyaWJzSW5jbHVkZUFycmF5czogdHJ1ZSwgLy8gU2hvdWxkIGFkZEFsbEF0dHJpYnMgaW5jbHVkZSBhcnJheXNcclxuXHJcbiAgICBudWxsQ29sb3I6IFwiI2ZmZWRmZFwiLCAvLyBDb2xvciBmb3IgbnVsbCB2YWx1ZXNcclxuICAgIGRlZmF1bHRDb2xvckludGVycG9sYXRvcjogZDMuaW50ZXJwb2xhdGVCbHVlcyxcclxuICAgIGRlZmF1bHRDb2xvckludGVycG9sYXRvckRhdGU6IGQzLmludGVycG9sYXRlUHVycGxlcyxcclxuICAgIGRlZmF1bHRDb2xvckludGVycG9sYXRvckRpdmVyZ2luZzogZDMuaW50ZXJwb2xhdGVCckJHLFxyXG4gICAgZGVmYXVsdENvbG9ySW50ZXJwb2xhdG9yT3JkZXJlZDogZDMuaW50ZXJwb2xhdGVPcmFuZ2VzLFxyXG4gICAgZGVmYXVsdENvbG9ySW50ZXJwb2xhdG9yVGV4dDogZDMuaW50ZXJwb2xhdGVHcmV5cyxcclxuICAgIGRlZmF1bHRDb2xvclJhbmdlQm9vbGVhbjogW1wiI2ExZDc2YVwiLCBcIiNlOWEzYzlcIiwgXCJ3aGl0ZVwiXSwgLy90cnVlIGZhbHNlIG51bGxcclxuICAgIGRlZmF1bHRDb2xvclJhbmdlU2VsZWN0ZWQ6IFtcIndoaXRlXCIsIFwiI2I1Y2Y2YlwiXSxcclxuICAgIGRlZmF1bHRDb2xvckNhdGVnb3JpY2FsOiBkMy5zY2hlbWVDYXRlZ29yeTEwLFxyXG5cclxuICAgIHNob3dTZWxlY3RlZEF0dHJpYjogdHJ1ZSwgLy8gRGlzcGxheSB0aGUgYXR0cmlidXRlIHRoYXQgc2hvd3MgaWYgYSByb3cgaXMgc2VsZWN0ZWRcclxuICAgIHNob3dTZXF1ZW5jZUlEQXR0cmliOiB0cnVlLCAvLyBEaXNwbGF5IHRoZSBhdHRyaWJ1dGUgd2l0aCB0aGUgc2VxdWVuY2UgSURcclxuXHJcbiAgICAuLi5fb3B0aW9uc1xyXG4gIH07XHJcblxyXG4gIGxldCBkaXYgPSBodG1sYDxkaXYgIHN0eWxlPVwiZGlzcGxheTpibG9jazsgb3ZlcmZsb3cteDpzY3JvbGxcIj48L2Rpdj5gO1xyXG4gIFxyXG4gIC8vIENyZWF0ZSB0aGUgbmF2aW9cclxuICBjb25zdCBudiA9IG5hdmlvX25wbShkMy5zZWxlY3QoZGl2KSwgb3B0aW9ucy5oZWlnaHQpO1xyXG5cclxuICBmb3IgKGxldCBvcHQgaW4gb3B0aW9ucykge1xyXG4gICAgaWYgKG9wdCA9PT0gXCJpZFwiKSB7XHJcbiAgICAgIG52LmlkKG9wdGlvbnNbb3B0XSk7XHJcbiAgICB9IGVsc2UgaWYgKG9wdCAhPT0gXCJhdHRyaWJzXCIpIHtcclxuICAgICAgbnZbb3B0XSA9IG9wdGlvbnNbb3B0XTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEFkZCB0aGUgZGF0YVxyXG4gIG52LmRhdGEoZGF0YSk7XHJcblxyXG4gIGlmIChvcHRpb25zLmF0dHJpYnMpIHtcclxuICAgIG52LmFkZEFsbEF0dHJpYnMob3B0aW9ucy5hdHRyaWJzKTtcclxuICB9IGVsc2Uge1xyXG4gICAgbnYuYWRkQWxsQXR0cmlicygpO1xyXG4gIH1cclxuXHJcbiAgbnYudXBkYXRlQ2FsbGJhY2soKCkgPT4ge1xyXG4gICAgZGl2LnZhbHVlID0gbnYuZ2V0VmlzaWJsZSgpO1xyXG4gICAgZGl2LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KFwiaW5wdXRcIiwgeyBidWJibGVzOiB0cnVlIH0pKTtcclxuICAgIC8vIG5vdGlmeShkaXYpO1xyXG4gIH0pO1xyXG5cclxuICBkaXYudmFsdWUgPSBkYXRhO1xyXG4gIGRpdi5udiA9IG52O1xyXG4gIHJldHVybiBkaXY7XHJcbn1cclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGF0YV9odWJzMCA9IEZpbGVBdHRhY2htZW50KFwiSHVic19iaW9lY19jb2wyLmNzdlwiKS5jc3YoeyB0eXBlZDogdHJ1ZSB9KVxyXG5kYXRhX2h1YnMgPSBkYXRhX2h1YnMwLm1hcChkID0+ICh7IC4uLmQsIG5hbWU6IGQucGxhdGZvcm0sIHR5cGU6IFwiQmlvZWNvbm9teVwiIH0pKTtcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC05IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZERhdGEgPSBuZXcgTWFwKGRhdGFfaHVicy5tYXAoZCA9PiBbZC5uYW1lLCBkXSkpXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJodWxsQ29sb3IgPSBkMy5zY2FsZU9yZGluYWwoXHJcbiAgZDMucXVhbnRpemUoXHJcbiAgICBjb2xvckludGVycG9sYXRvcixcclxuICAgIHRpZHlEYXRhLmdyb3VwYnkoZ3JvdXBCeSkuY291bnQoKS5vYmplY3RzKCkubGVuZ3RoXHJcbiAgKVxyXG4pXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJkQ29ubmVjdGlvbnMgPSBuZXcgTWFwKClcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImdyYXBoID0ge1xyXG4gIGZvciAobGV0IG4gb2YgZERhdGEudmFsdWVzKCkpIHtcclxuICAgIG4uZGVncmVlID0gMDtcclxuICB9XHJcblxyXG4gIGNvbnN0IGxpbmtzQXJyYXkgPSBsaW5rcy5vYmplY3RzKCk7XHJcbiAgZm9yIChsZXQgbCBvZiBsaW5rc0FycmF5KSB7XHJcbiAgICBjb25zdCBzb3VyY2UgPSBkRGF0YS5nZXQobC5zb3VyY2UpO1xyXG4gICAgLy8gdGFyZ2V0ID0gZE5vZGVzLmdldChsLnRhcmdldCk7XHJcblxyXG4gICAgc291cmNlLmNsdXN0ZXIgPSBsLnRhcmdldDtcclxuICAgIC8vIHRhcmdldC5jbHVzdGVyID0gbC50YXJnZXQ7XHJcbiAgICBzb3VyY2UuZGVncmVlICs9IDE7XHJcbiAgICAvLyB0YXJnZXQuZGVncmVlICs9IDE7XHJcbiAgfVxyXG5cclxuICBjb25zdCBnZXRPckNyZWF0ZU5vZGUgPSAobmFtZSkgPT4ge1xyXG4gICAgbGV0IG5vZGUgPSBkQ29ubmVjdGlvbnMuZ2V0KG5hbWUpO1xyXG5cclxuICAgIGlmICghbm9kZSkge1xyXG4gICAgICBub2RlID0ge1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgdHlwZTogXCJDb25uZWN0aW9uXCIsXHJcbiAgICAgICAgY2x1c3RlcjogbmFtZSxcclxuICAgICAgICB4OiB3aWR0aCAvIDIgKyAoTWF0aC5yYW5kb20oKSAqIHdpZHRoKSAvIDEwLFxyXG4gICAgICAgIHk6IGZoZWlnaHRfbm9kZS5oZWlnaHQgLyAyICsgKE1hdGgucmFuZG9tKCkgKiBmaGVpZ2h0X25vZGUuaGVpZ2h0KSAvIDEwXHJcbiAgICAgIH07XHJcbiAgICAgIGRDb25uZWN0aW9ucy5zZXQobmFtZSwgbm9kZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbm9kZTtcclxuICB9O1xyXG5cclxuICAvLyAtLS0tLS0tLS0gRmlsdGVyIExpbmtzIGFuZCBOb2RlcyAtLS0tLS0tLS0tLS0tLVxyXG4gIGNvbnN0IGZpbHRlcmVkTGlua3MgPSBsaW5rc0FycmF5Lm1hcCgobCkgPT4ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc291cmNlOiBkRGF0YS5nZXQobC5zb3VyY2UpLFxyXG4gICAgICB0YXJnZXQ6IGdldE9yQ3JlYXRlTm9kZShsLnRhcmdldClcclxuICAgIH07XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGZpbHRlcmVkTm9kZXNPYmplY3QgPSBmaWx0ZXJlZExpbmtzLnJlZHVjZShcclxuICAgIChwLCBsKSA9PiB7XHJcbiAgICAgIGlmICghcC5zZXQuaGFzKGwuc291cmNlLm5hbWUpKSB7XHJcbiAgICAgICAgcC5zZXQuYWRkKGwuc291cmNlLm5hbWUpO1xyXG4gICAgICAgIHAubGlzdC5wdXNoKGwuc291cmNlKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoIXAuc2V0LmhhcyhsLnRhcmdldC5uYW1lKSkge1xyXG4gICAgICAgIHAuc2V0LmFkZChsLnRhcmdldC5uYW1lKTtcclxuICAgICAgICBwLmxpc3QucHVzaChsLnRhcmdldCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBwO1xyXG4gICAgfSxcclxuICAgIHsgc2V0OiBuZXcgU2V0KCksIGxpc3Q6IFtdIH1cclxuICApO1xyXG5cclxuICAvLyBDbHVzdGVycyBpcyB1c2VkIGZvciB0aGUgaHVsbHNcclxuICBjb25zdCBjbHVzdGVycyA9IGQzLnJvbGx1cHMoXHJcbiAgICBmaWx0ZXJlZExpbmtzLFxyXG4gICAgKHYpID0+IHYubWFwKChsKSA9PiBsLnNvdXJjZSkuY29uY2F0KFt2WzBdLnRhcmdldF0pLFxyXG4gICAgKGQpID0+IGQudGFyZ2V0Lm5hbWVcclxuICApO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgbm9kZXM6IGZpbHRlcmVkTm9kZXNPYmplY3QubGlzdCxcclxuICAgIGxpbmtzOiBsaW5rc0FycmF5LFxyXG4gICAgY2x1c3RlcnM6IGNsdXN0ZXJzXHJcbiAgfTtcclxufVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGF0ZUZtdCA9IGQzLnRpbWVQYXJzZShcIiVtLyVkLyV5XCIpXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ0aWR5RGF0YSA9IGFxXHJcbiAgLmZyb20oZGF0YV9odWJzKVxyXG4gIC5kZXJpdmUoe1xyXG4gICAgXCJyZXNlYXJjaF9saW5lXCI6IChkKSA9PlxyXG4gICAgICBkW1wicmVzZWFyY2hfbGluZVwiXSA9PT0gbnVsbCA/IFtudWxsXSA6IG9wLnNwbGl0KGRbXCJyZXNlYXJjaF9saW5lXCJdLCBcIjtcIiksXHJcbiAgICBcImRlcGFydG1lbnRzXCI6IChkKSA9PlxyXG4gICAgICBkW1wiZGVwYXJ0bWVudHNcIl0gPT09IG51bGwgPyBbbnVsbF0gOiBvcC5zcGxpdChkW1wiZGVwYXJ0bWVudHNcIl0sIFwiO1wiKVxyXG4gIH0pXHJcbiAgLnVucm9sbChcInJlc2VhcmNoX2xpbmVcIilcclxuICAudW5yb2xsKFwiZGVwYXJ0bWVudHNcIilcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImxpbmtzID0gdGlkeURhdGFcclxuICAuZmlsdGVyKGFxLmVzY2FwZSgoZCkgPT4gIWQueWVhciB8fCBkLnllYXIgPD0gbWluRGF0ZSkpIC8vIEZpbHRlciBieSBEYXRlXHJcbiAgLmRlcml2ZSh7XHJcbiAgICBzb3VyY2U6IChkKSA9PiBkLm5hbWUsXHJcbiAgICB0YXJnZXQ6IGFxLmVzY2FwZSgoZCkgPT4gZFtncm91cEJ5XSlcclxuICB9KVxyXG4gIC5ncm91cGJ5KFtcInNvdXJjZVwiLCBcInRhcmdldFwiXSlcclxuICAuY291bnQoKVxyXG4gIC5maWx0ZXIoKGQpID0+IGQudGFyZ2V0ICYmIGQuc291cmNlKSAvLyBJZ25vcmUgbnVsbHNcclxuICAuZmlsdGVyKGFxLmVzY2FwZSgoZCkgPT4gc2VsZWN0ZWRUYXJnZXRzLmluY2x1ZGVzKGQudGFyZ2V0KSkpIC8vIEZpbHRlciBieSBzZWxlY3RlZFRhcmdldFxyXG4gIC5zZWxlY3QoW1wic291cmNlXCIsIFwidGFyZ2V0XCJdKVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidGFyZ2V0cyA9IGxpbmtzXHJcbiAgLmdyb3VwYnkoXCJ0YXJnZXRcIilcclxuICAuY291bnQoKVxyXG4gIC5yZW5hbWUoeyB0YXJnZXQ6IFwibmFtZVwiIH0pXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJzb3VyY2VzID0gbGlua3NcclxuICAuZ3JvdXBieShcInNvdXJjZVwiKVxyXG4gIC5jb3VudCgpXHJcbiAgLnJlbmFtZSh7IHNvdXJjZTogXCJuYW1lXCIgfSlcclxuICAuZGVyaXZlKHsgdHlwZTogKCkgPT4gXCJCaW9lY29ub215XCIgfSlcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImNvbF9uYW1lcyA9IE9iamVjdC5rZXlzKGRhdGFfaHVic1swXSlcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InRlbXBsYXRlXzIgPSAoaW5wdXRzKSA9PiBcclxuICBodGwuaHRtbGBcclxuICAgIDxkaXYgY2xhc3M9XCJzdHlsZWQtdGVtcGxhdGUtMlwiPlxyXG4gICAgICAke09iamVjdC52YWx1ZXMoaW5wdXRzKX1cclxuICAgIDwvZGl2PlxyXG4gICAgPHN0eWxlPlxyXG4gICAgICAuc3R5bGVkLXRlbXBsYXRlLTIge1xyXG4gICAgICAgIHRleHQtYWxpZ246IGxlZnQ7XHJcbiAgICAgICAgY29sdW1uLWNvdW50OiAyOyAvKiBNYW50aWVuZSAyIGNvbHVtbmFzICovXHJcbiAgICAgICAgY29sdW1uLWdhcDogMjBweDsgLyogRXNwYWNpbyBlbnRyZSBjb2x1bW5hcyAqL1xyXG4gICAgICAgIG1heC13aWR0aDogNjAwcHg7IC8qIEFuY2hvIG3DoXhpbW8gZGVsIGZvcm11bGFyaW8gKi9cclxuICAgICAgICBtYXJnaW4tbGVmdDogMDsgLyogQWxpbmVhIGEgbGEgaXpxdWllcmRhICovXHJcbiAgICAgIH1cclxuICAgICAgLnN0eWxlZC10ZW1wbGF0ZS0yIGxhYmVsIHtcclxuICAgICAgICBmb250LXdlaWdodDogYm9sZDtcclxuICAgICAgICBsaW5lLWhlaWdodDogMjAwJTtcclxuICAgICAgfVxyXG4gICAgICAuc3R5bGVkLXRlbXBsYXRlLTIgbGFiZWw6bm90KGRpdj5sYWJlbCk6OmFmdGVyIHtcclxuICAgICAgICBjb250ZW50OiBcIjpcIjtcclxuICAgICAgfVxyXG4gICAgPC9zdHlsZT5cclxuICBgO1xyXG5cclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InRlbXBsYXRlXzQgPSAoaW5wdXRzKSA9PiBcclxuICBodGwuaHRtbGBcclxuICAgIDxkaXYgY2xhc3M9XCJzdHlsZWRcIj5cclxuICAgICAgJHtPYmplY3QuZW50cmllcyhpbnB1dHMpLm1hcCgoW2tleSwgaW5wdXRdKSA9PiB7XHJcbiAgICAgICAgLy8gRXh0cmFjdCB0aGUgbGFiZWwgdGV4dCBmcm9tIHRoZSBpbnB1dCwgaWYgYW55LCBhbmQgcmVtb3ZlIGl0IHRvIHByZXZlbnQgZHVwbGljYXRpb25cclxuICAgICAgICBjb25zdCBsYWJlbFRleHQgPSBpbnB1dC5xdWVyeVNlbGVjdG9yKCdsYWJlbCcpID8gaW5wdXQucXVlcnlTZWxlY3RvcignbGFiZWwnKS50ZXh0Q29udGVudCA6IFwiXCI7XHJcbiAgICAgICAgaWYgKGlucHV0LnF1ZXJ5U2VsZWN0b3IoJ2xhYmVsJykpIGlucHV0LnF1ZXJ5U2VsZWN0b3IoJ2xhYmVsJykucmVtb3ZlKCk7XHJcbiAgICAgICAgcmV0dXJuIGh0bC5odG1sYFxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImlucHV0LWdyb3VwXCI+XHJcbiAgICAgICAgICAgIDxsYWJlbD4ke2xhYmVsVGV4dH08L2xhYmVsPlxyXG4gICAgICAgICAgICAke2lucHV0fVxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgYDtcclxuICAgICAgfSl9XHJcbiAgICA8L2Rpdj5cclxuICAgIDxzdHlsZT5cclxuICAgICAgZGl2LnN0eWxlZCB7XHJcbiAgICAgICAgdGV4dC1hbGlnbjogbGVmdDtcclxuICAgICAgICBjb2x1bW4tY291bnQ6IDQ7IC8qIFNldCB0byA0IGNvbHVtbnMgKi9cclxuICAgICAgICBjb2x1bW4tZ2FwOiAyMHB4OyAvKiBTcGFjZSBiZXR3ZWVuIGNvbHVtbnMgKi9cclxuICAgICAgfVxyXG4gICAgICBkaXYuaW5wdXQtZ3JvdXAge1xyXG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICAgICAgICBtYXJnaW4tYm90dG9tOiAxMHB4OyAvKiBTcGFjZSBiZXR3ZWVuIGlucHV0cyAqL1xyXG4gICAgICB9XHJcbiAgICAgIGRpdi5pbnB1dC1ncm91cCBsYWJlbCB7XHJcbiAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbiAgICAgICAgbWFyZ2luLWJvdHRvbTogNXB4OyAvKiBTcGFjZSBiZXR3ZWVuIGxhYmVsIGFuZCBjb250cm9sICovXHJcbiAgICAgIH1cclxuICAgIDwvc3R5bGU+XHJcbiAgYDtcclxuXHJcblxyXG5cclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBtaW5EYXRlID0ge1xyXG4gIGNvbnN0IGRhdGVzID0gZGF0YV9odWJzXHJcbiAgICAubWFwKChkKSA9PiBkLnllYXIpXHJcbiAgICAuZmlsdGVyKChkKSA9PiBkKVxyXG4gICAgLnNvcnQoKGEsIGIpID0+IGQzLmFzY2VuZGluZygrYSwgK2IpKTtcclxuICByZXR1cm4gU2NydWJiZXIoZGF0ZXMsIHtcclxuICAgIGRlbGF5OiA1MDAsXHJcbiAgICBhdXRvcGxheTogZmFsc2UsXHJcbiAgICBsb29wOmZhbHNlLFxyXG4gICAgaW5pdGlhbDogZGF0ZXMubGVuZ3RoLTFcclxuICB9KTtcclxufVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGdyb3VwQnkgPSB7XHJcbiAgY29uc3QgYXR0cnMgPSBbXHJcbiAgLy9cInBsYXRhZm9ybWFcIixcclxuICAvL1wiZGVzY3JpcGNpb25cIixcclxuICAvL1wibGlua1wiLFxyXG4gIFwidGhlbWF0aWNcIixcclxuICBcInBoYXNlc1wiLFxyXG4gIFwicmVsYXRpb25cIixcclxuICBcInJlc2VhcmNoX2xpbmVcIixcclxuICAvL1wicGFydG5lcnNcIixcclxuICAvL1wiY291bnRyeV9ob3N0XCIsXHJcbiAgLy8vL1wieWVhclwiLFxyXG4gIC8vXCJkZXBhcnRhbWVudG9zXCIsXHJcbiAgLy9cImRlZl9iaW9lY29ub21pYVwiXHJcbiAgLy9cInJlbGFjaW9uZXNcIlxyXG4gIC8vXCJsb2dvXCJcclxuICAvL1wibG9nb192aXpcIlxyXG4gIC8vXCJsYXRfaG9zdFwiXHJcbiAgLy9cImxvbmdfaG9zdFwiXHJcbiAgXTtcclxuICByZXR1cm4gSW5wdXRzLnNlbGVjdChhdHRycywgeyBsYWJlbDogXCJHcm91cFwiLCB2YWx1ZTogXCJwaGFzZXNcIiB9KTtcclxufVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHNlbGVjdGVkVGFyZ2V0cyA9IHtcclxuICBjb25zdCB0YXJnZXROYW1lcyA9IHRpZHlEYXRhXHJcbiAgICAuZ3JvdXBieShncm91cEJ5KVxyXG4gICAgLmNvdW50KClcclxuICAgIC5vYmplY3RzKClcclxuICAgIC5tYXAoKGQpID0+IGRbZ3JvdXBCeV0pXHJcbiAgICAuZmlsdGVyKChkKSA9PiBkKTtcclxuICBjb25zdCBzZWxlY3Rpb24gPVxyXG4gICAgZ3JvdXBCeSA9PT0gXCJyZXNlYXJjaF9saW5lXCJcclxuICAgICAgPyB0YXJnZXROYW1lcy5maWx0ZXIoKGQpID0+ICFbXCJCaW9pbmR1c3Ryw61hXCIsXCJCaW9lbmVyZ8OtYVwiLFwiRm9yZXN0YWxcIl0uaW5jbHVkZXMoZCkpXHJcbiAgICAgIDogdGFyZ2V0TmFtZXM7XHJcbiAgY29uc3QgY3IgPSAxNTtcclxuICByZXR1cm4gSW5wdXRzLmNoZWNrYm94KHRhcmdldE5hbWVzLCB7XHJcbiAgICBsYWJlbDogXCJTaG93XCIsXHJcbiAgICB2YWx1ZTogc2VsZWN0aW9uLFxyXG4gICAgZm9ybWF0OiAoZCkgPT4gaHRtbGA8ZGl2IHN0eWxlPVwiaGVpZ2h0OiAke2NyfXB4O1xyXG4gICAgbGluZS1oZWlnaHQ6ICR7Y3J9cHg7IFxyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGFsaWduLWNvbnRlbnQ6IGNlbnRlcjtcclxuICAgIGZsZXgtd3JhcDogd3JhcDtcclxuXCI+PHN2ZyB3aWR0aD0ke2NyfSBoZWlnaHQ9JHtjcn0gc3R5bGU9XCJtYXJnaW4tcmlnaHQ6NXB4XCI+XHJcbjxjaXJjbGUgcj0ke2NyIC8gMn0gY3g9JHtjciAvIDJ9IGN5PSR7Y3IgLyAyfSBmaWxsPVwiJHtodWxsQ29sb3IoZCl9XCIvPiBcclxuPC9zdmc+XHJcbiR7ZH08L2Rpdj5gXHJcbiAgfSk7XHJcbn1cclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBmaGVpZ2h0X25vZGUgPSAoXHJcbiAgSW5wdXRzLmZvcm0oe1xyXG4gIGhlaWdodDogSW5wdXRzLnJhbmdlKFsyMDAsIDE0MDBdLCB7bGFiZWw6IFwiSGVpZ2h0XCIsIHN0ZXA6MSwgdmFsdWU6IDQyMH0pLFxyXG4gIG5vZGVTaXplOiBJbnB1dHMucmFuZ2UoWzIsIDMwXSwge2xhYmVsOiBcIk5vZGUgU2l6ZVwiLHZhbHVlOiAyMyxzdGVwOiAxfSl9LFxyXG4gIHtcclxuICAgIHRlbXBsYXRlOiB0ZW1wbGF0ZV8yIFxyXG4gIH0pXHJcbiAgKVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTI1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiY2hhcnQgPSB7XHJcbiAgY29uc3Qgc3ZnID0gZDMuY3JlYXRlKFwic3ZnXCIpXHJcbiAgICAuYXR0cihcIndpZHRoXCIsIHdpZHRoKVxyXG4gICAgLmF0dHIoXCJoZWlnaHRcIiwgZmhlaWdodF9ub2RlLmhlaWdodClcclxuICAgIC5hdHRyKFwidmlld0JveFwiLCBbMCwgMCwgd2lkdGgsIGZoZWlnaHRfbm9kZS5oZWlnaHRdKVxyXG4gICAgLmF0dHIoXCJzdHlsZVwiLCBcIm1heC13aWR0aDogMTAwJTsgaGVpZ2h0OiBhdXRvOyBoZWlnaHQ6IGludHJpbnNpYzsgb3ZlcmZsb3c6IHZpc2libGVcIik7XHJcblxyXG4gIGdyYXBoLm5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGQpIHtcclxuICAgIGQuciA9IGQudHlwZSA9PT0gXCJCaW9lY29ub215XCIgPyBmaGVpZ2h0X25vZGUubm9kZVNpemUgKiAoZC5kZWdyZWUgLyAyICsgMSkgOiBmaHBhZGRpbmdfYm94LmdyZXlOb2RlU2l6ZTtcclxuICB9KTtcclxuXHJcbiAgY29uc3QgY2hhcmdlU2NhbGUgPSBkMy5zY2FsZUxpbmVhcigpXHJcbiAgICAuZG9tYWluKFsyMCwgMTYwXSlcclxuICAgIC5yYW5nZShbd2lkdGggPCA4MDAgPyAtMTAwIDogLTIwMCwgd2lkdGggPCA4MDAgPyAtNTAgOiAtMTAwXSk7XHJcblxyXG4gIGNvbnN0IGNoYXJnZVN0cmVuZ3RoID0gZnVuY3Rpb24gKGQpIHtcclxuICAgIHJldHVybiAoZmhlaWdodF9ub2RlLm5vZGVTaXplIC8gMTApICogKGQuZGVncmVlID4gMSA/IDEgOiAwLjcpICogY2hhcmdlU2NhbGUoZ3JhcGgubm9kZXMubGVuZ3RoKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBzaW11bGF0aW9uID0gZDMuZm9yY2VTaW11bGF0aW9uKGdyYXBoLm5vZGVzKVxyXG4gICAgLmFscGhhKDMpXHJcbiAgICAuZm9yY2UoXHJcbiAgICAgIFwibGlua1wiLFxyXG4gICAgICBkMy5mb3JjZUxpbmsoZ3JhcGgubGlua3MpXHJcbiAgICAgICAgLmlkKGQgPT4gZC5uYW1lKVxyXG4gICAgICAgIC5kaXN0YW5jZSgxMClcclxuICAgICAgICAuc3RyZW5ndGgoMC4xKVxyXG4gICAgKVxyXG4gICAgLmZvcmNlKFwiY2hhcmdlXCIsIGQzLmZvcmNlTWFueUJvZHkoKS5zdHJlbmd0aChjaGFyZ2VTdHJlbmd0aCkpXHJcbiAgICAuZm9yY2UoXCJjb2xsaWRlXCIsIGQzLmZvcmNlQ29sbGlkZShkID0+IGQuciArIDMpLml0ZXJhdGlvbnMoNCkpXHJcbiAgICAuZm9yY2UoXCJ4XCIsIGQzLmZvcmNlWCh3aWR0aCAvIDIpLnN0cmVuZ3RoKDAuMSkpXHJcbiAgICAuZm9yY2UoXCJ5XCIsIGQzLmZvcmNlWShmaGVpZ2h0X25vZGUuaGVpZ2h0IC8gMikuc3RyZW5ndGgoKDAuMDcgKiB3aWR0aCkgLyBmaGVpZ2h0X25vZGUuaGVpZ2h0KSk7XHJcblxyXG4gIGNvbnN0IGFyZWEgPSBkMy5saW5lKCkuY3VydmUoZDMuY3VydmVDYXJkaW5hbENsb3NlZCk7XHJcbiAgY29uc3QgaHAgPSBmaHBhZGRpbmdfYm94Lmh1bGxQYWRkaW5nO1xyXG5cclxuICBjb25zdCBnZXRIdWxsID0gZnVuY3Rpb24gKGQpIHtcclxuICAgIGNvbnN0IHBvaW50cyA9IGRbMV1cclxuICAgICAgLmZpbHRlcihkID0+IGZjbGFiZWxzX2NoZWNrLnNob3dHcm91cGluZ05vZGVzIHx8IGQudHlwZSA9PT0gXCJCaW9lY29ub215XCIpXHJcbiAgICAgIC5tYXAobiA9PiBbXHJcbiAgICAgICAgW24ueCAtIChuLnIgKyBocCksIG4ueV0sXHJcbiAgICAgICAgW24ueCArIG4uciArIGhwLCBuLnldLFxyXG4gICAgICAgIFtuLngsIG4ueSArIG4uciArIGhwXSxcclxuICAgICAgICBbbi54LCBuLnkgLSAobi5yICsgaHApXVxyXG4gICAgICBdKVxyXG4gICAgICAuZmxhdCgpO1xyXG4gICAgY29uc3QgaHVsbCA9IGQzLnBvbHlnb25IdWxsKHBvaW50cyk7XHJcbiAgICByZXR1cm4gaHVsbCAmJiBhcmVhKGh1bGwpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGh1bGxHID0gc3ZnLmFwcGVuZChcImdcIikuYXR0cihcImlkXCIsIFwiZ0h1bGxzXCIpO1xyXG4gIGNvbnN0IGh1bGwgPSBodWxsR1xyXG4gICAgLnNlbGVjdEFsbChcInBhdGguaHVsbFwiKVxyXG4gICAgLmRhdGEoXHJcbiAgICAgIGdyYXBoLmNsdXN0ZXJzLmZpbHRlcihkID0+ICF0cnVlIHx8IGRbMF0gIT09IFwiS2hvdXJ5IENvbGxlZ2Ugb2YgQ29tcHV0ZXIgU2NpZW5jZXNcIiksXHJcbiAgICAgIGQgPT4gZFswXVxyXG4gICAgKVxyXG4gICAgLmpvaW4oXCJwYXRoXCIpXHJcbiAgICAuYXR0cihcImNsYXNzXCIsIFwiaHVsbFwiKVxyXG4gICAgLmF0dHIoXCJmaWxsXCIsIGQgPT4gaHVsbENvbG9yKGRbMF0pKVxyXG4gICAgLmF0dHIoXCJvcGFjaXR5XCIsIDAuMylcclxuICAgIC5hdHRyKFwicG9pbnRlci1ldmVudHNcIiwgXCJub25lXCIpO1xyXG5cclxuICBjb25zdCBsaW5rRyA9IHN2Zy5hcHBlbmQoXCJnXCIpLmF0dHIoXCJpZFwiLCBcImdMaW5rc1wiKTtcclxuICBjb25zdCBsaW5rID0gbGlua0dcclxuICAgIC5hdHRyKFwic3Ryb2tlXCIsIFwiIzk5OWFcIilcclxuICAgIC5hdHRyKFwic3Ryb2tlLW9wYWNpdHlcIiwgMSlcclxuICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIDAuNSlcclxuICAgIC5hdHRyKFwic3Ryb2tlLWxpbmVjYXBcIiwgXCJyb3VuZFwiKVxyXG4gICAgLnNlbGVjdEFsbChcImxpbmVcIilcclxuICAgIC5kYXRhKFxyXG4gICAgICBncmFwaC5saW5rcy5maWx0ZXIoZCA9PiBmY2xhYmVsc19jaGVjay5zaG93R3JvdXBpbmdOb2RlcyB8fCBkLnRhcmdldC50eXBlID09PSBcIkJpb2Vjb25vbXlcIiksXHJcbiAgICAgIGQgPT4gYCR7ZC5zb3VyY2UubmFtZX0tJHtkLnRhcmdldC5uYW1lfWBcclxuICAgIClcclxuICAgIC5qb2luKFwibGluZVwiKTtcclxuXHJcbiAgY29uc3Qgbm9kZUcgPSBzdmcuYXBwZW5kKFwiZ1wiKS5hdHRyKFwiaWRcIiwgXCJnTm9kZXNcIik7XHJcblxyXG4gIC8vIENyZWFyIGxhYmVscyBwYXJhIEJpb2Vjb25vbXkgeSBub2RvcyBncmlzZXMgcHJpbWVyb1xyXG4gIGNvbnN0IGdldE5hbWVBcnJheSA9IGZ1bmN0aW9uIChkKSB7XHJcbiAgICByZXR1cm4gZC5uYW1lQXJyYXkgPyBkLm5hbWVBcnJheSA6IGQubmFtZS5zcGxpdChcIiBcIik7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgbGluZVdpZHRoID0gMS45O1xyXG5cclxuICBjb25zdCBjcmVhdGVMYWJlbHMgPSBmdW5jdGlvbiAoX2RhdGEsIGNsYXNzTmFtZSA9IFwiQmlvZWNvbm9teUxhYmVsXCIpIHtcclxuICAgIHJldHVybiBzdmdcclxuICAgICAgLnNlbGVjdEFsbChgdGV4dC4ke2NsYXNzTmFtZX1gKVxyXG4gICAgICAuZGF0YShfZGF0YSwgZCA9PiBkLm5hbWUpXHJcbiAgICAgIC5qb2luKFwidGV4dFwiKVxyXG4gICAgICAuYXR0cihcImNsYXNzXCIsIGNsYXNzTmFtZSlcclxuICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxyXG4gICAgICAuYXR0cihcImZvbnQtc2l6ZVwiLCBkID0+IGAke2ZocGFkZGluZ19ib3guZm9udFNpemUgKiAoZC50eXBlID09PSBcIkJpb2Vjb25vbXlcIiA/IGQuciAvIGZoZWlnaHRfbm9kZS5ub2RlU2l6ZSAvIDIgOiAxLjgpfXB0YClcclxuICAgICAgLmF0dHIoXCJmb250LXdlaWdodFwiLCBkID0+IChkLnR5cGUgPT09IFwiQmlvZWNvbm9teVwiID8gXCJsaWdodFwiIDogXCJib2xkZXJcIikpXHJcbiAgICAgIC5hdHRyKFwiZm9udC1mYW1pbHlcIiwgXCJPc3dhbGRcIilcclxuICAgICAgLmF0dHIoXCJwb2ludGVyLWV2ZW50c1wiLCBcIm5vbmVcIilcclxuICAgICAgLnN0eWxlKFwiY2xpcC1wYXRoXCIsIGQgPT4gZmNsYWJlbHNfY2hlY2suY2xpcExhYmVscyAmJiBkLnR5cGUgPT09IFwiQmlvZWNvbm9teVwiID8gYGNpcmNsZSgke2QuciAtIDJ9cHgpYCA6IFwiXCIpXHJcbiAgICAgIC5lYWNoKGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgZDMuc2VsZWN0KHRoaXMpXHJcbiAgICAgICAgICAuc2VsZWN0QWxsKFwidHNwYW5cIilcclxuICAgICAgICAgIC5kYXRhKGdldE5hbWVBcnJheShkKSlcclxuICAgICAgICAgIC5qb2luKFwidHNwYW5cIilcclxuICAgICAgICAgIC5hdHRyKFwieFwiLCAwKVxyXG4gICAgICAgICAgLmF0dHIoXCJkeVwiLCBsaW5lV2lkdGggKyBcImNoXCIpXHJcbiAgICAgICAgICAudGV4dChuID0+IG4pO1xyXG4gICAgICB9KVxyXG4gICAgICAuYXR0cihcInlcIiwgZCA9PiAoZ2V0TmFtZUFycmF5KGQpLmxlbmd0aCAvIDIpICogLWxpbmVXaWR0aCArIFwiY2hcIik7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgbGFiZWwgPSBjcmVhdGVMYWJlbHMoXHJcbiAgICBncmFwaC5ub2Rlcy5maWx0ZXIoZCA9PiBkLnR5cGUgPT09IFwiQmlvZWNvbm9teVwiID8gZC5kZWdyZWUgPj0gZmhwYWRkaW5nX2JveC5taW5EZWdyZWUgOiAwKSxcclxuICAgIFwiQmlvZWNvbm9teUxhYmVsXCJcclxuICApO1xyXG5cclxuICBjb25zdCBsYWJlbERlcHRzID0gY3JlYXRlTGFiZWxzKFxyXG4gICAgZ3JhcGgubm9kZXMuZmlsdGVyKGQgPT4gZC50eXBlICE9PSBcIkJpb2Vjb25vbXlcIiksXHJcbiAgICBcImRlcGFydG1lbnRMYWJlbFwiXHJcbiAgKTtcclxuXHJcbiAgLy8gQ3JlYXIgbm9kb3MgeSBhw7FhZGlyIGltw6FnZW5lcyBzb2JyZSBsb3MgbGFiZWxzXHJcbiAgY29uc3Qgbm9kZSA9IG5vZGVHXHJcbiAgICAuc2VsZWN0QWxsKFwiY2lyY2xlXCIpXHJcbiAgICAuZGF0YShcclxuICAgICAgZ3JhcGgubm9kZXMuZmlsdGVyKGQgPT4gZmNsYWJlbHNfY2hlY2suc2hvd0dyb3VwaW5nTm9kZXMgfHwgZC50eXBlID09PSBcIkJpb2Vjb25vbXlcIiksXHJcbiAgICAgIGQgPT4gZC5uYW1lXHJcbiAgICApXHJcbiAgICAuam9pbihcImNpcmNsZVwiKVxyXG4gICAgLmF0dHIoXCJmaWxsXCIsIGQgPT4gKGQudHlwZSAhPT0gXCJCaW9lY29ub215XCIgPyBcIiM5OTlcIiA6IGh1bGxDb2xvcihkLmNsdXN0ZXIpKSlcclxuICAgIC5hdHRyKFwic3Ryb2tlLW9wYWNpdHlcIiwgMSlcclxuICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIDEpXHJcbiAgICAuYXR0cihcInJcIiwgZCA9PiBkLnIpXHJcbiAgICAuY2FsbChkcmFnKHNpbXVsYXRpb24pKTtcclxuXHJcbiAgY29uc3QgaW1hZ2VzID0gbm9kZUdcclxuICAgIC5zZWxlY3RBbGwoXCJpbWFnZVwiKVxyXG4gICAgLmRhdGEoXHJcbiAgICAgIGZjbGFiZWxzX2NoZWNrLnVzZUltYWdlc1xyXG4gICAgICAgID8gZ3JhcGgubm9kZXMuZmlsdGVyKGQgPT4gZC5sb2dvX3ZpeilcclxuICAgICAgICA6IFtdLFxyXG4gICAgICBkID0+IGQubmFtZVxyXG4gICAgKVxyXG4gICAgLmpvaW4oXCJpbWFnZVwiKVxyXG4gICAgLmF0dHIoXCJocmVmXCIsIGQgPT4gZC5sb2dvX3ZpeilcclxuICAgIC5hdHRyKFwid2lkdGhcIiwgZCA9PiBkLnIgKiAyIC0gNClcclxuICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGQgPT4gZC5yICogMiAtIDQpXHJcbiAgICAuYXR0cihcInN0cm9rZVwiLCBcImJsYWNrXCIpXHJcbiAgICAuYXR0cihcInByZXNlcnZlQXNwZWN0UmF0aW9cIiwgXCJ4TWlkWU1pZCBzbGljZVwiKVxyXG4gICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZCA9PiBgdHJhbnNsYXRlKC0ke2QuciAtIDJ9LCAtJHtkLnIgLSAyfSlgKVxyXG4gICAgLnN0eWxlKFwiY2xpcC1wYXRoXCIsIGQgPT4gYGNpcmNsZSgke2QuciAtIDJ9cHgpYClcclxuICAgIC5jYWxsKGRyYWcoc2ltdWxhdGlvbikpO1xyXG4gIFxyXG4gIGZ1bmN0aW9uIHVwZGF0ZVZpc2liaWxpdHkoKSB7XHJcbiAgbGFiZWwuYXR0cihcImRpc3BsYXlcIiwgZmNsYWJlbHNfY2hlY2sudXNlSW1hZ2VzID8gXCJub25lXCIgOiBcImJsb2NrXCIpO1xyXG4gIGltYWdlcy5hdHRyKFwiZGlzcGxheVwiLCBmY2xhYmVsc19jaGVjay51c2VJbWFnZXMgPyBcImJsb2NrXCIgOiBcIm5vbmVcIik7XHJcbn1cclxuICB1cGRhdGVWaXNpYmlsaXR5KCk7XHJcbiAgZnVuY3Rpb24gdGlja2VkKCkge1xyXG4gICAgbGlua1xyXG4gICAgICAuYXR0cihcIngxXCIsIGQgPT4gZC5zb3VyY2UueClcclxuICAgICAgLmF0dHIoXCJ5MVwiLCBkID0+IGQuc291cmNlLnkpXHJcbiAgICAgIC5hdHRyKFwieDJcIiwgZCA9PiBkLnRhcmdldC54KVxyXG4gICAgICAuYXR0cihcInkyXCIsIGQgPT4gZC50YXJnZXQueSk7XHJcblxyXG4gICAgbGFiZWwuYXR0cihcInRyYW5zZm9ybVwiLCBkID0+IGB0cmFuc2xhdGUoJHtkLnh9LCAke2QueX0pYCkuY2xhc3NlZChcInNoYWRvd1wiLCBzaW11bGF0aW9uLmFscGhhKCkgPD0gMC4xKTtcclxuICAgIGxhYmVsRGVwdHMuYXR0cihcInRyYW5zZm9ybVwiLCBkID0+IGB0cmFuc2xhdGUoJHtkLnh9LCAke2QueX0pYCkuY2xhc3NlZChcInNoYWRvd1wiLCBzaW11bGF0aW9uLmFscGhhKCkgPD0gMC4xKTtcclxuICAgIFxyXG4gICAgbm9kZS5hdHRyKFwiY3hcIiwgZCA9PiBkLngpLmF0dHIoXCJjeVwiLCBkID0+IGQueSkuY2xhc3NlZChcInNoYWRvd1wiLCBzaW11bGF0aW9uLmFscGhhKCkgPD0gMC4xKTtcclxuXHJcbiAgICBpZiAoZmNsYWJlbHNfY2hlY2sudXNlSW1hZ2VzKSB7XHJcbiAgICAgIGltYWdlcy5hdHRyKFwieFwiLCBkID0+IGQueCkuYXR0cihcInlcIiwgZCA9PiBkLnkpO1xyXG4gICAgfVxyXG5cclxuICAgIGh1bGwuYXR0cihcImRcIiwgZ2V0SHVsbCk7XHJcbiAgfVxyXG5cclxuICBzaW11bGF0aW9uLm9uKFwidGlja1wiLCB0aWNrZWQpO1xyXG5cclxuICBmdW5jdGlvbiBkcmFnKHNpbXVsYXRpb24pIHtcclxuICAgIGZ1bmN0aW9uIGRyYWdzdGFydGVkKGV2ZW50KSB7XHJcbiAgICAgIGlmICghZXZlbnQuYWN0aXZlKSBzaW11bGF0aW9uLmFscGhhVGFyZ2V0KDAuMykucmVzdGFydCgpO1xyXG4gICAgICBldmVudC5zdWJqZWN0LmZ4ID0gZXZlbnQuc3ViamVjdC54O1xyXG4gICAgICBldmVudC5zdWJqZWN0LmZ5ID0gZXZlbnQuc3ViamVjdC55O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGRyYWdnZWQoZXZlbnQpIHtcclxuICAgICAgZXZlbnQuc3ViamVjdC5meCA9IGV2ZW50Lng7XHJcbiAgICAgIGV2ZW50LnN1YmplY3QuZnkgPSBldmVudC55O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGRyYWdlbmRlZChldmVudCkge1xyXG4gICAgICBpZiAoIWV2ZW50LmFjdGl2ZSkgc2ltdWxhdGlvbi5hbHBoYVRhcmdldCgwKTtcclxuICAgICAgZXZlbnQuc3ViamVjdC5meCA9IG51bGw7XHJcbiAgICAgIGV2ZW50LnN1YmplY3QuZnkgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBkM1xyXG4gICAgICAuZHJhZygpXHJcbiAgICAgIC5vbihcInN0YXJ0XCIsIGRyYWdzdGFydGVkKVxyXG4gICAgICAub24oXCJkcmFnXCIsIGRyYWdnZWQpXHJcbiAgICAgIC5vbihcImVuZFwiLCBkcmFnZW5kZWQpO1xyXG4gIH1cclxuXHJcbiAgaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gc2ltdWxhdGlvbi5zdG9wKCkpO1xyXG4gIHRpY2tlZCgpO1xyXG5cclxuICByZXR1cm4gaHRsLmh0bWxgPGRpdj5cclxuICAgIDxoMj4gYmlvZWNvbm9teSBlbmFibGluZyBuZXR3b3JrcyBieSAke2dyb3VwQnl9PC9oMj5cclxuICAgICR7c3ZnLm5vZGUoKX1cclxuICA8L2Rpdj5gO1xyXG59O1xyXG5cclxuXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgY29sb3JJbnRlcnBvbGF0b3IgPSB7XHJcbiAgY29uc3QgY29sb3JTY2hlbWVzID0gW1xyXG4gICAgXCJpbnRlcnBvbGF0ZUJsdWVzXCIsXHJcbiAgICBcImludGVycG9sYXRlQnJCR1wiLFxyXG4gICAgXCJpbnRlcnBvbGF0ZVJkQnVcIixcclxuICAgIFwiaW50ZXJwb2xhdGVSZFlsR25cIixcclxuICAgIFwiaW50ZXJwb2xhdGVSZWRzXCIsXHJcbiAgICBcImludGVycG9sYXRlU2luZWJvd1wiLFxyXG4gICAgXCJpbnRlcnBvbGF0ZVNwZWN0cmFsXCIsXHJcbiAgICBcImludGVycG9sYXRlVHVyYm9cIixcclxuICAgIFwiaW50ZXJwb2xhdGVWaXJpZGlzXCIsXHJcbiAgXTtcclxuICBjb25zdCBjb2xvcnMgPSBuZXcgTWFwKFxyXG4gICAgW1tcIkN1c3RvbSBUdXJib1wiLCAodCkgPT4gZDMuaW50ZXJwb2xhdGVUdXJibygwLjIgKyB0ICogMC44KV1dLmNvbmNhdChcclxuICAgICAgY29sb3JTY2hlbWVzLm1hcCgoYykgPT4gW2MsIGQzW2NdXSlcclxuICAgIClcclxuICApO1xyXG5cclxuICByZXR1cm4gSW5wdXRzLnNlbGVjdChjb2xvcnMsIHtcclxuICAgIGxhYmVsOiBcIkNvbG9yIFNjaGVtZVwiLFxyXG4gICAgZm9ybWF0OiAoZCkgPT4gZFswXVxyXG4gIH0pO1xyXG59XHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgZmhwYWRkaW5nX2JveCA9IChcclxuICBJbnB1dHMuZm9ybSh7XHJcbiAgICBodWxsUGFkZGluZzogSW5wdXRzLnJhbmdlKFswLCAxMDBdLCB7bGFiZWw6IFwiSHVsbCBQYWRkaW5nXCIsIHZhbHVlOiA5LCBzdGVwOiAxfSksXHJcbiAgICBtaW5EZWdyZWU6IElucHV0cy5yYW5nZShbMCwgZDMubWF4KGdyYXBoLm5vZGVzLCAoZCkgPT4gZC5kZWdyZWUpICsgMV0sIHtcclxuICAgICAgbGFiZWw6IFwiTWluIERlZ3JlZSBmb3IgTGFiZWxcIixcclxuICAgICAgdmFsdWU6IDEsXHJcbiAgICAgIHN0ZXA6IDFcclxuICAgIH0pLFxyXG4gICAgZm9udFNpemU6IElucHV0cy5yYW5nZShbMSwgMzZdLCB7bGFiZWw6IFwiRm9udCBzaXplXCIsIHZhbHVlOiA4LCBzdGVwOiAxfSksXHJcbiAgICBncmV5Tm9kZVNpemU6IElucHV0cy5yYW5nZShbMSwgMzBdLCB7bGFiZWw6IFwiQ29ubmVjdGluZyBOb2RlIFNpemVcIiwgdmFsdWU6IDUsIHN0ZXA6IDF9KVxyXG4gIH0sXHJcbiAge1xyXG4gICAgdGVtcGxhdGU6IHRlbXBsYXRlXzQgLy8gRXNwZWPDrWZpY2FtZW50ZSB1c2FuZG8gdGVtcGxhdGVfNCBwYXJhIDQgY29sdW1uYXNcclxuICB9KVxyXG4pO1xyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTI4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGZjbGFiZWxzX2NoZWNrID0gKFxyXG4gIElucHV0cy5mb3JtKHtcclxuICB1c2VJbWFnZXM6SW5wdXRzLnRvZ2dsZSh7bGFiZWw6IFwiVXNlIEltYWdlc1wiLCB2YWx1ZTogdHJ1ZX0pLFxyXG4gIHNob3dHcm91cGluZ05vZGVzOklucHV0cy50b2dnbGUoe2xhYmVsOiBcIlNob3cgZ3JleSBub2Rlc1wiLCB2YWx1ZTogdHJ1ZX0pLFxyXG4gIGNsaXBMYWJlbHM6IElucHV0cy50b2dnbGUoe2xhYmVsOiBcIkNsaXAgTGFiZWxzXCIsIHZhbHVlOiB0cnVlfSksXHJcbiAgdXNlU2hhZG93c1RleHQ6IElucHV0cy50b2dnbGUoe2xhYmVsOiBcIlVzZSBUZXh0IFNoYWRvd3NcIiwgdmFsdWU6IHRydWV9KX0sXHJcbiAge1xyXG4gICAgdGVtcGxhdGU6IHRlbXBsYXRlXzQgXHJcbiAgfSlcclxuICApXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnbWluRGF0ZScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdncm91cEJ5JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NlbGVjdGVkVGFyZ2V0cycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdmaGVpZ2h0X25vZGUnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnY29sb3JJbnRlcnBvbGF0b3InKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnZmhwYWRkaW5nX2JveCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdmY2xhYmVsc19jaGVjaycpIn1dfQ==
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../..";
window._ojs.paths.runtimeToRoot = "../../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>