<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Explore Colombia’s enabling networks in bioeconomy: discover key phases, thematic focuses, and research areas">

<title>Bioeconomy enabling networks in Colombia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="bioec_research_skills copy_files/libs/clipboard/clipboard.min.js"></script>
<script src="bioec_research_skills copy_files/libs/quarto-html/quarto.js"></script>
<script src="bioec_research_skills copy_files/libs/quarto-html/popper.min.js"></script>
<script src="bioec_research_skills copy_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="bioec_research_skills copy_files/libs/quarto-html/anchor.min.js"></script>
<link href="bioec_research_skills copy_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="bioec_research_skills copy_files/libs/quarto-html/quarto-syntax-highlighting-2486e1f0a3ee9ee1fc393803a1361cdb.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="bioec_research_skills copy_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="bioec_research_skills copy_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="bioec_research_skills copy_files/libs/bootstrap/bootstrap-5bdc1ec511977dd36301403cf8f4f68d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script type="module" src="bioec_research_skills copy_files/libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="bioec_research_skills copy_files/libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Bioeconomy enabling networks in Colombia</h1>
</div>

<div>
  <div class="description">
    Explore Colombia’s enabling networks in bioeconomy: discover key phases, thematic focuses, and research areas
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="8" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 7;"><span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>d3 <span class="op">=</span> <span class="pp">require</span>(<span class="st">"d3@7"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>navio_npm <span class="op">=</span> <span class="pp">require</span>(<span class="st">"navio@0.0.75"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>Inputs <span class="op">=</span> <span class="pp">require</span>(<span class="st">"@observablehq/inputs"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>htl <span class="op">=</span> <span class="pp">require</span>(<span class="st">"htl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="15" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 14;"><span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>aq <span class="op">=</span> {</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> aq <span class="op">=</span> <span class="cf">await</span> <span class="pp">require</span>(<span class="vs">`arquero@</span><span class="sc">${</span>aq_version<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add HTML table view method to tables</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(aq<span class="op">.</span><span class="at">ColumnTable</span><span class="op">.</span><span class="at">prototype</span><span class="op">,</span> {</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">view</span>(options) { <span class="cf">return</span> <span class="fu">toView</span>(<span class="kw">this</span><span class="op">,</span> options)<span class="op">;</span> }</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> aq<span class="op">;</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="30" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 29;"><span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>aq_version <span class="op">=</span> <span class="st">'7.2.0'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="36" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 35;"><span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>op <span class="op">=</span> aq<span class="op">.</span><span class="at">op</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="41" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 40;"><span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>toView <span class="op">=</span> {</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> DEFAULT_LIMIT <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> DEFAULT_NULL <span class="op">=</span> value <span class="kw">=&gt;</span> <span class="vs">`&lt;span style="color: #999;"&gt;</span><span class="sc">${</span>value<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tableStyle <span class="op">=</span> <span class="st">'margin: 0; border-collapse: separate; border-spacing: 0; width: initial;'</span><span class="op">;</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cellStyle <span class="op">=</span> <span class="st">'padding: 1px 5px; white-space: nowrap; overflow-x: hidden; text-overflow: ellipsis; font-variant-numeric: tabular-nums;'</span><span class="op">;</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> rowStyle <span class="op">=</span> <span class="st">'border-bottom: 1px solid #eee;'</span><span class="op">;</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>  <span class="co">// given an Arquero data table, provide an HTML table view</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">function</span>(dt<span class="op">,</span> opt <span class="op">=</span> {}) {</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    <span class="co">// permit shorthand for limit</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="kw">typeof</span> opt <span class="op">===</span> <span class="st">'number'</span>) opt <span class="op">=</span> { <span class="dt">limit</span><span class="op">:</span> opt }<span class="op">;</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>    <span class="co">// marshal cell color options</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> color <span class="op">=</span> { <span class="op">...</span>opt<span class="op">.</span><span class="at">color</span> }<span class="op">;</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="kw">typeof</span> opt<span class="op">.</span><span class="at">color</span> <span class="op">===</span> <span class="st">'function'</span>) {</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>      <span class="co">// if function, apply to all columns</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>      dt<span class="op">.</span><span class="fu">columnNames</span>()<span class="op">.</span><span class="fu">forEach</span>(name <span class="kw">=&gt;</span> color[name] <span class="op">=</span> opt<span class="op">.</span><span class="at">color</span>)<span class="op">;</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>      <span class="co">// otherwise, gather per-column color options</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (<span class="kw">const</span> key <span class="kw">in</span> color) {</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> value <span class="op">=</span> color[key]<span class="op">;</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>        color[key] <span class="op">=</span> <span class="kw">typeof</span> value <span class="op">===</span> <span class="st">'function'</span> <span class="op">?</span> value <span class="op">:</span> () <span class="kw">=&gt;</span> value<span class="op">;</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>    <span class="co">// marshal CSS styles as toHTML() options</span></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> table <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>tableStyle<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> cell <span class="op">=</span> (name<span class="op">,</span> index<span class="op">,</span> row<span class="op">,</span> th) <span class="kw">=&gt;</span> {</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>cellStyle<span class="sc">}</span><span class="vs"> max-width: </span><span class="sc">${</span><span class="op">+</span>opt<span class="op">.</span><span class="at">maxCellWidth</span> <span class="op">||</span> <span class="dv">300</span><span class="sc">}</span><span class="vs">px;`</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> <span class="vs">` border-bottom: solid 1px </span><span class="sc">${</span>th <span class="op">?</span> <span class="st">'#ccc'</span> <span class="op">:</span> <span class="st">'#eee'</span><span class="sc">}</span><span class="vs">;`</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> (color[name] <span class="op">?</span> <span class="vs">` background-color: </span><span class="sc">${</span>color[name](index<span class="op">,</span> row)<span class="sc">}</span><span class="vs">;`</span> <span class="op">:</span> <span class="st">''</span>)<span class="op">;</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> td <span class="op">=</span> (name<span class="op">,</span> index<span class="op">,</span> row) <span class="kw">=&gt;</span> <span class="fu">cell</span>(name<span class="op">,</span> index<span class="op">,</span> row<span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> th <span class="op">=</span> (name<span class="op">,</span> index<span class="op">,</span> row) <span class="kw">=&gt;</span> <span class="vs">`position: sticky; top: 0; background: #fff; `</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> <span class="fu">cell</span>(name<span class="op">,</span> index<span class="op">,</span> row<span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>    opt <span class="op">=</span> {</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>      <span class="dt">limit</span><span class="op">:</span> DEFAULT_LIMIT<span class="op">,</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>      <span class="dt">null</span><span class="op">:</span> DEFAULT_NULL<span class="op">,</span></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>opt<span class="op">,</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>      <span class="dt">style</span><span class="op">:</span> { table<span class="op">,</span> td<span class="op">,</span> th }</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>    <span class="co">// return container div, bind table value to support viewof operator</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> size <span class="op">=</span> <span class="vs">`max-height: </span><span class="sc">${</span><span class="op">+</span>opt<span class="op">.</span><span class="at">height</span> <span class="op">||</span> <span class="dv">270</span><span class="sc">}</span><span class="vs">px`</span><span class="op">;</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> style <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>size<span class="sc">}</span><span class="vs">; overflow-x: auto; overflow-y: auto;`</span><span class="op">;</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> view <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div style="</span><span class="sc">${</span>style<span class="sc">}</span><span class="vs">"&gt;</span><span class="sc">${</span>dt<span class="op">.</span><span class="fu">toHTML</span>(opt)<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(view<span class="op">,</span> { <span class="dt">value</span><span class="op">:</span> dt })<span class="op">;</span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="95" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 94;"><span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">Scrubber</span>(values<span class="op">,</span> {</span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>  format <span class="op">=</span> value <span class="kw">=&gt;</span> value<span class="op">,</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>  initial <span class="op">=</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>  direction <span class="op">=</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>  delay <span class="op">=</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>  autoplay <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a>  loop <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>  loopDelay <span class="op">=</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>  alternate <span class="op">=</span> <span class="kw">false</span></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>} <span class="op">=</span> {}) {</span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>  values <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(values)<span class="op">;</span></span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> form <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;form style="font: 12px var(--sans-serif); font-variant-numeric: tabular-nums; display: flex; height: 33px; align-items: center;"&gt;</span></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;button name=b type=button style="margin-right: 0.4em; width: 5em;"&gt;&lt;/button&gt;</span></span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;label style="display: flex; align-items: center;"&gt;</span></span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;input name=i type=range min=0 max=</span><span class="sc">${</span>values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span><span class="sc">}</span><span class="vs"> value=</span><span class="sc">${</span>initial<span class="sc">}</span><span class="vs"> step=1 style="width: 180px;"&gt;</span></span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;output name=o style="margin-left: 0.4em;"&gt;&lt;/output&gt;</span></span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/label&gt;</span></span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/form&gt;`</span><span class="op">;</span></span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> frame <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> timer <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> interval <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">start</span>() {</span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">"Pause"</span><span class="op">;</span></span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (delay <span class="op">===</span> <span class="kw">null</span>) frame <span class="op">=</span> <span class="fu">requestAnimationFrame</span>(tick)<span class="op">;</span></span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> interval <span class="op">=</span> <span class="pp">setInterval</span>(tick<span class="op">,</span> delay)<span class="op">;</span></span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">stop</span>() {</span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">"Play"</span><span class="op">;</span></span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (frame <span class="op">!==</span> <span class="kw">null</span>) <span class="fu">cancelAnimationFrame</span>(frame)<span class="op">,</span> frame <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (timer <span class="op">!==</span> <span class="kw">null</span>) <span class="pp">clearTimeout</span>(timer)<span class="op">,</span> timer <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (interval <span class="op">!==</span> <span class="kw">null</span>) <span class="pp">clearInterval</span>(interval)<span class="op">,</span> interval <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">running</span>() {</span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> frame <span class="op">!==</span> <span class="kw">null</span> <span class="op">||</span> timer <span class="op">!==</span> <span class="kw">null</span> <span class="op">||</span> interval <span class="op">!==</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">tick</span>() {</span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">===</span> (direction <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">:</span> direction <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> <span class="kw">NaN</span>)) {</span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>loop) <span class="cf">return</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (alternate) direction <span class="op">=</span> <span class="op">-</span>direction<span class="op">;</span></span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (loopDelay <span class="op">!==</span> <span class="kw">null</span>) {</span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (frame <span class="op">!==</span> <span class="kw">null</span>) <span class="fu">cancelAnimationFrame</span>(frame)<span class="op">,</span> frame <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (interval <span class="op">!==</span> <span class="kw">null</span>) <span class="pp">clearInterval</span>(interval)<span class="op">,</span> interval <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a>        timer <span class="op">=</span> <span class="pp">setTimeout</span>(() <span class="kw">=&gt;</span> (<span class="fu">step</span>()<span class="op">,</span> <span class="fu">start</span>())<span class="op">,</span> loopDelay)<span class="op">;</span></span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (delay <span class="op">===</span> <span class="kw">null</span>) frame <span class="op">=</span> <span class="fu">requestAnimationFrame</span>(tick)<span class="op">;</span></span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step</span>()<span class="op">;</span></span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">step</span>() {</span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">=</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">+</span> direction <span class="op">+</span> values<span class="op">.</span><span class="at">length</span>) <span class="op">%</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">oninput</span> <span class="op">=</span> <span class="bu">event</span> <span class="kw">=&gt;</span> {</span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">event</span> <span class="op">&amp;&amp;</span> <span class="bu">event</span><span class="op">.</span><span class="at">isTrusted</span> <span class="op">&amp;&amp;</span> <span class="fu">running</span>()) <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">value</span> <span class="op">=</span> values[form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span>]<span class="op">;</span></span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">o</span><span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="fu">format</span>(form<span class="op">.</span><span class="at">value</span><span class="op">,</span> form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span><span class="op">,</span> values)<span class="op">;</span></span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">running</span>()) <span class="cf">return</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a>    direction <span class="op">=</span> alternate <span class="op">&amp;&amp;</span> form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">===</span> values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">?</span> <span class="op">-</span><span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">=</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">+</span> direction) <span class="op">%</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a>    <span class="fu">start</span>()<span class="op">;</span></span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">oninput</span>()<span class="op">;</span></span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (autoplay) <span class="fu">start</span>()<span class="op">;</span></span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">disposal</span>(form)<span class="op">.</span><span class="fu">then</span>(stop)<span class="op">;</span></span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form<span class="op">;</span></span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="170" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 169;"><span id="cb7-170"><a href="#cb7-170" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">navio</span>(data<span class="op">,</span> _options <span class="op">=</span> {}) {</span>
<span id="cb7-171"><a href="#cb7-171" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> options <span class="op">=</span> {</span>
<span id="cb7-172"><a href="#cb7-172" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> <span class="dv">300</span><span class="op">,</span> <span class="co">// Navio's height</span></span>
<span id="cb7-173"><a href="#cb7-173" aria-hidden="true" tabindex="-1"></a>    <span class="dt">attribs</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="co">// array of attrib names to be used, leave as null for all of them</span></span>
<span id="cb7-174"><a href="#cb7-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-175"><a href="#cb7-175" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x0</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="co">//Where to start drawing navio in x</span></span>
<span id="cb7-176"><a href="#cb7-176" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y0</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span> <span class="co">//Where to start drawing navio in y, useful if your attrib names are too long</span></span>
<span id="cb7-177"><a href="#cb7-177" aria-hidden="true" tabindex="-1"></a>    <span class="dt">maxNumDistictForCategorical</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="co">// addAllAttribs uses this for deciding if an attribute is categorical (has less than     maxNumDistictForCategorical categories) or ordered</span></span>
<span id="cb7-178"><a href="#cb7-178" aria-hidden="true" tabindex="-1"></a>    <span class="dt">maxNumDistictForOrdered</span><span class="op">:</span> <span class="dv">90</span><span class="op">,</span> <span class="co">// addAllAttribs uses this for deciding if an attribute is ordered (has less than     maxNumDistictForCategorical categories) or text. Use    maxNumDistictForOrdered : Infinity for never choosing Text</span></span>
<span id="cb7-179"><a href="#cb7-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-180"><a href="#cb7-180" aria-hidden="true" tabindex="-1"></a>    <span class="dt">howManyItemsShouldSearchForNotNull</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span> <span class="co">// How many rows should addAllAttribs search to decide guess an attribute type</span></span>
<span id="cb7-181"><a href="#cb7-181" aria-hidden="true" tabindex="-1"></a>    <span class="dt">margin</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="co">// Margin around navio</span></span>
<span id="cb7-182"><a href="#cb7-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-183"><a href="#cb7-183" aria-hidden="true" tabindex="-1"></a>    <span class="dt">levelsSeparation</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span> <span class="co">// Separation between the levels</span></span>
<span id="cb7-184"><a href="#cb7-184" aria-hidden="true" tabindex="-1"></a>    <span class="dt">divisionsColor</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span> <span class="co">// Border color for the divisions</span></span>
<span id="cb7-185"><a href="#cb7-185" aria-hidden="true" tabindex="-1"></a>    <span class="dt">levelConnectionsColor</span><span class="op">:</span> <span class="st">"rgba(205, 220, 163, 0.5)"</span><span class="op">,</span> <span class="co">// Color for the conections between levels</span></span>
<span id="cb7-186"><a href="#cb7-186" aria-hidden="true" tabindex="-1"></a>    <span class="dt">divisionsThreshold</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span> <span class="co">// What's the minimum row height needed to draw divisions</span></span>
<span id="cb7-187"><a href="#cb7-187" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fmtCounts</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">",.0d"</span>)<span class="op">,</span> <span class="co">// Format used to display the counts on the bottom</span></span>
<span id="cb7-188"><a href="#cb7-188" aria-hidden="true" tabindex="-1"></a>    <span class="dt">legendFont</span><span class="op">:</span> <span class="st">"14px sans-serif"</span><span class="op">,</span> <span class="co">// The font for the header</span></span>
<span id="cb7-189"><a href="#cb7-189" aria-hidden="true" tabindex="-1"></a>    <span class="dt">nestedFilters</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// Should navio use nested levels?</span></span>
<span id="cb7-190"><a href="#cb7-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-191"><a href="#cb7-191" aria-hidden="true" tabindex="-1"></a>    <span class="dt">showAttribTitles</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// Show headers?</span></span>
<span id="cb7-192"><a href="#cb7-192" aria-hidden="true" tabindex="-1"></a>    <span class="dt">attribWidth</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span> <span class="co">// Width of the columns</span></span>
<span id="cb7-193"><a href="#cb7-193" aria-hidden="true" tabindex="-1"></a>    <span class="dt">attribRotation</span><span class="op">:</span> <span class="op">-</span><span class="dv">45</span><span class="op">,</span> <span class="co">// Headers rotation</span></span>
<span id="cb7-194"><a href="#cb7-194" aria-hidden="true" tabindex="-1"></a>    <span class="dt">attribFontSize</span><span class="op">:</span> <span class="dv">13</span><span class="op">,</span> <span class="co">// Headers font size</span></span>
<span id="cb7-195"><a href="#cb7-195" aria-hidden="true" tabindex="-1"></a>    <span class="dt">attribFontSizeSelected</span><span class="op">:</span> <span class="dv">32</span><span class="op">,</span> <span class="co">// Headers font size when mouse over</span></span>
<span id="cb7-196"><a href="#cb7-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-197"><a href="#cb7-197" aria-hidden="true" tabindex="-1"></a>    <span class="dt">filterFontSize</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="co">// Font size of the filters explanations on the bottom</span></span>
<span id="cb7-198"><a href="#cb7-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-199"><a href="#cb7-199" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tooltipFontSize</span><span class="op">:</span> <span class="dv">12</span><span class="op">,</span> <span class="co">// Font size for the tooltip</span></span>
<span id="cb7-200"><a href="#cb7-200" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tooltipBgColor</span><span class="op">:</span> <span class="st">"#b2ddf1"</span><span class="op">,</span> <span class="co">// Font color for tooltip background</span></span>
<span id="cb7-201"><a href="#cb7-201" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tooltipMargin</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> <span class="co">// How much to separate the tooltip from the cursor</span></span>
<span id="cb7-202"><a href="#cb7-202" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tooltipArrowSize</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="co">// How big is the arrow on the tooltip</span></span>
<span id="cb7-203"><a href="#cb7-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-204"><a href="#cb7-204" aria-hidden="true" tabindex="-1"></a>    <span class="dt">digitsForText</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="co">// How many digits to use for text attributes</span></span>
<span id="cb7-205"><a href="#cb7-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-206"><a href="#cb7-206" aria-hidden="true" tabindex="-1"></a>    <span class="dt">addAllAttribsRecursionLevel</span><span class="op">:</span> <span class="kw">Infinity</span><span class="op">,</span> <span class="co">// How many levels depth do we keep on adding nested attributes</span></span>
<span id="cb7-207"><a href="#cb7-207" aria-hidden="true" tabindex="-1"></a>    <span class="dt">addAllAttribsIncludeObjects</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// Should addAllAttribs include objects</span></span>
<span id="cb7-208"><a href="#cb7-208" aria-hidden="true" tabindex="-1"></a>    <span class="dt">addAllAttribsIncludeArrays</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// Should addAllAttribs include arrays</span></span>
<span id="cb7-209"><a href="#cb7-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-210"><a href="#cb7-210" aria-hidden="true" tabindex="-1"></a>    <span class="dt">nullColor</span><span class="op">:</span> <span class="st">"#ffedfd"</span><span class="op">,</span> <span class="co">// Color for null values</span></span>
<span id="cb7-211"><a href="#cb7-211" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorInterpolator</span><span class="op">:</span> d3<span class="op">.</span><span class="at">interpolateBlues</span><span class="op">,</span></span>
<span id="cb7-212"><a href="#cb7-212" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorInterpolatorDate</span><span class="op">:</span> d3<span class="op">.</span><span class="at">interpolatePurples</span><span class="op">,</span></span>
<span id="cb7-213"><a href="#cb7-213" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorInterpolatorDiverging</span><span class="op">:</span> d3<span class="op">.</span><span class="at">interpolateBrBG</span><span class="op">,</span></span>
<span id="cb7-214"><a href="#cb7-214" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorInterpolatorOrdered</span><span class="op">:</span> d3<span class="op">.</span><span class="at">interpolateOranges</span><span class="op">,</span></span>
<span id="cb7-215"><a href="#cb7-215" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorInterpolatorText</span><span class="op">:</span> d3<span class="op">.</span><span class="at">interpolateGreys</span><span class="op">,</span></span>
<span id="cb7-216"><a href="#cb7-216" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorRangeBoolean</span><span class="op">:</span> [<span class="st">"#a1d76a"</span><span class="op">,</span> <span class="st">"#e9a3c9"</span><span class="op">,</span> <span class="st">"white"</span>]<span class="op">,</span> <span class="co">//true false null</span></span>
<span id="cb7-217"><a href="#cb7-217" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorRangeSelected</span><span class="op">:</span> [<span class="st">"white"</span><span class="op">,</span> <span class="st">"#b5cf6b"</span>]<span class="op">,</span></span>
<span id="cb7-218"><a href="#cb7-218" aria-hidden="true" tabindex="-1"></a>    <span class="dt">defaultColorCategorical</span><span class="op">:</span> d3<span class="op">.</span><span class="at">schemeCategory10</span><span class="op">,</span></span>
<span id="cb7-219"><a href="#cb7-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-220"><a href="#cb7-220" aria-hidden="true" tabindex="-1"></a>    <span class="dt">showSelectedAttrib</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// Display the attribute that shows if a row is selected</span></span>
<span id="cb7-221"><a href="#cb7-221" aria-hidden="true" tabindex="-1"></a>    <span class="dt">showSequenceIDAttrib</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// Display the attribute with the sequence ID</span></span>
<span id="cb7-222"><a href="#cb7-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-223"><a href="#cb7-223" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>_options</span>
<span id="cb7-224"><a href="#cb7-224" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb7-225"><a href="#cb7-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-226"><a href="#cb7-226" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> div <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div  style="display:block; overflow-x:scroll"&gt;&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb7-227"><a href="#cb7-227" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-228"><a href="#cb7-228" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Create the navio</span></span>
<span id="cb7-229"><a href="#cb7-229" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> nv <span class="op">=</span> <span class="fu">navio_npm</span>(d3<span class="op">.</span><span class="fu">select</span>(div)<span class="op">,</span> options<span class="op">.</span><span class="at">height</span>)<span class="op">;</span></span>
<span id="cb7-230"><a href="#cb7-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-231"><a href="#cb7-231" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> opt <span class="kw">in</span> options) {</span>
<span id="cb7-232"><a href="#cb7-232" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (opt <span class="op">===</span> <span class="st">"id"</span>) {</span>
<span id="cb7-233"><a href="#cb7-233" aria-hidden="true" tabindex="-1"></a>      nv<span class="op">.</span><span class="fu">id</span>(options[opt])<span class="op">;</span></span>
<span id="cb7-234"><a href="#cb7-234" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (opt <span class="op">!==</span> <span class="st">"attribs"</span>) {</span>
<span id="cb7-235"><a href="#cb7-235" aria-hidden="true" tabindex="-1"></a>      nv[opt] <span class="op">=</span> options[opt]<span class="op">;</span></span>
<span id="cb7-236"><a href="#cb7-236" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-237"><a href="#cb7-237" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-238"><a href="#cb7-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-239"><a href="#cb7-239" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add the data</span></span>
<span id="cb7-240"><a href="#cb7-240" aria-hidden="true" tabindex="-1"></a>  nv<span class="op">.</span><span class="fu">data</span>(data)<span class="op">;</span></span>
<span id="cb7-241"><a href="#cb7-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-242"><a href="#cb7-242" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (options<span class="op">.</span><span class="at">attribs</span>) {</span>
<span id="cb7-243"><a href="#cb7-243" aria-hidden="true" tabindex="-1"></a>    nv<span class="op">.</span><span class="fu">addAllAttribs</span>(options<span class="op">.</span><span class="at">attribs</span>)<span class="op">;</span></span>
<span id="cb7-244"><a href="#cb7-244" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb7-245"><a href="#cb7-245" aria-hidden="true" tabindex="-1"></a>    nv<span class="op">.</span><span class="fu">addAllAttribs</span>()<span class="op">;</span></span>
<span id="cb7-246"><a href="#cb7-246" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-247"><a href="#cb7-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-248"><a href="#cb7-248" aria-hidden="true" tabindex="-1"></a>  nv<span class="op">.</span><span class="fu">updateCallback</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb7-249"><a href="#cb7-249" aria-hidden="true" tabindex="-1"></a>    div<span class="op">.</span><span class="at">value</span> <span class="op">=</span> nv<span class="op">.</span><span class="fu">getVisible</span>()<span class="op">;</span></span>
<span id="cb7-250"><a href="#cb7-250" aria-hidden="true" tabindex="-1"></a>    div<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb7-251"><a href="#cb7-251" aria-hidden="true" tabindex="-1"></a>    <span class="co">// notify(div);</span></span>
<span id="cb7-252"><a href="#cb7-252" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb7-253"><a href="#cb7-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-254"><a href="#cb7-254" aria-hidden="true" tabindex="-1"></a>  div<span class="op">.</span><span class="at">value</span> <span class="op">=</span> data<span class="op">;</span></span>
<span id="cb7-255"><a href="#cb7-255" aria-hidden="true" tabindex="-1"></a>  div<span class="op">.</span><span class="at">nv</span> <span class="op">=</span> nv<span class="op">;</span></span>
<span id="cb7-256"><a href="#cb7-256" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> div<span class="op">;</span></span>
<span id="cb7-257"><a href="#cb7-257" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="263" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 262;"><span id="cb8-263"><a href="#cb8-263" aria-hidden="true" tabindex="-1"></a>data_hubs0 <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"cefb.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({ <span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span> })</span>
<span id="cb8-264"><a href="#cb8-264" aria-hidden="true" tabindex="-1"></a>data_hubs <span class="op">=</span> data_hubs0<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({ <span class="op">...</span>d<span class="op">,</span> <span class="dt">name</span><span class="op">:</span> d<span class="op">.</span><span class="at">platform</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"Bioeconomy"</span> }))<span class="op">;</span></span>
<span id="cb8-265"><a href="#cb8-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-266"><a href="#cb8-266" aria-hidden="true" tabindex="-1"></a>skillsData <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"skills_count.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({ <span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-3" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="271" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 270;"><span id="cb9-271"><a href="#cb9-271" aria-hidden="true" tabindex="-1"></a>dData <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>(data_hubs<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> [d<span class="op">.</span><span class="at">name</span><span class="op">,</span> d]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="277" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 276;"><span id="cb10-277"><a href="#cb10-277" aria-hidden="true" tabindex="-1"></a>hullColor <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleOrdinal</span>(</span>
<span id="cb10-278"><a href="#cb10-278" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">quantize</span>(</span>
<span id="cb10-279"><a href="#cb10-279" aria-hidden="true" tabindex="-1"></a>    colorInterpolator<span class="op">,</span></span>
<span id="cb10-280"><a href="#cb10-280" aria-hidden="true" tabindex="-1"></a>    tidyData<span class="op">.</span><span class="fu">groupby</span>(groupBy)<span class="op">.</span><span class="fu">count</span>()<span class="op">.</span><span class="fu">objects</span>()<span class="op">.</span><span class="at">length</span></span>
<span id="cb10-281"><a href="#cb10-281" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-282"><a href="#cb10-282" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="288" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 287;"><span id="cb11-288"><a href="#cb11-288" aria-hidden="true" tabindex="-1"></a>dConnections <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="294" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 293;"><span id="cb12-294"><a href="#cb12-294" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> {</span>
<span id="cb12-295"><a href="#cb12-295" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> n <span class="kw">of</span> dData<span class="op">.</span><span class="fu">values</span>()) {</span>
<span id="cb12-296"><a href="#cb12-296" aria-hidden="true" tabindex="-1"></a>    n<span class="op">.</span><span class="at">degree</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-297"><a href="#cb12-297" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-298"><a href="#cb12-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-299"><a href="#cb12-299" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> linksArray <span class="op">=</span> links<span class="op">.</span><span class="fu">objects</span>()<span class="op">;</span></span>
<span id="cb12-300"><a href="#cb12-300" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> l <span class="kw">of</span> linksArray) {</span>
<span id="cb12-301"><a href="#cb12-301" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> source <span class="op">=</span> dData<span class="op">.</span><span class="fu">get</span>(l<span class="op">.</span><span class="at">source</span>)<span class="op">;</span></span>
<span id="cb12-302"><a href="#cb12-302" aria-hidden="true" tabindex="-1"></a>    <span class="co">// target = dNodes.get(l.target);</span></span>
<span id="cb12-303"><a href="#cb12-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-304"><a href="#cb12-304" aria-hidden="true" tabindex="-1"></a>    source<span class="op">.</span><span class="at">cluster</span> <span class="op">=</span> l<span class="op">.</span><span class="at">target</span><span class="op">;</span></span>
<span id="cb12-305"><a href="#cb12-305" aria-hidden="true" tabindex="-1"></a>    <span class="co">// target.cluster = l.target;</span></span>
<span id="cb12-306"><a href="#cb12-306" aria-hidden="true" tabindex="-1"></a>    source<span class="op">.</span><span class="at">degree</span> <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb12-307"><a href="#cb12-307" aria-hidden="true" tabindex="-1"></a>    <span class="co">// target.degree += 1;</span></span>
<span id="cb12-308"><a href="#cb12-308" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-309"><a href="#cb12-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-310"><a href="#cb12-310" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> getOrCreateNode <span class="op">=</span> (name) <span class="kw">=&gt;</span> {</span>
<span id="cb12-311"><a href="#cb12-311" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> node <span class="op">=</span> dConnections<span class="op">.</span><span class="fu">get</span>(name)<span class="op">;</span></span>
<span id="cb12-312"><a href="#cb12-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-313"><a href="#cb12-313" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>node) {</span>
<span id="cb12-314"><a href="#cb12-314" aria-hidden="true" tabindex="-1"></a>      node <span class="op">=</span> {</span>
<span id="cb12-315"><a href="#cb12-315" aria-hidden="true" tabindex="-1"></a>        name<span class="op">,</span></span>
<span id="cb12-316"><a href="#cb12-316" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"Connection"</span><span class="op">,</span></span>
<span id="cb12-317"><a href="#cb12-317" aria-hidden="true" tabindex="-1"></a>        <span class="dt">cluster</span><span class="op">:</span> name<span class="op">,</span></span>
<span id="cb12-318"><a href="#cb12-318" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> width <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> width) <span class="op">/</span> <span class="dv">10</span><span class="op">,</span></span>
<span id="cb12-319"><a href="#cb12-319" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> fheight_node<span class="op">.</span><span class="at">height</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> fheight_node<span class="op">.</span><span class="at">height</span>) <span class="op">/</span> <span class="dv">10</span></span>
<span id="cb12-320"><a href="#cb12-320" aria-hidden="true" tabindex="-1"></a>      }<span class="op">;</span></span>
<span id="cb12-321"><a href="#cb12-321" aria-hidden="true" tabindex="-1"></a>      dConnections<span class="op">.</span><span class="fu">set</span>(name<span class="op">,</span> node)<span class="op">;</span></span>
<span id="cb12-322"><a href="#cb12-322" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-323"><a href="#cb12-323" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node<span class="op">;</span></span>
<span id="cb12-324"><a href="#cb12-324" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb12-325"><a href="#cb12-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-326"><a href="#cb12-326" aria-hidden="true" tabindex="-1"></a>  <span class="co">// --------- Filter Links and Nodes --------------</span></span>
<span id="cb12-327"><a href="#cb12-327" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> filteredLinks <span class="op">=</span> linksArray<span class="op">.</span><span class="fu">map</span>((l) <span class="kw">=&gt;</span> {</span>
<span id="cb12-328"><a href="#cb12-328" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb12-329"><a href="#cb12-329" aria-hidden="true" tabindex="-1"></a>      <span class="dt">source</span><span class="op">:</span> dData<span class="op">.</span><span class="fu">get</span>(l<span class="op">.</span><span class="at">source</span>)<span class="op">,</span></span>
<span id="cb12-330"><a href="#cb12-330" aria-hidden="true" tabindex="-1"></a>      <span class="dt">target</span><span class="op">:</span> <span class="fu">getOrCreateNode</span>(l<span class="op">.</span><span class="at">target</span>)</span>
<span id="cb12-331"><a href="#cb12-331" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb12-332"><a href="#cb12-332" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb12-333"><a href="#cb12-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-334"><a href="#cb12-334" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> filteredNodesObject <span class="op">=</span> filteredLinks<span class="op">.</span><span class="fu">reduce</span>(</span>
<span id="cb12-335"><a href="#cb12-335" aria-hidden="true" tabindex="-1"></a>    (p<span class="op">,</span> l) <span class="kw">=&gt;</span> {</span>
<span id="cb12-336"><a href="#cb12-336" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>p<span class="op">.</span><span class="at">set</span><span class="op">.</span><span class="fu">has</span>(l<span class="op">.</span><span class="at">source</span><span class="op">.</span><span class="at">name</span>)) {</span>
<span id="cb12-337"><a href="#cb12-337" aria-hidden="true" tabindex="-1"></a>        p<span class="op">.</span><span class="at">set</span><span class="op">.</span><span class="fu">add</span>(l<span class="op">.</span><span class="at">source</span><span class="op">.</span><span class="at">name</span>)<span class="op">;</span></span>
<span id="cb12-338"><a href="#cb12-338" aria-hidden="true" tabindex="-1"></a>        p<span class="op">.</span><span class="at">list</span><span class="op">.</span><span class="fu">push</span>(l<span class="op">.</span><span class="at">source</span>)<span class="op">;</span></span>
<span id="cb12-339"><a href="#cb12-339" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb12-340"><a href="#cb12-340" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>p<span class="op">.</span><span class="at">set</span><span class="op">.</span><span class="fu">has</span>(l<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">name</span>)) {</span>
<span id="cb12-341"><a href="#cb12-341" aria-hidden="true" tabindex="-1"></a>        p<span class="op">.</span><span class="at">set</span><span class="op">.</span><span class="fu">add</span>(l<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">name</span>)<span class="op">;</span></span>
<span id="cb12-342"><a href="#cb12-342" aria-hidden="true" tabindex="-1"></a>        p<span class="op">.</span><span class="at">list</span><span class="op">.</span><span class="fu">push</span>(l<span class="op">.</span><span class="at">target</span>)<span class="op">;</span></span>
<span id="cb12-343"><a href="#cb12-343" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb12-344"><a href="#cb12-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-345"><a href="#cb12-345" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> p<span class="op">;</span></span>
<span id="cb12-346"><a href="#cb12-346" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb12-347"><a href="#cb12-347" aria-hidden="true" tabindex="-1"></a>    { <span class="kw">set</span><span class="op">:</span> <span class="kw">new</span> <span class="bu">Set</span>()<span class="op">,</span> <span class="dt">list</span><span class="op">:</span> [] }</span>
<span id="cb12-348"><a href="#cb12-348" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb12-349"><a href="#cb12-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-350"><a href="#cb12-350" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Clusters is used for the hulls</span></span>
<span id="cb12-351"><a href="#cb12-351" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> clusters <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollups</span>(</span>
<span id="cb12-352"><a href="#cb12-352" aria-hidden="true" tabindex="-1"></a>    filteredLinks<span class="op">,</span></span>
<span id="cb12-353"><a href="#cb12-353" aria-hidden="true" tabindex="-1"></a>    (v) <span class="kw">=&gt;</span> v<span class="op">.</span><span class="fu">map</span>((l) <span class="kw">=&gt;</span> l<span class="op">.</span><span class="at">source</span>)<span class="op">.</span><span class="fu">concat</span>([v[<span class="dv">0</span>]<span class="op">.</span><span class="at">target</span>])<span class="op">,</span></span>
<span id="cb12-354"><a href="#cb12-354" aria-hidden="true" tabindex="-1"></a>    (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">name</span></span>
<span id="cb12-355"><a href="#cb12-355" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb12-356"><a href="#cb12-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-357"><a href="#cb12-357" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb12-358"><a href="#cb12-358" aria-hidden="true" tabindex="-1"></a>    <span class="dt">nodes</span><span class="op">:</span> filteredNodesObject<span class="op">.</span><span class="at">list</span><span class="op">,</span></span>
<span id="cb12-359"><a href="#cb12-359" aria-hidden="true" tabindex="-1"></a>    <span class="dt">links</span><span class="op">:</span> linksArray<span class="op">,</span></span>
<span id="cb12-360"><a href="#cb12-360" aria-hidden="true" tabindex="-1"></a>    <span class="dt">clusters</span><span class="op">:</span> clusters</span>
<span id="cb12-361"><a href="#cb12-361" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb12-362"><a href="#cb12-362" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="368" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 367;"><span id="cb13-368"><a href="#cb13-368" aria-hidden="true" tabindex="-1"></a>dateFmt <span class="op">=</span> d3<span class="op">.</span><span class="fu">timeParse</span>(<span class="st">"%m/%d/%y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb14" data-startfrom="374" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 373;"><span id="cb14-374"><a href="#cb14-374" aria-hidden="true" tabindex="-1"></a>tidyData <span class="op">=</span> aq</span>
<span id="cb14-375"><a href="#cb14-375" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">from</span>(data_hubs)</span>
<span id="cb14-376"><a href="#cb14-376" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">derive</span>({</span>
<span id="cb14-377"><a href="#cb14-377" aria-hidden="true" tabindex="-1"></a>    <span class="st">"conocimiento"</span><span class="op">:</span> (d) <span class="kw">=&gt;</span></span>
<span id="cb14-378"><a href="#cb14-378" aria-hidden="true" tabindex="-1"></a>      d[<span class="st">"conocimiento"</span>] <span class="op">===</span> <span class="kw">null</span> <span class="op">?</span> [<span class="kw">null</span>] <span class="op">:</span> op<span class="op">.</span><span class="fu">split</span>(d[<span class="st">"conocimiento"</span>]<span class="op">,</span> <span class="st">","</span>)<span class="op">,</span></span>
<span id="cb14-379"><a href="#cb14-379" aria-hidden="true" tabindex="-1"></a>    <span class="st">"técnica"</span><span class="op">:</span> (d) <span class="kw">=&gt;</span></span>
<span id="cb14-380"><a href="#cb14-380" aria-hidden="true" tabindex="-1"></a>      d[<span class="st">"técnica"</span>] <span class="op">===</span> <span class="kw">null</span> <span class="op">?</span> [<span class="kw">null</span>] <span class="op">:</span> op<span class="op">.</span><span class="fu">split</span>(d[<span class="st">"técnica"</span>]<span class="op">,</span> <span class="st">","</span>)<span class="op">,</span></span>
<span id="cb14-381"><a href="#cb14-381" aria-hidden="true" tabindex="-1"></a>    <span class="st">"blanda"</span><span class="op">:</span> (d) <span class="kw">=&gt;</span></span>
<span id="cb14-382"><a href="#cb14-382" aria-hidden="true" tabindex="-1"></a>      d[<span class="st">"blanda"</span>] <span class="op">===</span> <span class="kw">null</span> <span class="op">?</span> [<span class="kw">null</span>] <span class="op">:</span> op<span class="op">.</span><span class="fu">split</span>(d[<span class="st">"blanda"</span>]<span class="op">,</span> <span class="st">","</span>)</span>
<span id="cb14-383"><a href="#cb14-383" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb14-384"><a href="#cb14-384" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">unroll</span>(<span class="st">"conocimiento"</span>)</span>
<span id="cb14-385"><a href="#cb14-385" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">unroll</span>(<span class="st">"técnica"</span>)</span>
<span id="cb14-386"><a href="#cb14-386" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">unroll</span>(<span class="st">"blanda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb15" data-startfrom="393" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 392;"><span id="cb15-393"><a href="#cb15-393" aria-hidden="true" tabindex="-1"></a>links <span class="op">=</span> tidyData</span>
<span id="cb15-394"><a href="#cb15-394" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(aq<span class="op">.</span><span class="fu">escape</span>((d) <span class="kw">=&gt;</span> <span class="op">!</span>d<span class="op">.</span><span class="at">year</span> <span class="op">||</span> d<span class="op">.</span><span class="at">year</span> <span class="op">&lt;=</span> minDate)) <span class="co">// Filter by Date</span></span>
<span id="cb15-395"><a href="#cb15-395" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">derive</span>({</span>
<span id="cb15-396"><a href="#cb15-396" aria-hidden="true" tabindex="-1"></a>    <span class="dt">source</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">name</span><span class="op">,</span></span>
<span id="cb15-397"><a href="#cb15-397" aria-hidden="true" tabindex="-1"></a>    <span class="dt">target</span><span class="op">:</span> aq<span class="op">.</span><span class="fu">escape</span>((d) <span class="kw">=&gt;</span> d[groupBy])</span>
<span id="cb15-398"><a href="#cb15-398" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb15-399"><a href="#cb15-399" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">groupby</span>([<span class="st">"source"</span><span class="op">,</span> <span class="st">"target"</span>])</span>
<span id="cb15-400"><a href="#cb15-400" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">count</span>()</span>
<span id="cb15-401"><a href="#cb15-401" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">target</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">source</span>) <span class="co">// Ignore nulls</span></span>
<span id="cb15-402"><a href="#cb15-402" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(aq<span class="op">.</span><span class="fu">escape</span>((d) <span class="kw">=&gt;</span> selectedTargets<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">target</span>))) <span class="co">// Filter by selectedTarget</span></span>
<span id="cb15-403"><a href="#cb15-403" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">select</span>([<span class="st">"source"</span><span class="op">,</span> <span class="st">"target"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb16" data-startfrom="409" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 408;"><span id="cb16-409"><a href="#cb16-409" aria-hidden="true" tabindex="-1"></a>targets <span class="op">=</span> links</span>
<span id="cb16-410"><a href="#cb16-410" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">groupby</span>(<span class="st">"target"</span>)</span>
<span id="cb16-411"><a href="#cb16-411" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">count</span>()</span>
<span id="cb16-412"><a href="#cb16-412" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">rename</span>({ <span class="dt">target</span><span class="op">:</span> <span class="st">"name"</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb17" data-startfrom="417" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 416;"><span id="cb17-417"><a href="#cb17-417" aria-hidden="true" tabindex="-1"></a>sources <span class="op">=</span> links</span>
<span id="cb17-418"><a href="#cb17-418" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">groupby</span>(<span class="st">"source"</span>)</span>
<span id="cb17-419"><a href="#cb17-419" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">count</span>()</span>
<span id="cb17-420"><a href="#cb17-420" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">rename</span>({ <span class="dt">source</span><span class="op">:</span> <span class="st">"name"</span> })</span>
<span id="cb17-421"><a href="#cb17-421" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">derive</span>({ <span class="dt">type</span><span class="op">:</span> () <span class="kw">=&gt;</span> <span class="st">"Bioeconomy"</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb18" data-startfrom="426" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 425;"><span id="cb18-426"><a href="#cb18-426" aria-hidden="true" tabindex="-1"></a>col_names <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(data_hubs[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-18" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb19" data-startfrom="432" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 431;"><span id="cb19-432"><a href="#cb19-432" aria-hidden="true" tabindex="-1"></a>template_2 <span class="op">=</span> (inputs) <span class="kw">=&gt;</span> </span>
<span id="cb19-433"><a href="#cb19-433" aria-hidden="true" tabindex="-1"></a>  htl<span class="op">.</span><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb19-434"><a href="#cb19-434" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div class="styled-template-2"&gt;</span></span>
<span id="cb19-435"><a href="#cb19-435" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span><span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(inputs)<span class="sc">}</span></span>
<span id="cb19-436"><a href="#cb19-436" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/div&gt;</span></span>
<span id="cb19-437"><a href="#cb19-437" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;style&gt;</span></span>
<span id="cb19-438"><a href="#cb19-438" aria-hidden="true" tabindex="-1"></a><span class="vs">      .styled-template-2 {</span></span>
<span id="cb19-439"><a href="#cb19-439" aria-hidden="true" tabindex="-1"></a><span class="vs">        text-align: left;</span></span>
<span id="cb19-440"><a href="#cb19-440" aria-hidden="true" tabindex="-1"></a><span class="vs">        column-count: 2; /* Mantiene 2 columnas */</span></span>
<span id="cb19-441"><a href="#cb19-441" aria-hidden="true" tabindex="-1"></a><span class="vs">        column-gap: 20px; /* Espacio entre columnas */</span></span>
<span id="cb19-442"><a href="#cb19-442" aria-hidden="true" tabindex="-1"></a><span class="vs">        max-width: 600px; /* Ancho máximo del formulario */</span></span>
<span id="cb19-443"><a href="#cb19-443" aria-hidden="true" tabindex="-1"></a><span class="vs">        margin-left: 0; /* Alinea a la izquierda */</span></span>
<span id="cb19-444"><a href="#cb19-444" aria-hidden="true" tabindex="-1"></a><span class="vs">      }</span></span>
<span id="cb19-445"><a href="#cb19-445" aria-hidden="true" tabindex="-1"></a><span class="vs">      .styled-template-2 label {</span></span>
<span id="cb19-446"><a href="#cb19-446" aria-hidden="true" tabindex="-1"></a><span class="vs">        font-weight: bold;</span></span>
<span id="cb19-447"><a href="#cb19-447" aria-hidden="true" tabindex="-1"></a><span class="vs">        line-height: 200%;</span></span>
<span id="cb19-448"><a href="#cb19-448" aria-hidden="true" tabindex="-1"></a><span class="vs">      }</span></span>
<span id="cb19-449"><a href="#cb19-449" aria-hidden="true" tabindex="-1"></a><span class="vs">      .styled-template-2 label:not(div&gt;label)::after {</span></span>
<span id="cb19-450"><a href="#cb19-450" aria-hidden="true" tabindex="-1"></a><span class="vs">        content: ":";</span></span>
<span id="cb19-451"><a href="#cb19-451" aria-hidden="true" tabindex="-1"></a><span class="vs">      }</span></span>
<span id="cb19-452"><a href="#cb19-452" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/style&gt;</span></span>
<span id="cb19-453"><a href="#cb19-453" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb20" data-startfrom="459" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 458;"><span id="cb20-459"><a href="#cb20-459" aria-hidden="true" tabindex="-1"></a>template_4 <span class="op">=</span> (inputs) <span class="kw">=&gt;</span> </span>
<span id="cb20-460"><a href="#cb20-460" aria-hidden="true" tabindex="-1"></a>  htl<span class="op">.</span><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb20-461"><a href="#cb20-461" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div class="styled"&gt;</span></span>
<span id="cb20-462"><a href="#cb20-462" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span><span class="bu">Object</span><span class="op">.</span><span class="fu">entries</span>(inputs)<span class="op">.</span><span class="fu">map</span>(([key<span class="op">,</span> input]) <span class="kw">=&gt;</span> {</span>
<span id="cb20-463"><a href="#cb20-463" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Extract the label text from the input, if any, and remove it to prevent duplication</span></span>
<span id="cb20-464"><a href="#cb20-464" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> labelText <span class="op">=</span> input<span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'label'</span>) <span class="op">?</span> input<span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'label'</span>)<span class="op">.</span><span class="at">textContent</span> <span class="op">:</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb20-465"><a href="#cb20-465" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (input<span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'label'</span>)) input<span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'label'</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb20-466"><a href="#cb20-466" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb20-467"><a href="#cb20-467" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div class="input-group"&gt;</span></span>
<span id="cb20-468"><a href="#cb20-468" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;label&gt;</span><span class="sc">${</span>labelText<span class="sc">}</span><span class="vs">&lt;/label&gt;</span></span>
<span id="cb20-469"><a href="#cb20-469" aria-hidden="true" tabindex="-1"></a><span class="vs">            </span><span class="sc">${</span>input<span class="sc">}</span></span>
<span id="cb20-470"><a href="#cb20-470" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;/div&gt;</span></span>
<span id="cb20-471"><a href="#cb20-471" aria-hidden="true" tabindex="-1"></a><span class="vs">        `</span><span class="op">;</span></span>
<span id="cb20-472"><a href="#cb20-472" aria-hidden="true" tabindex="-1"></a>      })<span class="sc">}</span></span>
<span id="cb20-473"><a href="#cb20-473" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/div&gt;</span></span>
<span id="cb20-474"><a href="#cb20-474" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;style&gt;</span></span>
<span id="cb20-475"><a href="#cb20-475" aria-hidden="true" tabindex="-1"></a><span class="vs">      div.styled {</span></span>
<span id="cb20-476"><a href="#cb20-476" aria-hidden="true" tabindex="-1"></a><span class="vs">        text-align: left;</span></span>
<span id="cb20-477"><a href="#cb20-477" aria-hidden="true" tabindex="-1"></a><span class="vs">        column-count: 4; /* Set to 4 columns */</span></span>
<span id="cb20-478"><a href="#cb20-478" aria-hidden="true" tabindex="-1"></a><span class="vs">        column-gap: 20px; /* Space between columns */</span></span>
<span id="cb20-479"><a href="#cb20-479" aria-hidden="true" tabindex="-1"></a><span class="vs">      }</span></span>
<span id="cb20-480"><a href="#cb20-480" aria-hidden="true" tabindex="-1"></a><span class="vs">      div.input-group {</span></span>
<span id="cb20-481"><a href="#cb20-481" aria-hidden="true" tabindex="-1"></a><span class="vs">        display: flex;</span></span>
<span id="cb20-482"><a href="#cb20-482" aria-hidden="true" tabindex="-1"></a><span class="vs">        flex-direction: column;</span></span>
<span id="cb20-483"><a href="#cb20-483" aria-hidden="true" tabindex="-1"></a><span class="vs">        margin-bottom: 10px; /* Space between inputs */</span></span>
<span id="cb20-484"><a href="#cb20-484" aria-hidden="true" tabindex="-1"></a><span class="vs">      }</span></span>
<span id="cb20-485"><a href="#cb20-485" aria-hidden="true" tabindex="-1"></a><span class="vs">      div.input-group label {</span></span>
<span id="cb20-486"><a href="#cb20-486" aria-hidden="true" tabindex="-1"></a><span class="vs">        font-weight: bold;</span></span>
<span id="cb20-487"><a href="#cb20-487" aria-hidden="true" tabindex="-1"></a><span class="vs">        margin-bottom: 5px; /* Space between label and control */</span></span>
<span id="cb20-488"><a href="#cb20-488" aria-hidden="true" tabindex="-1"></a><span class="vs">      }</span></span>
<span id="cb20-489"><a href="#cb20-489" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/style&gt;</span></span>
<span id="cb20-490"><a href="#cb20-490" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb21" data-startfrom="499" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 498;"><span id="cb21-499"><a href="#cb21-499" aria-hidden="true" tabindex="-1"></a>viewof minDate <span class="op">=</span> {</span>
<span id="cb21-500"><a href="#cb21-500" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dates <span class="op">=</span> data_hubs</span>
<span id="cb21-501"><a href="#cb21-501" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)</span>
<span id="cb21-502"><a href="#cb21-502" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d)</span>
<span id="cb21-503"><a href="#cb21-503" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">ascending</span>(<span class="op">+</span>a<span class="op">,</span> <span class="op">+</span>b))<span class="op">;</span></span>
<span id="cb21-504"><a href="#cb21-504" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">Scrubber</span>(dates<span class="op">,</span> {</span>
<span id="cb21-505"><a href="#cb21-505" aria-hidden="true" tabindex="-1"></a>    <span class="dt">delay</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span></span>
<span id="cb21-506"><a href="#cb21-506" aria-hidden="true" tabindex="-1"></a>    <span class="dt">autoplay</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb21-507"><a href="#cb21-507" aria-hidden="true" tabindex="-1"></a>    <span class="dt">loop</span><span class="op">:</span><span class="kw">false</span><span class="op">,</span></span>
<span id="cb21-508"><a href="#cb21-508" aria-hidden="true" tabindex="-1"></a>    <span class="dt">initial</span><span class="op">:</span> dates<span class="op">.</span><span class="at">length</span><span class="op">-</span><span class="dv">1</span></span>
<span id="cb21-509"><a href="#cb21-509" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb21-510"><a href="#cb21-510" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb22" data-startfrom="517" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 516;"><span id="cb22-517"><a href="#cb22-517" aria-hidden="true" tabindex="-1"></a>viewof groupBy <span class="op">=</span> {</span>
<span id="cb22-518"><a href="#cb22-518" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> attrs <span class="op">=</span> [</span>
<span id="cb22-519"><a href="#cb22-519" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"plataforma",</span></span>
<span id="cb22-520"><a href="#cb22-520" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"descripcion",</span></span>
<span id="cb22-521"><a href="#cb22-521" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"link",</span></span>
<span id="cb22-522"><a href="#cb22-522" aria-hidden="true" tabindex="-1"></a>  <span class="st">"conocimiento"</span><span class="op">,</span></span>
<span id="cb22-523"><a href="#cb22-523" aria-hidden="true" tabindex="-1"></a>  <span class="st">"técnica"</span><span class="op">,</span></span>
<span id="cb22-524"><a href="#cb22-524" aria-hidden="true" tabindex="-1"></a>  <span class="st">"blanda"</span><span class="op">,</span></span>
<span id="cb22-525"><a href="#cb22-525" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"partners",</span></span>
<span id="cb22-526"><a href="#cb22-526" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"country_host",</span></span>
<span id="cb22-527"><a href="#cb22-527" aria-hidden="true" tabindex="-1"></a>  <span class="co">////"year",</span></span>
<span id="cb22-528"><a href="#cb22-528" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"departamentos",</span></span>
<span id="cb22-529"><a href="#cb22-529" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"def_bioeconomia"</span></span>
<span id="cb22-530"><a href="#cb22-530" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"relaciones"</span></span>
<span id="cb22-531"><a href="#cb22-531" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"logo"</span></span>
<span id="cb22-532"><a href="#cb22-532" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"logo_viz"</span></span>
<span id="cb22-533"><a href="#cb22-533" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"lat_host"</span></span>
<span id="cb22-534"><a href="#cb22-534" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"long_host"</span></span>
<span id="cb22-535"><a href="#cb22-535" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb22-536"><a href="#cb22-536" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(attrs<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Group"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"phases"</span> })<span class="op">;</span></span>
<span id="cb22-537"><a href="#cb22-537" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb23" data-startfrom="544" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 543;"><span id="cb23-544"><a href="#cb23-544" aria-hidden="true" tabindex="-1"></a>viewof selectedTargets <span class="op">=</span> {</span>
<span id="cb23-545"><a href="#cb23-545" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> targetNames <span class="op">=</span> tidyData</span>
<span id="cb23-546"><a href="#cb23-546" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">groupby</span>(groupBy)</span>
<span id="cb23-547"><a href="#cb23-547" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">count</span>()</span>
<span id="cb23-548"><a href="#cb23-548" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">objects</span>()</span>
<span id="cb23-549"><a href="#cb23-549" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d[groupBy])</span>
<span id="cb23-550"><a href="#cb23-550" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb23-551"><a href="#cb23-551" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cr <span class="op">=</span> <span class="dv">15</span><span class="op">;</span></span>
<span id="cb23-552"><a href="#cb23-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-553"><a href="#cb23-553" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> container <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div style="display: flex; flex-direction: column;"&gt;&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb23-554"><a href="#cb23-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-555"><a href="#cb23-555" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> selectAllCheckbox <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>([<span class="st">"Select All"</span>]<span class="op">,</span> {</span>
<span id="cb23-556"><a href="#cb23-556" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> [<span class="st">"Select All"</span>]<span class="op">,</span></span>
<span id="cb23-557"><a href="#cb23-557" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">"Select All / Deselect All"</span><span class="op">,</span></span>
<span id="cb23-558"><a href="#cb23-558" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb23-559"><a href="#cb23-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-560"><a href="#cb23-560" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> optionsCheckbox <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>(targetNames<span class="op">,</span> {</span>
<span id="cb23-561"><a href="#cb23-561" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">"Show"</span><span class="op">,</span></span>
<span id="cb23-562"><a href="#cb23-562" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> targetNames<span class="op">,</span></span>
<span id="cb23-563"><a href="#cb23-563" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">html</span><span class="vs">`&lt;div style="height: </span><span class="sc">${</span>cr<span class="sc">}</span><span class="vs">px;</span></span>
<span id="cb23-564"><a href="#cb23-564" aria-hidden="true" tabindex="-1"></a><span class="vs">      line-height: </span><span class="sc">${</span>cr<span class="sc">}</span><span class="vs">px; </span></span>
<span id="cb23-565"><a href="#cb23-565" aria-hidden="true" tabindex="-1"></a><span class="vs">      display: flex;</span></span>
<span id="cb23-566"><a href="#cb23-566" aria-hidden="true" tabindex="-1"></a><span class="vs">      align-content: center;</span></span>
<span id="cb23-567"><a href="#cb23-567" aria-hidden="true" tabindex="-1"></a><span class="vs">      flex-wrap: wrap;</span></span>
<span id="cb23-568"><a href="#cb23-568" aria-hidden="true" tabindex="-1"></a><span class="vs">    "&gt;&lt;svg width=</span><span class="sc">${</span>cr<span class="sc">}</span><span class="vs"> height=</span><span class="sc">${</span>cr<span class="sc">}</span><span class="vs"> style="margin-right:5px"&gt;</span></span>
<span id="cb23-569"><a href="#cb23-569" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;circle r=</span><span class="sc">${</span>cr <span class="op">/</span> <span class="dv">2</span><span class="sc">}</span><span class="vs"> cx=</span><span class="sc">${</span>cr <span class="op">/</span> <span class="dv">2</span><span class="sc">}</span><span class="vs"> cy=</span><span class="sc">${</span>cr <span class="op">/</span> <span class="dv">2</span><span class="sc">}</span><span class="vs"> fill="</span><span class="sc">${</span><span class="fu">hullColor</span>(d)<span class="sc">}</span><span class="vs">"/&gt; </span></span>
<span id="cb23-570"><a href="#cb23-570" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/svg&gt;</span><span class="sc">${</span>d<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb23-571"><a href="#cb23-571" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb23-572"><a href="#cb23-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-573"><a href="#cb23-573" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Actualizar opciones según "Select All"</span></span>
<span id="cb23-574"><a href="#cb23-574" aria-hidden="true" tabindex="-1"></a>  selectAllCheckbox<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"input"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb23-575"><a href="#cb23-575" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (selectAllCheckbox<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">includes</span>(<span class="st">"Select All"</span>)) {</span>
<span id="cb23-576"><a href="#cb23-576" aria-hidden="true" tabindex="-1"></a>      optionsCheckbox<span class="op">.</span><span class="at">value</span> <span class="op">=</span> targetNames<span class="op">;</span></span>
<span id="cb23-577"><a href="#cb23-577" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb23-578"><a href="#cb23-578" aria-hidden="true" tabindex="-1"></a>      optionsCheckbox<span class="op">.</span><span class="at">value</span> <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb23-579"><a href="#cb23-579" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-580"><a href="#cb23-580" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="at">value</span> <span class="op">=</span> optionsCheckbox<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb23-581"><a href="#cb23-581" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb23-582"><a href="#cb23-582" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb23-583"><a href="#cb23-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-584"><a href="#cb23-584" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Actualizar "Select All" según opciones individuales</span></span>
<span id="cb23-585"><a href="#cb23-585" aria-hidden="true" tabindex="-1"></a>  optionsCheckbox<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"input"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb23-586"><a href="#cb23-586" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (optionsCheckbox<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="at">length</span> <span class="op">===</span> targetNames<span class="op">.</span><span class="at">length</span>) {</span>
<span id="cb23-587"><a href="#cb23-587" aria-hidden="true" tabindex="-1"></a>      selectAllCheckbox<span class="op">.</span><span class="at">value</span> <span class="op">=</span> [<span class="st">"Select All"</span>]<span class="op">;</span></span>
<span id="cb23-588"><a href="#cb23-588" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb23-589"><a href="#cb23-589" aria-hidden="true" tabindex="-1"></a>      selectAllCheckbox<span class="op">.</span><span class="at">value</span> <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb23-590"><a href="#cb23-590" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-591"><a href="#cb23-591" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="at">value</span> <span class="op">=</span> optionsCheckbox<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb23-592"><a href="#cb23-592" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb23-593"><a href="#cb23-593" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb23-594"><a href="#cb23-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-595"><a href="#cb23-595" aria-hidden="true" tabindex="-1"></a>  container<span class="op">.</span><span class="fu">appendChild</span>(selectAllCheckbox)<span class="op">;</span></span>
<span id="cb23-596"><a href="#cb23-596" aria-hidden="true" tabindex="-1"></a>  container<span class="op">.</span><span class="fu">appendChild</span>(optionsCheckbox)<span class="op">;</span></span>
<span id="cb23-597"><a href="#cb23-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-598"><a href="#cb23-598" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Establece el valor inicial y eventos</span></span>
<span id="cb23-599"><a href="#cb23-599" aria-hidden="true" tabindex="-1"></a>  container<span class="op">.</span><span class="at">value</span> <span class="op">=</span> optionsCheckbox<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb23-600"><a href="#cb23-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-601"><a href="#cb23-601" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> container<span class="op">;</span></span>
<span id="cb23-602"><a href="#cb23-602" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-23" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb24" data-startfrom="610" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 609;"><span id="cb24-610"><a href="#cb24-610" aria-hidden="true" tabindex="-1"></a>viewof fheight_node <span class="op">=</span> (</span>
<span id="cb24-611"><a href="#cb24-611" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">form</span>({</span>
<span id="cb24-612"><a href="#cb24-612" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">200</span><span class="op">,</span> <span class="dv">1400</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Height"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span><span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">420</span>})<span class="op">,</span></span>
<span id="cb24-613"><a href="#cb24-613" aria-hidden="true" tabindex="-1"></a>  <span class="dt">nodeSize</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">2</span><span class="op">,</span> <span class="dv">30</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Node Size"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span> <span class="dv">23</span><span class="op">,</span><span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})}<span class="op">,</span></span>
<span id="cb24-614"><a href="#cb24-614" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb24-615"><a href="#cb24-615" aria-hidden="true" tabindex="-1"></a>    <span class="dt">template</span><span class="op">:</span> template_2 </span>
<span id="cb24-616"><a href="#cb24-616" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb24-617"><a href="#cb24-617" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-24" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb25" data-startfrom="624" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 623;"><span id="cb25-624"><a href="#cb25-624" aria-hidden="true" tabindex="-1"></a>chart <span class="op">=</span> {</span>
<span id="cb25-625"><a href="#cb25-625" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb25-626"><a href="#cb25-626" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width)</span>
<span id="cb25-627"><a href="#cb25-627" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> fheight_node<span class="op">.</span><span class="at">height</span>)</span>
<span id="cb25-628"><a href="#cb25-628" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> fheight_node<span class="op">.</span><span class="at">height</span>])</span>
<span id="cb25-629"><a href="#cb25-629" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"style"</span><span class="op">,</span> <span class="st">"max-width: 100%; height: auto; height: intrinsic; overflow: visible"</span>)<span class="op">;</span></span>
<span id="cb25-630"><a href="#cb25-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-631"><a href="#cb25-631" aria-hidden="true" tabindex="-1"></a>  graph<span class="op">.</span><span class="at">nodes</span><span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span> (d) {</span>
<span id="cb25-632"><a href="#cb25-632" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">r</span> <span class="op">=</span> d<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span> <span class="op">?</span> fheight_node<span class="op">.</span><span class="at">nodeSize</span> <span class="op">:</span> fhpadding_box<span class="op">.</span><span class="at">greyNodeSize</span><span class="op">;</span></span>
<span id="cb25-633"><a href="#cb25-633" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb25-634"><a href="#cb25-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-635"><a href="#cb25-635" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> chargeScale <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb25-636"><a href="#cb25-636" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">20</span><span class="op">,</span> <span class="dv">160</span>])</span>
<span id="cb25-637"><a href="#cb25-637" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([width <span class="op">&lt;</span> <span class="dv">800</span> <span class="op">?</span> <span class="op">-</span><span class="dv">100</span> <span class="op">:</span> <span class="op">-</span><span class="dv">200</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">800</span> <span class="op">?</span> <span class="op">-</span><span class="dv">50</span> <span class="op">:</span> <span class="op">-</span><span class="dv">100</span>])<span class="op">;</span></span>
<span id="cb25-638"><a href="#cb25-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-639"><a href="#cb25-639" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> chargeStrength <span class="op">=</span> <span class="kw">function</span> (d) {</span>
<span id="cb25-640"><a href="#cb25-640" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (fheight_node<span class="op">.</span><span class="at">nodeSize</span> <span class="op">/</span> <span class="dv">10</span>) <span class="op">*</span> (d<span class="op">.</span><span class="at">degree</span> <span class="op">&gt;</span> <span class="dv">1</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="fl">0.7</span>) <span class="op">*</span> <span class="fu">chargeScale</span>(graph<span class="op">.</span><span class="at">nodes</span><span class="op">.</span><span class="at">length</span>)<span class="op">;</span></span>
<span id="cb25-641"><a href="#cb25-641" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb25-642"><a href="#cb25-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-643"><a href="#cb25-643" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> simulation <span class="op">=</span> d3<span class="op">.</span><span class="fu">forceSimulation</span>(graph<span class="op">.</span><span class="at">nodes</span>)</span>
<span id="cb25-644"><a href="#cb25-644" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">alpha</span>(<span class="dv">3</span>)</span>
<span id="cb25-645"><a href="#cb25-645" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">force</span>(</span>
<span id="cb25-646"><a href="#cb25-646" aria-hidden="true" tabindex="-1"></a>      <span class="st">"link"</span><span class="op">,</span></span>
<span id="cb25-647"><a href="#cb25-647" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">forceLink</span>(graph<span class="op">.</span><span class="at">links</span>)</span>
<span id="cb25-648"><a href="#cb25-648" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">id</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">name</span>)</span>
<span id="cb25-649"><a href="#cb25-649" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">distance</span>(<span class="dv">10</span>)</span>
<span id="cb25-650"><a href="#cb25-650" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">strength</span>(<span class="fl">0.1</span>)</span>
<span id="cb25-651"><a href="#cb25-651" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-652"><a href="#cb25-652" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">force</span>(<span class="st">"charge"</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">forceManyBody</span>()<span class="op">.</span><span class="fu">strength</span>(chargeStrength))</span>
<span id="cb25-653"><a href="#cb25-653" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">force</span>(<span class="st">"collide"</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">forceCollide</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">r</span> <span class="op">+</span> <span class="dv">3</span>)<span class="op">.</span><span class="fu">iterations</span>(<span class="dv">4</span>))</span>
<span id="cb25-654"><a href="#cb25-654" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">force</span>(<span class="st">"x"</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">forceX</span>(width <span class="op">/</span> <span class="dv">2</span>)<span class="op">.</span><span class="fu">strength</span>(<span class="fl">0.1</span>))</span>
<span id="cb25-655"><a href="#cb25-655" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">force</span>(<span class="st">"y"</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">forceY</span>(fheight_node<span class="op">.</span><span class="at">height</span> <span class="op">/</span> <span class="dv">2</span>)<span class="op">.</span><span class="fu">strength</span>((<span class="fl">0.07</span> <span class="op">*</span> width) <span class="op">/</span> fheight_node<span class="op">.</span><span class="at">height</span>))<span class="op">;</span></span>
<span id="cb25-656"><a href="#cb25-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-657"><a href="#cb25-657" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> area <span class="op">=</span> d3<span class="op">.</span><span class="fu">line</span>()<span class="op">.</span><span class="fu">curve</span>(d3<span class="op">.</span><span class="at">curveCardinalClosed</span>)<span class="op">;</span></span>
<span id="cb25-658"><a href="#cb25-658" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> hp <span class="op">=</span> fhpadding_box<span class="op">.</span><span class="at">hullPadding</span><span class="op">;</span></span>
<span id="cb25-659"><a href="#cb25-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-660"><a href="#cb25-660" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> getHull <span class="op">=</span> <span class="kw">function</span> (d) {</span>
<span id="cb25-661"><a href="#cb25-661" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> points <span class="op">=</span> d[<span class="dv">1</span>]</span>
<span id="cb25-662"><a href="#cb25-662" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> fclabels_check<span class="op">.</span><span class="at">showGroupingNodes</span> <span class="op">||</span> d<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span>)</span>
<span id="cb25-663"><a href="#cb25-663" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">map</span>(n <span class="kw">=&gt;</span> [</span>
<span id="cb25-664"><a href="#cb25-664" aria-hidden="true" tabindex="-1"></a>        [n<span class="op">.</span><span class="at">x</span> <span class="op">-</span> (n<span class="op">.</span><span class="at">r</span> <span class="op">+</span> hp)<span class="op">,</span> n<span class="op">.</span><span class="at">y</span>]<span class="op">,</span></span>
<span id="cb25-665"><a href="#cb25-665" aria-hidden="true" tabindex="-1"></a>        [n<span class="op">.</span><span class="at">x</span> <span class="op">+</span> n<span class="op">.</span><span class="at">r</span> <span class="op">+</span> hp<span class="op">,</span> n<span class="op">.</span><span class="at">y</span>]<span class="op">,</span></span>
<span id="cb25-666"><a href="#cb25-666" aria-hidden="true" tabindex="-1"></a>        [n<span class="op">.</span><span class="at">x</span><span class="op">,</span> n<span class="op">.</span><span class="at">y</span> <span class="op">+</span> n<span class="op">.</span><span class="at">r</span> <span class="op">+</span> hp]<span class="op">,</span></span>
<span id="cb25-667"><a href="#cb25-667" aria-hidden="true" tabindex="-1"></a>        [n<span class="op">.</span><span class="at">x</span><span class="op">,</span> n<span class="op">.</span><span class="at">y</span> <span class="op">-</span> (n<span class="op">.</span><span class="at">r</span> <span class="op">+</span> hp)]</span>
<span id="cb25-668"><a href="#cb25-668" aria-hidden="true" tabindex="-1"></a>      ])</span>
<span id="cb25-669"><a href="#cb25-669" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">flat</span>()<span class="op">;</span></span>
<span id="cb25-670"><a href="#cb25-670" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> hull <span class="op">=</span> d3<span class="op">.</span><span class="fu">polygonHull</span>(points)<span class="op">;</span></span>
<span id="cb25-671"><a href="#cb25-671" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hull <span class="op">&amp;&amp;</span> <span class="fu">area</span>(hull)<span class="op">;</span></span>
<span id="cb25-672"><a href="#cb25-672" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb25-673"><a href="#cb25-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-674"><a href="#cb25-674" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> hullG <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"gHulls"</span>)<span class="op">;</span></span>
<span id="cb25-675"><a href="#cb25-675" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> hull <span class="op">=</span> hullG</span>
<span id="cb25-676"><a href="#cb25-676" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"path.hull"</span>)</span>
<span id="cb25-677"><a href="#cb25-677" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(</span>
<span id="cb25-678"><a href="#cb25-678" aria-hidden="true" tabindex="-1"></a>      graph<span class="op">.</span><span class="at">clusters</span><span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> <span class="op">!</span><span class="kw">true</span> <span class="op">||</span> d[<span class="dv">0</span>] <span class="op">!==</span> <span class="st">"Khoury College of Computer Sciences"</span>)<span class="op">,</span></span>
<span id="cb25-679"><a href="#cb25-679" aria-hidden="true" tabindex="-1"></a>      d <span class="kw">=&gt;</span> d[<span class="dv">0</span>]</span>
<span id="cb25-680"><a href="#cb25-680" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-681"><a href="#cb25-681" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"path"</span>)</span>
<span id="cb25-682"><a href="#cb25-682" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hull"</span>)</span>
<span id="cb25-683"><a href="#cb25-683" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">hullColor</span>(d[<span class="dv">0</span>]))</span>
<span id="cb25-684"><a href="#cb25-684" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.3</span>)</span>
<span id="cb25-685"><a href="#cb25-685" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb25-686"><a href="#cb25-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-687"><a href="#cb25-687" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> linkG <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"gLinks"</span>)<span class="op">;</span></span>
<span id="cb25-688"><a href="#cb25-688" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> link <span class="op">=</span> linkG</span>
<span id="cb25-689"><a href="#cb25-689" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#999a"</span>)</span>
<span id="cb25-690"><a href="#cb25-690" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-opacity"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb25-691"><a href="#cb25-691" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">0.5</span>)</span>
<span id="cb25-692"><a href="#cb25-692" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-linecap"</span><span class="op">,</span> <span class="st">"round"</span>)</span>
<span id="cb25-693"><a href="#cb25-693" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb25-694"><a href="#cb25-694" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(</span>
<span id="cb25-695"><a href="#cb25-695" aria-hidden="true" tabindex="-1"></a>      graph<span class="op">.</span><span class="at">links</span><span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> fclabels_check<span class="op">.</span><span class="at">showGroupingNodes</span> <span class="op">||</span> d<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span>)<span class="op">,</span></span>
<span id="cb25-696"><a href="#cb25-696" aria-hidden="true" tabindex="-1"></a>      d <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="at">source</span><span class="op">.</span><span class="at">name</span><span class="sc">}</span><span class="vs">-</span><span class="sc">${</span>d<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">name</span><span class="sc">}</span><span class="vs">`</span></span>
<span id="cb25-697"><a href="#cb25-697" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-698"><a href="#cb25-698" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"line"</span>)<span class="op">;</span></span>
<span id="cb25-699"><a href="#cb25-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-700"><a href="#cb25-700" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> nodeG <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"gNodes"</span>)<span class="op">;</span></span>
<span id="cb25-701"><a href="#cb25-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-702"><a href="#cb25-702" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Crear labels para Bioeconomy y nodos grises primero</span></span>
<span id="cb25-703"><a href="#cb25-703" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> getNameArray <span class="op">=</span> <span class="kw">function</span> (d) {</span>
<span id="cb25-704"><a href="#cb25-704" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d<span class="op">.</span><span class="at">nameArray</span> <span class="op">?</span> d<span class="op">.</span><span class="at">nameArray</span> <span class="op">:</span> d<span class="op">.</span><span class="at">name</span><span class="op">.</span><span class="fu">split</span>(<span class="st">" "</span>)<span class="op">;</span></span>
<span id="cb25-705"><a href="#cb25-705" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb25-706"><a href="#cb25-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-707"><a href="#cb25-707" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> lineWidth <span class="op">=</span> <span class="fl">1.9</span><span class="op">;</span></span>
<span id="cb25-708"><a href="#cb25-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-709"><a href="#cb25-709" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> createLabels <span class="op">=</span> <span class="kw">function</span> (_data<span class="op">,</span> className <span class="op">=</span> <span class="st">"BioeconomyLabel"</span>) {</span>
<span id="cb25-710"><a href="#cb25-710" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> svg</span>
<span id="cb25-711"><a href="#cb25-711" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`text.</span><span class="sc">${</span>className<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb25-712"><a href="#cb25-712" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(_data<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">name</span>)</span>
<span id="cb25-713"><a href="#cb25-713" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">"text"</span>)</span>
<span id="cb25-714"><a href="#cb25-714" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> className)</span>
<span id="cb25-715"><a href="#cb25-715" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb25-716"><a href="#cb25-716" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>fhpadding_box<span class="op">.</span><span class="at">fontSize</span> <span class="op">*</span> (d<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span> <span class="op">?</span> d<span class="op">.</span><span class="at">r</span> <span class="op">/</span> fheight_node<span class="op">.</span><span class="at">nodeSize</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">:</span> <span class="fl">1.8</span>)<span class="sc">}</span><span class="vs">pt`</span>)</span>
<span id="cb25-717"><a href="#cb25-717" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> d <span class="kw">=&gt;</span> (d<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span> <span class="op">?</span> <span class="st">"light"</span> <span class="op">:</span> <span class="st">"bolder"</span>))</span>
<span id="cb25-718"><a href="#cb25-718" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"Oswald"</span>)</span>
<span id="cb25-719"><a href="#cb25-719" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb25-720"><a href="#cb25-720" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"clip-path"</span><span class="op">,</span> d <span class="kw">=&gt;</span> fclabels_check<span class="op">.</span><span class="at">clipLabels</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span> <span class="op">?</span> <span class="vs">`circle(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">r</span> <span class="op">-</span> <span class="dv">2</span><span class="sc">}</span><span class="vs">px)`</span> <span class="op">:</span> <span class="st">""</span>)</span>
<span id="cb25-721"><a href="#cb25-721" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">each</span>(<span class="kw">function</span> (d) {</span>
<span id="cb25-722"><a href="#cb25-722" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">select</span>(<span class="kw">this</span>)</span>
<span id="cb25-723"><a href="#cb25-723" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"tspan"</span>)</span>
<span id="cb25-724"><a href="#cb25-724" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">data</span>(<span class="fu">getNameArray</span>(d))</span>
<span id="cb25-725"><a href="#cb25-725" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">join</span>(<span class="st">"tspan"</span>)</span>
<span id="cb25-726"><a href="#cb25-726" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb25-727"><a href="#cb25-727" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> lineWidth <span class="op">+</span> <span class="st">"ch"</span>)</span>
<span id="cb25-728"><a href="#cb25-728" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">text</span>(n <span class="kw">=&gt;</span> n)<span class="op">;</span></span>
<span id="cb25-729"><a href="#cb25-729" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb25-730"><a href="#cb25-730" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> d <span class="kw">=&gt;</span> (<span class="fu">getNameArray</span>(d)<span class="op">.</span><span class="at">length</span> <span class="op">/</span> <span class="dv">2</span>) <span class="op">*</span> <span class="op">-</span>lineWidth <span class="op">+</span> <span class="st">"ch"</span>)<span class="op">;</span></span>
<span id="cb25-731"><a href="#cb25-731" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb25-732"><a href="#cb25-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-733"><a href="#cb25-733" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> label <span class="op">=</span> <span class="fu">createLabels</span>(</span>
<span id="cb25-734"><a href="#cb25-734" aria-hidden="true" tabindex="-1"></a>    graph<span class="op">.</span><span class="at">nodes</span><span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span> <span class="op">?</span> d<span class="op">.</span><span class="at">degree</span> <span class="op">&gt;=</span> fhpadding_box<span class="op">.</span><span class="at">minDegree</span> <span class="op">:</span> <span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb25-735"><a href="#cb25-735" aria-hidden="true" tabindex="-1"></a>    <span class="st">"BioeconomyLabel"</span></span>
<span id="cb25-736"><a href="#cb25-736" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb25-737"><a href="#cb25-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-738"><a href="#cb25-738" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> labelDepts <span class="op">=</span> <span class="fu">createLabels</span>(</span>
<span id="cb25-739"><a href="#cb25-739" aria-hidden="true" tabindex="-1"></a>    graph<span class="op">.</span><span class="at">nodes</span><span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">!==</span> <span class="st">"Bioeconomy"</span>)<span class="op">,</span></span>
<span id="cb25-740"><a href="#cb25-740" aria-hidden="true" tabindex="-1"></a>    <span class="st">"departmentLabel"</span></span>
<span id="cb25-741"><a href="#cb25-741" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb25-742"><a href="#cb25-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-743"><a href="#cb25-743" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Crear nodos y añadir imágenes sobre los labels</span></span>
<span id="cb25-744"><a href="#cb25-744" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> node <span class="op">=</span> nodeG</span>
<span id="cb25-745"><a href="#cb25-745" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"circle"</span>)</span>
<span id="cb25-746"><a href="#cb25-746" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(</span>
<span id="cb25-747"><a href="#cb25-747" aria-hidden="true" tabindex="-1"></a>      graph<span class="op">.</span><span class="at">nodes</span><span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> fclabels_check<span class="op">.</span><span class="at">showGroupingNodes</span> <span class="op">||</span> d<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"Bioeconomy"</span>)<span class="op">,</span></span>
<span id="cb25-748"><a href="#cb25-748" aria-hidden="true" tabindex="-1"></a>      d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">name</span></span>
<span id="cb25-749"><a href="#cb25-749" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-750"><a href="#cb25-750" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"circle"</span>)</span>
<span id="cb25-751"><a href="#cb25-751" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> (d<span class="op">.</span><span class="at">type</span> <span class="op">!==</span> <span class="st">"Bioeconomy"</span> <span class="op">?</span> <span class="st">"#999"</span> <span class="op">:</span> <span class="fu">hullColor</span>(d<span class="op">.</span><span class="at">cluster</span>)))</span>
<span id="cb25-752"><a href="#cb25-752" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-opacity"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb25-753"><a href="#cb25-753" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb25-754"><a href="#cb25-754" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">r</span>)</span>
<span id="cb25-755"><a href="#cb25-755" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(<span class="fu">drag</span>(simulation))<span class="op">;</span></span>
<span id="cb25-756"><a href="#cb25-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-757"><a href="#cb25-757" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> images <span class="op">=</span> nodeG</span>
<span id="cb25-758"><a href="#cb25-758" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"image"</span>)</span>
<span id="cb25-759"><a href="#cb25-759" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(</span>
<span id="cb25-760"><a href="#cb25-760" aria-hidden="true" tabindex="-1"></a>      fclabels_check<span class="op">.</span><span class="at">useImages</span></span>
<span id="cb25-761"><a href="#cb25-761" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> graph<span class="op">.</span><span class="at">nodes</span><span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">logo_viz</span>)</span>
<span id="cb25-762"><a href="#cb25-762" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> []<span class="op">,</span></span>
<span id="cb25-763"><a href="#cb25-763" aria-hidden="true" tabindex="-1"></a>      d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">name</span></span>
<span id="cb25-764"><a href="#cb25-764" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-765"><a href="#cb25-765" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"image"</span>)</span>
<span id="cb25-766"><a href="#cb25-766" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"href"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">logo_viz</span>)</span>
<span id="cb25-767"><a href="#cb25-767" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">r</span> <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">4</span>)</span>
<span id="cb25-768"><a href="#cb25-768" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">r</span> <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">4</span>)</span>
<span id="cb25-769"><a href="#cb25-769" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb25-770"><a href="#cb25-770" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"preserveAspectRatio"</span><span class="op">,</span> <span class="st">"xMidYMid slice"</span>)</span>
<span id="cb25-771"><a href="#cb25-771" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(-</span><span class="sc">${</span>d<span class="op">.</span><span class="at">r</span> <span class="op">-</span> <span class="dv">2</span><span class="sc">}</span><span class="vs">, -</span><span class="sc">${</span>d<span class="op">.</span><span class="at">r</span> <span class="op">-</span> <span class="dv">2</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb25-772"><a href="#cb25-772" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"clip-path"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`circle(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">r</span> <span class="op">-</span> <span class="dv">2</span><span class="sc">}</span><span class="vs">px)`</span>)</span>
<span id="cb25-773"><a href="#cb25-773" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(<span class="fu">drag</span>(simulation))<span class="op">;</span></span>
<span id="cb25-774"><a href="#cb25-774" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-775"><a href="#cb25-775" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateVisibility</span>() {</span>
<span id="cb25-776"><a href="#cb25-776" aria-hidden="true" tabindex="-1"></a>  label<span class="op">.</span><span class="fu">attr</span>(<span class="st">"display"</span><span class="op">,</span> fclabels_check<span class="op">.</span><span class="at">useImages</span> <span class="op">?</span> <span class="st">"none"</span> <span class="op">:</span> <span class="st">"block"</span>)<span class="op">;</span></span>
<span id="cb25-777"><a href="#cb25-777" aria-hidden="true" tabindex="-1"></a>  images<span class="op">.</span><span class="fu">attr</span>(<span class="st">"display"</span><span class="op">,</span> fclabels_check<span class="op">.</span><span class="at">useImages</span> <span class="op">?</span> <span class="st">"block"</span> <span class="op">:</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb25-778"><a href="#cb25-778" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-779"><a href="#cb25-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateVisibility</span>()<span class="op">;</span></span>
<span id="cb25-780"><a href="#cb25-780" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">ticked</span>() {</span>
<span id="cb25-781"><a href="#cb25-781" aria-hidden="true" tabindex="-1"></a>    link</span>
<span id="cb25-782"><a href="#cb25-782" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">source</span><span class="op">.</span><span class="at">x</span>)</span>
<span id="cb25-783"><a href="#cb25-783" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">source</span><span class="op">.</span><span class="at">y</span>)</span>
<span id="cb25-784"><a href="#cb25-784" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">x</span>)</span>
<span id="cb25-785"><a href="#cb25-785" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">y</span>)<span class="op">;</span></span>
<span id="cb25-786"><a href="#cb25-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-787"><a href="#cb25-787" aria-hidden="true" tabindex="-1"></a>    label<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">x</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>d<span class="op">.</span><span class="at">y</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">.</span><span class="fu">classed</span>(<span class="st">"shadow"</span><span class="op">,</span> simulation<span class="op">.</span><span class="fu">alpha</span>() <span class="op">&lt;=</span> <span class="fl">0.1</span>)<span class="op">;</span></span>
<span id="cb25-788"><a href="#cb25-788" aria-hidden="true" tabindex="-1"></a>    labelDepts<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">x</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>d<span class="op">.</span><span class="at">y</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">.</span><span class="fu">classed</span>(<span class="st">"shadow"</span><span class="op">,</span> simulation<span class="op">.</span><span class="fu">alpha</span>() <span class="op">&lt;=</span> <span class="fl">0.1</span>)<span class="op">;</span></span>
<span id="cb25-789"><a href="#cb25-789" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-790"><a href="#cb25-790" aria-hidden="true" tabindex="-1"></a>    node<span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">y</span>)<span class="op">.</span><span class="fu">classed</span>(<span class="st">"shadow"</span><span class="op">,</span> simulation<span class="op">.</span><span class="fu">alpha</span>() <span class="op">&lt;=</span> <span class="fl">0.1</span>)<span class="op">;</span></span>
<span id="cb25-791"><a href="#cb25-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-792"><a href="#cb25-792" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (fclabels_check<span class="op">.</span><span class="at">useImages</span>) {</span>
<span id="cb25-793"><a href="#cb25-793" aria-hidden="true" tabindex="-1"></a>      images<span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">y</span>)<span class="op">;</span></span>
<span id="cb25-794"><a href="#cb25-794" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-795"><a href="#cb25-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-796"><a href="#cb25-796" aria-hidden="true" tabindex="-1"></a>    hull<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> getHull)<span class="op">;</span></span>
<span id="cb25-797"><a href="#cb25-797" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-798"><a href="#cb25-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-799"><a href="#cb25-799" aria-hidden="true" tabindex="-1"></a>  simulation<span class="op">.</span><span class="fu">on</span>(<span class="st">"tick"</span><span class="op">,</span> ticked)<span class="op">;</span></span>
<span id="cb25-800"><a href="#cb25-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-801"><a href="#cb25-801" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drag</span>(simulation) {</span>
<span id="cb25-802"><a href="#cb25-802" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">dragstarted</span>(<span class="bu">event</span>) {</span>
<span id="cb25-803"><a href="#cb25-803" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span><span class="bu">event</span><span class="op">.</span><span class="at">active</span>) simulation<span class="op">.</span><span class="fu">alphaTarget</span>(<span class="fl">0.3</span>)<span class="op">.</span><span class="fu">restart</span>()<span class="op">;</span></span>
<span id="cb25-804"><a href="#cb25-804" aria-hidden="true" tabindex="-1"></a>      <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">fx</span> <span class="op">=</span> <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">x</span><span class="op">;</span></span>
<span id="cb25-805"><a href="#cb25-805" aria-hidden="true" tabindex="-1"></a>      <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">fy</span> <span class="op">=</span> <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">y</span><span class="op">;</span></span>
<span id="cb25-806"><a href="#cb25-806" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-807"><a href="#cb25-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-808"><a href="#cb25-808" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">dragged</span>(<span class="bu">event</span>) {</span>
<span id="cb25-809"><a href="#cb25-809" aria-hidden="true" tabindex="-1"></a>      <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">fx</span> <span class="op">=</span> <span class="bu">event</span><span class="op">.</span><span class="at">x</span><span class="op">;</span></span>
<span id="cb25-810"><a href="#cb25-810" aria-hidden="true" tabindex="-1"></a>      <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">fy</span> <span class="op">=</span> <span class="bu">event</span><span class="op">.</span><span class="at">y</span><span class="op">;</span></span>
<span id="cb25-811"><a href="#cb25-811" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-812"><a href="#cb25-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-813"><a href="#cb25-813" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">dragended</span>(<span class="bu">event</span>) {</span>
<span id="cb25-814"><a href="#cb25-814" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span><span class="bu">event</span><span class="op">.</span><span class="at">active</span>) simulation<span class="op">.</span><span class="fu">alphaTarget</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb25-815"><a href="#cb25-815" aria-hidden="true" tabindex="-1"></a>      <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">fx</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb25-816"><a href="#cb25-816" aria-hidden="true" tabindex="-1"></a>      <span class="bu">event</span><span class="op">.</span><span class="at">subject</span><span class="op">.</span><span class="at">fy</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb25-817"><a href="#cb25-817" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-818"><a href="#cb25-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-819"><a href="#cb25-819" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d3</span>
<span id="cb25-820"><a href="#cb25-820" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">drag</span>()</span>
<span id="cb25-821"><a href="#cb25-821" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> dragstarted)</span>
<span id="cb25-822"><a href="#cb25-822" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"drag"</span><span class="op">,</span> dragged)</span>
<span id="cb25-823"><a href="#cb25-823" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"end"</span><span class="op">,</span> dragended)<span class="op">;</span></span>
<span id="cb25-824"><a href="#cb25-824" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-825"><a href="#cb25-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-826"><a href="#cb25-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-827"><a href="#cb25-827" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> simulation<span class="op">.</span><span class="fu">stop</span>())<span class="op">;</span></span>
<span id="cb25-828"><a href="#cb25-828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ticked</span>()<span class="op">;</span></span>
<span id="cb25-829"><a href="#cb25-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-830"><a href="#cb25-830" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;div&gt;</span></span>
<span id="cb25-831"><a href="#cb25-831" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;h2&gt; bioeconomy enabling networks by </span><span class="sc">${</span>groupBy<span class="sc">}</span><span class="vs">&lt;/h2&gt;</span></span>
<span id="cb25-832"><a href="#cb25-832" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span><span class="sc">${</span>svg<span class="op">.</span><span class="fu">node</span>()<span class="sc">}</span></span>
<span id="cb25-833"><a href="#cb25-833" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb25-834"><a href="#cb25-834" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-25" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb26" data-startfrom="841" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 840;"><span id="cb26-841"><a href="#cb26-841" aria-hidden="true" tabindex="-1"></a>viewof colorInterpolator <span class="op">=</span> {</span>
<span id="cb26-842"><a href="#cb26-842" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> colorSchemes <span class="op">=</span> [</span>
<span id="cb26-843"><a href="#cb26-843" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateBlues"</span><span class="op">,</span></span>
<span id="cb26-844"><a href="#cb26-844" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateBrBG"</span><span class="op">,</span></span>
<span id="cb26-845"><a href="#cb26-845" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateRdBu"</span><span class="op">,</span></span>
<span id="cb26-846"><a href="#cb26-846" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateRdYlGn"</span><span class="op">,</span></span>
<span id="cb26-847"><a href="#cb26-847" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateReds"</span><span class="op">,</span></span>
<span id="cb26-848"><a href="#cb26-848" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateSinebow"</span><span class="op">,</span></span>
<span id="cb26-849"><a href="#cb26-849" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateSpectral"</span><span class="op">,</span></span>
<span id="cb26-850"><a href="#cb26-850" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateTurbo"</span><span class="op">,</span></span>
<span id="cb26-851"><a href="#cb26-851" aria-hidden="true" tabindex="-1"></a>    <span class="st">"interpolateViridis"</span><span class="op">,</span></span>
<span id="cb26-852"><a href="#cb26-852" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb26-853"><a href="#cb26-853" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> colors <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>(</span>
<span id="cb26-854"><a href="#cb26-854" aria-hidden="true" tabindex="-1"></a>    [[<span class="st">"Custom Turbo"</span><span class="op">,</span> (t) <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">interpolateTurbo</span>(<span class="fl">0.2</span> <span class="op">+</span> t <span class="op">*</span> <span class="fl">0.8</span>)]]<span class="op">.</span><span class="fu">concat</span>(</span>
<span id="cb26-855"><a href="#cb26-855" aria-hidden="true" tabindex="-1"></a>      colorSchemes<span class="op">.</span><span class="fu">map</span>((c) <span class="kw">=&gt;</span> [c<span class="op">,</span> d3[c]])</span>
<span id="cb26-856"><a href="#cb26-856" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-857"><a href="#cb26-857" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb26-858"><a href="#cb26-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-859"><a href="#cb26-859" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(colors<span class="op">,</span> {</span>
<span id="cb26-860"><a href="#cb26-860" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">"Color Scheme"</span><span class="op">,</span></span>
<span id="cb26-861"><a href="#cb26-861" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d[<span class="dv">0</span>]</span>
<span id="cb26-862"><a href="#cb26-862" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb26-863"><a href="#cb26-863" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-26" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb27" data-startfrom="870" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 869;"><span id="cb27-870"><a href="#cb27-870" aria-hidden="true" tabindex="-1"></a>viewof fhpadding_box <span class="op">=</span> (</span>
<span id="cb27-871"><a href="#cb27-871" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">form</span>({</span>
<span id="cb27-872"><a href="#cb27-872" aria-hidden="true" tabindex="-1"></a>    <span class="dt">hullPadding</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Hull Padding"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">9</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb27-873"><a href="#cb27-873" aria-hidden="true" tabindex="-1"></a>    <span class="dt">minDegree</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(graph<span class="op">.</span><span class="at">nodes</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">degree</span>) <span class="op">+</span> <span class="dv">1</span>]<span class="op">,</span> {</span>
<span id="cb27-874"><a href="#cb27-874" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="st">"Min Degree for Label"</span><span class="op">,</span></span>
<span id="cb27-875"><a href="#cb27-875" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb27-876"><a href="#cb27-876" aria-hidden="true" tabindex="-1"></a>      <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span></span>
<span id="cb27-877"><a href="#cb27-877" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb27-878"><a href="#cb27-878" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fontSize</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">36</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Font size"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb27-879"><a href="#cb27-879" aria-hidden="true" tabindex="-1"></a>    <span class="dt">greyNodeSize</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">30</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Connecting Node Size"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})</span>
<span id="cb27-880"><a href="#cb27-880" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb27-881"><a href="#cb27-881" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb27-882"><a href="#cb27-882" aria-hidden="true" tabindex="-1"></a>    <span class="dt">template</span><span class="op">:</span> template_4 <span class="co">// Específicamente usando template_4 para 4 columnas</span></span>
<span id="cb27-883"><a href="#cb27-883" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb27-884"><a href="#cb27-884" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-27" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb28" data-startfrom="891" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 890;"><span id="cb28-891"><a href="#cb28-891" aria-hidden="true" tabindex="-1"></a>viewof fclabels_check <span class="op">=</span> (</span>
<span id="cb28-892"><a href="#cb28-892" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">form</span>({</span>
<span id="cb28-893"><a href="#cb28-893" aria-hidden="true" tabindex="-1"></a>  <span class="dt">useImages</span><span class="op">:</span>Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"Use Images"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})<span class="op">,</span></span>
<span id="cb28-894"><a href="#cb28-894" aria-hidden="true" tabindex="-1"></a>  <span class="dt">showGroupingNodes</span><span class="op">:</span>Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"Show grey nodes"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})<span class="op">,</span></span>
<span id="cb28-895"><a href="#cb28-895" aria-hidden="true" tabindex="-1"></a>  <span class="dt">clipLabels</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"Clip Labels"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})<span class="op">,</span></span>
<span id="cb28-896"><a href="#cb28-896" aria-hidden="true" tabindex="-1"></a>  <span class="dt">useShadowsText</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"Use Text Shadows"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})}<span class="op">,</span></span>
<span id="cb28-897"><a href="#cb28-897" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb28-898"><a href="#cb28-898" aria-hidden="true" tabindex="-1"></a>    <span class="dt">template</span><span class="op">:</span> template_4 </span>
<span id="cb28-899"><a href="#cb28-899" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb28-900"><a href="#cb28-900" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-28" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb29" data-startfrom="908" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 907;"><span id="cb29-908"><a href="#cb29-908" aria-hidden="true" tabindex="-1"></a>filteredSkillsData <span class="op">=</span> {</span>
<span id="cb29-909"><a href="#cb29-909" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> column <span class="op">=</span> groupBy<span class="op">;</span> <span class="co">// Obtén la columna seleccionada en el selector viewof groupBy</span></span>
<span id="cb29-910"><a href="#cb29-910" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> aq</span>
<span id="cb29-911"><a href="#cb29-911" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">from</span>(skillsData)</span>
<span id="cb29-912"><a href="#cb29-912" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">params</span>({ column }) <span class="co">// Define "column" como un parámetro dinámico</span></span>
<span id="cb29-913"><a href="#cb29-913" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">tipo_habilidad</span> <span class="op">===</span> column)<span class="op">;</span> <span class="co">// Usa el parámetro dinámico</span></span>
<span id="cb29-914"><a href="#cb29-914" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-915"><a href="#cb29-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-916"><a href="#cb29-916" aria-hidden="true" tabindex="-1"></a>viewof skillsTable <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">table</span>(</span>
<span id="cb29-917"><a href="#cb29-917" aria-hidden="true" tabindex="-1"></a>  filteredSkillsData<span class="op">.</span><span class="fu">objects</span>()<span class="op">,</span> <span class="co">// Convierte los datos filtrados en un arreglo de objetos</span></span>
<span id="cb29-918"><a href="#cb29-918" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb29-919"><a href="#cb29-919" aria-hidden="true" tabindex="-1"></a>    <span class="dt">layout</span><span class="op">:</span> <span class="st">"fixed"</span><span class="op">,</span> <span class="co">// Fija el diseño de la tabla</span></span>
<span id="cb29-920"><a href="#cb29-920" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> {         <span class="co">// Define el ancho para cada columna</span></span>
<span id="cb29-921"><a href="#cb29-921" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tipo_habilidad</span><span class="op">:</span> <span class="st">"20%"</span><span class="op">,</span> <span class="co">// 20% del ancho total</span></span>
<span id="cb29-922"><a href="#cb29-922" aria-hidden="true" tabindex="-1"></a>      <span class="dt">habilidad</span><span class="op">:</span> <span class="st">"60%"</span><span class="op">,</span>      <span class="co">// 60% del ancho total</span></span>
<span id="cb29-923"><a href="#cb29-923" aria-hidden="true" tabindex="-1"></a>      <span class="dt">cantidad</span><span class="op">:</span> <span class="st">"20%"</span>        <span class="co">// 20% del ancho total</span></span>
<span id="cb29-924"><a href="#cb29-924" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb29-925"><a href="#cb29-925" aria-hidden="true" tabindex="-1"></a>    <span class="dt">sortable</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span>   <span class="co">// Permite ordenar las columnas</span></span>
<span id="cb29-926"><a href="#cb29-926" aria-hidden="true" tabindex="-1"></a>    <span class="dt">filterable</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// Permite filtrar las columnas</span></span>
<span id="cb29-927"><a href="#cb29-927" aria-hidden="true" tabindex="-1"></a>    <span class="dt">rows</span><span class="op">:</span> <span class="dv">10</span>          <span class="co">// Muestra 10 filas por página</span></span>
<span id="cb29-928"><a href="#cb29-928" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-929"><a href="#cb29-929" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-29-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-29-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>

</main>
<!-- /main column -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImQzID0gcmVxdWlyZShcImQzQDdcIilcclxubmF2aW9fbnBtID0gcmVxdWlyZShcIm5hdmlvQDAuMC43NVwiKVxyXG5JbnB1dHMgPSByZXF1aXJlKFwiQG9ic2VydmFibGVocS9pbnB1dHNcIilcclxuaHRsID0gcmVxdWlyZShcImh0bFwiKVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJhcSA9IHtcclxuICBjb25zdCBhcSA9IGF3YWl0IHJlcXVpcmUoYGFycXVlcm9AJHthcV92ZXJzaW9ufWApO1xyXG5cclxuICAvLyBBZGQgSFRNTCB0YWJsZSB2aWV3IG1ldGhvZCB0byB0YWJsZXNcclxuICBPYmplY3QuYXNzaWduKGFxLkNvbHVtblRhYmxlLnByb3RvdHlwZSwge1xyXG4gICAgdmlldyhvcHRpb25zKSB7IHJldHVybiB0b1ZpZXcodGhpcywgb3B0aW9ucyk7IH1cclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGFxO1xyXG59XHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImFxX3ZlcnNpb24gPSAnNy4yLjAnXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im9wID0gYXEub3BcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidG9WaWV3ID0ge1xyXG4gIGNvbnN0IERFRkFVTFRfTElNSVQgPSAxMDA7XHJcbiAgY29uc3QgREVGQVVMVF9OVUxMID0gdmFsdWUgPT4gYDxzcGFuIHN0eWxlPVwiY29sb3I6ICM5OTk7XCI+JHt2YWx1ZX08L3NwYW4+YDtcclxuICBjb25zdCB0YWJsZVN0eWxlID0gJ21hcmdpbjogMDsgYm9yZGVyLWNvbGxhcHNlOiBzZXBhcmF0ZTsgYm9yZGVyLXNwYWNpbmc6IDA7IHdpZHRoOiBpbml0aWFsOyc7XHJcbiAgY29uc3QgY2VsbFN0eWxlID0gJ3BhZGRpbmc6IDFweCA1cHg7IHdoaXRlLXNwYWNlOiBub3dyYXA7IG92ZXJmbG93LXg6IGhpZGRlbjsgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7IGZvbnQtdmFyaWFudC1udW1lcmljOiB0YWJ1bGFyLW51bXM7JztcclxuICBjb25zdCByb3dTdHlsZSA9ICdib3JkZXItYm90dG9tOiAxcHggc29saWQgI2VlZTsnO1xyXG5cclxuICAvLyBnaXZlbiBhbiBBcnF1ZXJvIGRhdGEgdGFibGUsIHByb3ZpZGUgYW4gSFRNTCB0YWJsZSB2aWV3XHJcbiAgcmV0dXJuIGZ1bmN0aW9uKGR0LCBvcHQgPSB7fSkge1xyXG4gICAgLy8gcGVybWl0IHNob3J0aGFuZCBmb3IgbGltaXRcclxuICAgIGlmICh0eXBlb2Ygb3B0ID09PSAnbnVtYmVyJykgb3B0ID0geyBsaW1pdDogb3B0IH07XHJcbiAgICBcclxuICAgIC8vIG1hcnNoYWwgY2VsbCBjb2xvciBvcHRpb25zXHJcbiAgICBjb25zdCBjb2xvciA9IHsgLi4ub3B0LmNvbG9yIH07XHJcbiAgICBpZiAodHlwZW9mIG9wdC5jb2xvciA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAvLyBpZiBmdW5jdGlvbiwgYXBwbHkgdG8gYWxsIGNvbHVtbnNcclxuICAgICAgZHQuY29sdW1uTmFtZXMoKS5mb3JFYWNoKG5hbWUgPT4gY29sb3JbbmFtZV0gPSBvcHQuY29sb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gb3RoZXJ3aXNlLCBnYXRoZXIgcGVyLWNvbHVtbiBjb2xvciBvcHRpb25zXHJcbiAgICAgIGZvciAoY29uc3Qga2V5IGluIGNvbG9yKSB7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSBjb2xvcltrZXldO1xyXG4gICAgICAgIGNvbG9yW2tleV0gPSB0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicgPyB2YWx1ZSA6ICgpID0+IHZhbHVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gbWFyc2hhbCBDU1Mgc3R5bGVzIGFzIHRvSFRNTCgpIG9wdGlvbnNcclxuICAgIGNvbnN0IHRhYmxlID0gYCR7dGFibGVTdHlsZX1gO1xyXG4gICAgY29uc3QgY2VsbCA9IChuYW1lLCBpbmRleCwgcm93LCB0aCkgPT4ge1xyXG4gICAgICByZXR1cm4gYCR7Y2VsbFN0eWxlfSBtYXgtd2lkdGg6ICR7K29wdC5tYXhDZWxsV2lkdGggfHwgMzAwfXB4O2BcclxuICAgICAgICArIGAgYm9yZGVyLWJvdHRvbTogc29saWQgMXB4ICR7dGggPyAnI2NjYycgOiAnI2VlZSd9O2BcclxuICAgICAgICArIChjb2xvcltuYW1lXSA/IGAgYmFja2dyb3VuZC1jb2xvcjogJHtjb2xvcltuYW1lXShpbmRleCwgcm93KX07YCA6ICcnKTtcclxuICAgIH07XHJcbiAgICBjb25zdCB0ZCA9IChuYW1lLCBpbmRleCwgcm93KSA9PiBjZWxsKG5hbWUsIGluZGV4LCByb3csIGZhbHNlKTtcclxuICAgIGNvbnN0IHRoID0gKG5hbWUsIGluZGV4LCByb3cpID0+IGBwb3NpdGlvbjogc3RpY2t5OyB0b3A6IDA7IGJhY2tncm91bmQ6ICNmZmY7IGBcclxuICAgICAgICArIGNlbGwobmFtZSwgaW5kZXgsIHJvdywgdHJ1ZSk7XHJcblxyXG4gICAgb3B0ID0ge1xyXG4gICAgICBsaW1pdDogREVGQVVMVF9MSU1JVCxcclxuICAgICAgbnVsbDogREVGQVVMVF9OVUxMLFxyXG4gICAgICAuLi5vcHQsXHJcbiAgICAgIHN0eWxlOiB7IHRhYmxlLCB0ZCwgdGggfVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyByZXR1cm4gY29udGFpbmVyIGRpdiwgYmluZCB0YWJsZSB2YWx1ZSB0byBzdXBwb3J0IHZpZXdvZiBvcGVyYXRvclxyXG4gICAgY29uc3Qgc2l6ZSA9IGBtYXgtaGVpZ2h0OiAkeytvcHQuaGVpZ2h0IHx8IDI3MH1weGA7XHJcbiAgICBjb25zdCBzdHlsZSA9IGAke3NpemV9OyBvdmVyZmxvdy14OiBhdXRvOyBvdmVyZmxvdy15OiBhdXRvO2A7XHJcbiAgICBjb25zdCB2aWV3ID0gaHRtbGA8ZGl2IHN0eWxlPVwiJHtzdHlsZX1cIj4ke2R0LnRvSFRNTChvcHQpfTwvZGl2PmA7XHJcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih2aWV3LCB7IHZhbHVlOiBkdCB9KTtcclxuICB9O1xyXG59XHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImZ1bmN0aW9uIFNjcnViYmVyKHZhbHVlcywge1xyXG4gIGZvcm1hdCA9IHZhbHVlID0+IHZhbHVlLFxyXG4gIGluaXRpYWwgPSAwLFxyXG4gIGRpcmVjdGlvbiA9IDEsXHJcbiAgZGVsYXkgPSBudWxsLFxyXG4gIGF1dG9wbGF5ID0gdHJ1ZSxcclxuICBsb29wID0gdHJ1ZSxcclxuICBsb29wRGVsYXkgPSBudWxsLFxyXG4gIGFsdGVybmF0ZSA9IGZhbHNlXHJcbn0gPSB7fSkge1xyXG4gIHZhbHVlcyA9IEFycmF5LmZyb20odmFsdWVzKTtcclxuICBjb25zdCBmb3JtID0gaHRtbGA8Zm9ybSBzdHlsZT1cImZvbnQ6IDEycHggdmFyKC0tc2Fucy1zZXJpZik7IGZvbnQtdmFyaWFudC1udW1lcmljOiB0YWJ1bGFyLW51bXM7IGRpc3BsYXk6IGZsZXg7IGhlaWdodDogMzNweDsgYWxpZ24taXRlbXM6IGNlbnRlcjtcIj5cclxuICA8YnV0dG9uIG5hbWU9YiB0eXBlPWJ1dHRvbiBzdHlsZT1cIm1hcmdpbi1yaWdodDogMC40ZW07IHdpZHRoOiA1ZW07XCI+PC9idXR0b24+XHJcbiAgPGxhYmVsIHN0eWxlPVwiZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjtcIj5cclxuICAgIDxpbnB1dCBuYW1lPWkgdHlwZT1yYW5nZSBtaW49MCBtYXg9JHt2YWx1ZXMubGVuZ3RoIC0gMX0gdmFsdWU9JHtpbml0aWFsfSBzdGVwPTEgc3R5bGU9XCJ3aWR0aDogMTgwcHg7XCI+XHJcbiAgICA8b3V0cHV0IG5hbWU9byBzdHlsZT1cIm1hcmdpbi1sZWZ0OiAwLjRlbTtcIj48L291dHB1dD5cclxuICA8L2xhYmVsPlxyXG48L2Zvcm0+YDtcclxuICBsZXQgZnJhbWUgPSBudWxsO1xyXG4gIGxldCB0aW1lciA9IG51bGw7XHJcbiAgbGV0IGludGVydmFsID0gbnVsbDtcclxuICBmdW5jdGlvbiBzdGFydCgpIHtcclxuICAgIGZvcm0uYi50ZXh0Q29udGVudCA9IFwiUGF1c2VcIjtcclxuICAgIGlmIChkZWxheSA9PT0gbnVsbCkgZnJhbWUgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGljayk7XHJcbiAgICBlbHNlIGludGVydmFsID0gc2V0SW50ZXJ2YWwodGljaywgZGVsYXkpO1xyXG4gIH1cclxuICBmdW5jdGlvbiBzdG9wKCkge1xyXG4gICAgZm9ybS5iLnRleHRDb250ZW50ID0gXCJQbGF5XCI7XHJcbiAgICBpZiAoZnJhbWUgIT09IG51bGwpIGNhbmNlbEFuaW1hdGlvbkZyYW1lKGZyYW1lKSwgZnJhbWUgPSBudWxsO1xyXG4gICAgaWYgKHRpbWVyICE9PSBudWxsKSBjbGVhclRpbWVvdXQodGltZXIpLCB0aW1lciA9IG51bGw7XHJcbiAgICBpZiAoaW50ZXJ2YWwgIT09IG51bGwpIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpLCBpbnRlcnZhbCA9IG51bGw7XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIHJ1bm5pbmcoKSB7XHJcbiAgICByZXR1cm4gZnJhbWUgIT09IG51bGwgfHwgdGltZXIgIT09IG51bGwgfHwgaW50ZXJ2YWwgIT09IG51bGw7XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIHRpY2soKSB7XHJcbiAgICBpZiAoZm9ybS5pLnZhbHVlQXNOdW1iZXIgPT09IChkaXJlY3Rpb24gPiAwID8gdmFsdWVzLmxlbmd0aCAtIDEgOiBkaXJlY3Rpb24gPCAwID8gMCA6IE5hTikpIHtcclxuICAgICAgaWYgKCFsb29wKSByZXR1cm4gc3RvcCgpO1xyXG4gICAgICBpZiAoYWx0ZXJuYXRlKSBkaXJlY3Rpb24gPSAtZGlyZWN0aW9uO1xyXG4gICAgICBpZiAobG9vcERlbGF5ICE9PSBudWxsKSB7XHJcbiAgICAgICAgaWYgKGZyYW1lICE9PSBudWxsKSBjYW5jZWxBbmltYXRpb25GcmFtZShmcmFtZSksIGZyYW1lID0gbnVsbDtcclxuICAgICAgICBpZiAoaW50ZXJ2YWwgIT09IG51bGwpIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpLCBpbnRlcnZhbCA9IG51bGw7XHJcbiAgICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IChzdGVwKCksIHN0YXJ0KCkpLCBsb29wRGVsYXkpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKGRlbGF5ID09PSBudWxsKSBmcmFtZSA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aWNrKTtcclxuICAgIHN0ZXAoKTtcclxuICB9XHJcbiAgZnVuY3Rpb24gc3RlcCgpIHtcclxuICAgIGZvcm0uaS52YWx1ZUFzTnVtYmVyID0gKGZvcm0uaS52YWx1ZUFzTnVtYmVyICsgZGlyZWN0aW9uICsgdmFsdWVzLmxlbmd0aCkgJSB2YWx1ZXMubGVuZ3RoO1xyXG4gICAgZm9ybS5pLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwiaW5wdXRcIiwge2J1YmJsZXM6IHRydWV9KSk7XHJcbiAgfVxyXG4gIGZvcm0uaS5vbmlucHV0ID0gZXZlbnQgPT4ge1xyXG4gICAgaWYgKGV2ZW50ICYmIGV2ZW50LmlzVHJ1c3RlZCAmJiBydW5uaW5nKCkpIHN0b3AoKTtcclxuICAgIGZvcm0udmFsdWUgPSB2YWx1ZXNbZm9ybS5pLnZhbHVlQXNOdW1iZXJdO1xyXG4gICAgZm9ybS5vLnZhbHVlID0gZm9ybWF0KGZvcm0udmFsdWUsIGZvcm0uaS52YWx1ZUFzTnVtYmVyLCB2YWx1ZXMpO1xyXG4gIH07XHJcbiAgZm9ybS5iLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICBpZiAocnVubmluZygpKSByZXR1cm4gc3RvcCgpO1xyXG4gICAgZGlyZWN0aW9uID0gYWx0ZXJuYXRlICYmIGZvcm0uaS52YWx1ZUFzTnVtYmVyID09PSB2YWx1ZXMubGVuZ3RoIC0gMSA/IC0xIDogMTtcclxuICAgIGZvcm0uaS52YWx1ZUFzTnVtYmVyID0gKGZvcm0uaS52YWx1ZUFzTnVtYmVyICsgZGlyZWN0aW9uKSAlIHZhbHVlcy5sZW5ndGg7XHJcbiAgICBmb3JtLmkuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJpbnB1dFwiLCB7YnViYmxlczogdHJ1ZX0pKTtcclxuICAgIHN0YXJ0KCk7XHJcbiAgfTtcclxuICBmb3JtLmkub25pbnB1dCgpO1xyXG4gIGlmIChhdXRvcGxheSkgc3RhcnQoKTtcclxuICBlbHNlIHN0b3AoKTtcclxuICBJbnB1dHMuZGlzcG9zYWwoZm9ybSkudGhlbihzdG9wKTtcclxuICByZXR1cm4gZm9ybTtcclxufVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJhc3luYyBmdW5jdGlvbiBuYXZpbyhkYXRhLCBfb3B0aW9ucyA9IHt9KSB7XHJcbiAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgIGhlaWdodDogMzAwLCAvLyBOYXZpbydzIGhlaWdodFxyXG4gICAgYXR0cmliczogbnVsbCwgLy8gYXJyYXkgb2YgYXR0cmliIG5hbWVzIHRvIGJlIHVzZWQsIGxlYXZlIGFzIG51bGwgZm9yIGFsbCBvZiB0aGVtXHJcblxyXG4gICAgeDA6IDAsIC8vV2hlcmUgdG8gc3RhcnQgZHJhd2luZyBuYXZpbyBpbiB4XHJcbiAgICB5MDogMTAwLCAvL1doZXJlIHRvIHN0YXJ0IGRyYXdpbmcgbmF2aW8gaW4geSwgdXNlZnVsIGlmIHlvdXIgYXR0cmliIG5hbWVzIGFyZSB0b28gbG9uZ1xyXG4gICAgbWF4TnVtRGlzdGljdEZvckNhdGVnb3JpY2FsOiAxMCwgLy8gYWRkQWxsQXR0cmlicyB1c2VzIHRoaXMgZm9yIGRlY2lkaW5nIGlmIGFuIGF0dHJpYnV0ZSBpcyBjYXRlZ29yaWNhbCAoaGFzIGxlc3MgdGhhbiAgICAgbWF4TnVtRGlzdGljdEZvckNhdGVnb3JpY2FsIGNhdGVnb3JpZXMpIG9yIG9yZGVyZWRcclxuICAgIG1heE51bURpc3RpY3RGb3JPcmRlcmVkOiA5MCwgLy8gYWRkQWxsQXR0cmlicyB1c2VzIHRoaXMgZm9yIGRlY2lkaW5nIGlmIGFuIGF0dHJpYnV0ZSBpcyBvcmRlcmVkIChoYXMgbGVzcyB0aGFuICAgICBtYXhOdW1EaXN0aWN0Rm9yQ2F0ZWdvcmljYWwgY2F0ZWdvcmllcykgb3IgdGV4dC4gVXNlICAgIG1heE51bURpc3RpY3RGb3JPcmRlcmVkIDogSW5maW5pdHkgZm9yIG5ldmVyIGNob29zaW5nIFRleHRcclxuXHJcbiAgICBob3dNYW55SXRlbXNTaG91bGRTZWFyY2hGb3JOb3ROdWxsOiAxMDAsIC8vIEhvdyBtYW55IHJvd3Mgc2hvdWxkIGFkZEFsbEF0dHJpYnMgc2VhcmNoIHRvIGRlY2lkZSBndWVzcyBhbiBhdHRyaWJ1dGUgdHlwZVxyXG4gICAgbWFyZ2luOiAxMCwgLy8gTWFyZ2luIGFyb3VuZCBuYXZpb1xyXG5cclxuICAgIGxldmVsc1NlcGFyYXRpb246IDQwLCAvLyBTZXBhcmF0aW9uIGJldHdlZW4gdGhlIGxldmVsc1xyXG4gICAgZGl2aXNpb25zQ29sb3I6IFwid2hpdGVcIiwgLy8gQm9yZGVyIGNvbG9yIGZvciB0aGUgZGl2aXNpb25zXHJcbiAgICBsZXZlbENvbm5lY3Rpb25zQ29sb3I6IFwicmdiYSgyMDUsIDIyMCwgMTYzLCAwLjUpXCIsIC8vIENvbG9yIGZvciB0aGUgY29uZWN0aW9ucyBiZXR3ZWVuIGxldmVsc1xyXG4gICAgZGl2aXNpb25zVGhyZXNob2xkOiA0LCAvLyBXaGF0J3MgdGhlIG1pbmltdW0gcm93IGhlaWdodCBuZWVkZWQgdG8gZHJhdyBkaXZpc2lvbnNcclxuICAgIGZtdENvdW50czogZDMuZm9ybWF0KFwiLC4wZFwiKSwgLy8gRm9ybWF0IHVzZWQgdG8gZGlzcGxheSB0aGUgY291bnRzIG9uIHRoZSBib3R0b21cclxuICAgIGxlZ2VuZEZvbnQ6IFwiMTRweCBzYW5zLXNlcmlmXCIsIC8vIFRoZSBmb250IGZvciB0aGUgaGVhZGVyXHJcbiAgICBuZXN0ZWRGaWx0ZXJzOiB0cnVlLCAvLyBTaG91bGQgbmF2aW8gdXNlIG5lc3RlZCBsZXZlbHM/XHJcblxyXG4gICAgc2hvd0F0dHJpYlRpdGxlczogdHJ1ZSwgLy8gU2hvdyBoZWFkZXJzP1xyXG4gICAgYXR0cmliV2lkdGg6IDE1LCAvLyBXaWR0aCBvZiB0aGUgY29sdW1uc1xyXG4gICAgYXR0cmliUm90YXRpb246IC00NSwgLy8gSGVhZGVycyByb3RhdGlvblxyXG4gICAgYXR0cmliRm9udFNpemU6IDEzLCAvLyBIZWFkZXJzIGZvbnQgc2l6ZVxyXG4gICAgYXR0cmliRm9udFNpemVTZWxlY3RlZDogMzIsIC8vIEhlYWRlcnMgZm9udCBzaXplIHdoZW4gbW91c2Ugb3ZlclxyXG5cclxuICAgIGZpbHRlckZvbnRTaXplOiAxMCwgLy8gRm9udCBzaXplIG9mIHRoZSBmaWx0ZXJzIGV4cGxhbmF0aW9ucyBvbiB0aGUgYm90dG9tXHJcblxyXG4gICAgdG9vbHRpcEZvbnRTaXplOiAxMiwgLy8gRm9udCBzaXplIGZvciB0aGUgdG9vbHRpcFxyXG4gICAgdG9vbHRpcEJnQ29sb3I6IFwiI2IyZGRmMVwiLCAvLyBGb250IGNvbG9yIGZvciB0b29sdGlwIGJhY2tncm91bmRcclxuICAgIHRvb2x0aXBNYXJnaW46IDUwLCAvLyBIb3cgbXVjaCB0byBzZXBhcmF0ZSB0aGUgdG9vbHRpcCBmcm9tIHRoZSBjdXJzb3JcclxuICAgIHRvb2x0aXBBcnJvd1NpemU6IDEwLCAvLyBIb3cgYmlnIGlzIHRoZSBhcnJvdyBvbiB0aGUgdG9vbHRpcFxyXG5cclxuICAgIGRpZ2l0c0ZvclRleHQ6IDIsIC8vIEhvdyBtYW55IGRpZ2l0cyB0byB1c2UgZm9yIHRleHQgYXR0cmlidXRlc1xyXG5cclxuICAgIGFkZEFsbEF0dHJpYnNSZWN1cnNpb25MZXZlbDogSW5maW5pdHksIC8vIEhvdyBtYW55IGxldmVscyBkZXB0aCBkbyB3ZSBrZWVwIG9uIGFkZGluZyBuZXN0ZWQgYXR0cmlidXRlc1xyXG4gICAgYWRkQWxsQXR0cmlic0luY2x1ZGVPYmplY3RzOiB0cnVlLCAvLyBTaG91bGQgYWRkQWxsQXR0cmlicyBpbmNsdWRlIG9iamVjdHNcclxuICAgIGFkZEFsbEF0dHJpYnNJbmNsdWRlQXJyYXlzOiB0cnVlLCAvLyBTaG91bGQgYWRkQWxsQXR0cmlicyBpbmNsdWRlIGFycmF5c1xyXG5cclxuICAgIG51bGxDb2xvcjogXCIjZmZlZGZkXCIsIC8vIENvbG9yIGZvciBudWxsIHZhbHVlc1xyXG4gICAgZGVmYXVsdENvbG9ySW50ZXJwb2xhdG9yOiBkMy5pbnRlcnBvbGF0ZUJsdWVzLFxyXG4gICAgZGVmYXVsdENvbG9ySW50ZXJwb2xhdG9yRGF0ZTogZDMuaW50ZXJwb2xhdGVQdXJwbGVzLFxyXG4gICAgZGVmYXVsdENvbG9ySW50ZXJwb2xhdG9yRGl2ZXJnaW5nOiBkMy5pbnRlcnBvbGF0ZUJyQkcsXHJcbiAgICBkZWZhdWx0Q29sb3JJbnRlcnBvbGF0b3JPcmRlcmVkOiBkMy5pbnRlcnBvbGF0ZU9yYW5nZXMsXHJcbiAgICBkZWZhdWx0Q29sb3JJbnRlcnBvbGF0b3JUZXh0OiBkMy5pbnRlcnBvbGF0ZUdyZXlzLFxyXG4gICAgZGVmYXVsdENvbG9yUmFuZ2VCb29sZWFuOiBbXCIjYTFkNzZhXCIsIFwiI2U5YTNjOVwiLCBcIndoaXRlXCJdLCAvL3RydWUgZmFsc2UgbnVsbFxyXG4gICAgZGVmYXVsdENvbG9yUmFuZ2VTZWxlY3RlZDogW1wid2hpdGVcIiwgXCIjYjVjZjZiXCJdLFxyXG4gICAgZGVmYXVsdENvbG9yQ2F0ZWdvcmljYWw6IGQzLnNjaGVtZUNhdGVnb3J5MTAsXHJcblxyXG4gICAgc2hvd1NlbGVjdGVkQXR0cmliOiB0cnVlLCAvLyBEaXNwbGF5IHRoZSBhdHRyaWJ1dGUgdGhhdCBzaG93cyBpZiBhIHJvdyBpcyBzZWxlY3RlZFxyXG4gICAgc2hvd1NlcXVlbmNlSURBdHRyaWI6IHRydWUsIC8vIERpc3BsYXkgdGhlIGF0dHJpYnV0ZSB3aXRoIHRoZSBzZXF1ZW5jZSBJRFxyXG5cclxuICAgIC4uLl9vcHRpb25zXHJcbiAgfTtcclxuXHJcbiAgbGV0IGRpdiA9IGh0bWxgPGRpdiAgc3R5bGU9XCJkaXNwbGF5OmJsb2NrOyBvdmVyZmxvdy14OnNjcm9sbFwiPjwvZGl2PmA7XHJcbiAgXHJcbiAgLy8gQ3JlYXRlIHRoZSBuYXZpb1xyXG4gIGNvbnN0IG52ID0gbmF2aW9fbnBtKGQzLnNlbGVjdChkaXYpLCBvcHRpb25zLmhlaWdodCk7XHJcblxyXG4gIGZvciAobGV0IG9wdCBpbiBvcHRpb25zKSB7XHJcbiAgICBpZiAob3B0ID09PSBcImlkXCIpIHtcclxuICAgICAgbnYuaWQob3B0aW9uc1tvcHRdKTtcclxuICAgIH0gZWxzZSBpZiAob3B0ICE9PSBcImF0dHJpYnNcIikge1xyXG4gICAgICBudltvcHRdID0gb3B0aW9uc1tvcHRdO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gQWRkIHRoZSBkYXRhXHJcbiAgbnYuZGF0YShkYXRhKTtcclxuXHJcbiAgaWYgKG9wdGlvbnMuYXR0cmlicykge1xyXG4gICAgbnYuYWRkQWxsQXR0cmlicyhvcHRpb25zLmF0dHJpYnMpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBudi5hZGRBbGxBdHRyaWJzKCk7XHJcbiAgfVxyXG5cclxuICBudi51cGRhdGVDYWxsYmFjaygoKSA9PiB7XHJcbiAgICBkaXYudmFsdWUgPSBudi5nZXRWaXNpYmxlKCk7XHJcbiAgICBkaXYuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoXCJpbnB1dFwiLCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xyXG4gICAgLy8gbm90aWZ5KGRpdik7XHJcbiAgfSk7XHJcblxyXG4gIGRpdi52YWx1ZSA9IGRhdGE7XHJcbiAgZGl2Lm52ID0gbnY7XHJcbiAgcmV0dXJuIGRpdjtcclxufVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJkYXRhX2h1YnMwID0gRmlsZUF0dGFjaG1lbnQoXCJjZWZiLmNzdlwiKS5jc3YoeyB0eXBlZDogdHJ1ZSB9KVxyXG5kYXRhX2h1YnMgPSBkYXRhX2h1YnMwLm1hcChkID0+ICh7IC4uLmQsIG5hbWU6IGQucGxhdGZvcm0sIHR5cGU6IFwiQmlvZWNvbm9teVwiIH0pKTtcclxuXHJcbnNraWxsc0RhdGEgPSBGaWxlQXR0YWNobWVudChcInNraWxsc19jb3VudC5jc3ZcIikuY3N2KHsgdHlwZWQ6IHRydWUgfSlcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC05IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZERhdGEgPSBuZXcgTWFwKGRhdGFfaHVicy5tYXAoZCA9PiBbZC5uYW1lLCBkXSkpXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJodWxsQ29sb3IgPSBkMy5zY2FsZU9yZGluYWwoXHJcbiAgZDMucXVhbnRpemUoXHJcbiAgICBjb2xvckludGVycG9sYXRvcixcclxuICAgIHRpZHlEYXRhLmdyb3VwYnkoZ3JvdXBCeSkuY291bnQoKS5vYmplY3RzKCkubGVuZ3RoXHJcbiAgKVxyXG4pXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJkQ29ubmVjdGlvbnMgPSBuZXcgTWFwKClcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImdyYXBoID0ge1xyXG4gIGZvciAobGV0IG4gb2YgZERhdGEudmFsdWVzKCkpIHtcclxuICAgIG4uZGVncmVlID0gMDtcclxuICB9XHJcblxyXG4gIGNvbnN0IGxpbmtzQXJyYXkgPSBsaW5rcy5vYmplY3RzKCk7XHJcbiAgZm9yIChsZXQgbCBvZiBsaW5rc0FycmF5KSB7XHJcbiAgICBjb25zdCBzb3VyY2UgPSBkRGF0YS5nZXQobC5zb3VyY2UpO1xyXG4gICAgLy8gdGFyZ2V0ID0gZE5vZGVzLmdldChsLnRhcmdldCk7XHJcblxyXG4gICAgc291cmNlLmNsdXN0ZXIgPSBsLnRhcmdldDtcclxuICAgIC8vIHRhcmdldC5jbHVzdGVyID0gbC50YXJnZXQ7XHJcbiAgICBzb3VyY2UuZGVncmVlICs9IDE7XHJcbiAgICAvLyB0YXJnZXQuZGVncmVlICs9IDE7XHJcbiAgfVxyXG5cclxuICBjb25zdCBnZXRPckNyZWF0ZU5vZGUgPSAobmFtZSkgPT4ge1xyXG4gICAgbGV0IG5vZGUgPSBkQ29ubmVjdGlvbnMuZ2V0KG5hbWUpO1xyXG5cclxuICAgIGlmICghbm9kZSkge1xyXG4gICAgICBub2RlID0ge1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgdHlwZTogXCJDb25uZWN0aW9uXCIsXHJcbiAgICAgICAgY2x1c3RlcjogbmFtZSxcclxuICAgICAgICB4OiB3aWR0aCAvIDIgKyAoTWF0aC5yYW5kb20oKSAqIHdpZHRoKSAvIDEwLFxyXG4gICAgICAgIHk6IGZoZWlnaHRfbm9kZS5oZWlnaHQgLyAyICsgKE1hdGgucmFuZG9tKCkgKiBmaGVpZ2h0X25vZGUuaGVpZ2h0KSAvIDEwXHJcbiAgICAgIH07XHJcbiAgICAgIGRDb25uZWN0aW9ucy5zZXQobmFtZSwgbm9kZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbm9kZTtcclxuICB9O1xyXG5cclxuICAvLyAtLS0tLS0tLS0gRmlsdGVyIExpbmtzIGFuZCBOb2RlcyAtLS0tLS0tLS0tLS0tLVxyXG4gIGNvbnN0IGZpbHRlcmVkTGlua3MgPSBsaW5rc0FycmF5Lm1hcCgobCkgPT4ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc291cmNlOiBkRGF0YS5nZXQobC5zb3VyY2UpLFxyXG4gICAgICB0YXJnZXQ6IGdldE9yQ3JlYXRlTm9kZShsLnRhcmdldClcclxuICAgIH07XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGZpbHRlcmVkTm9kZXNPYmplY3QgPSBmaWx0ZXJlZExpbmtzLnJlZHVjZShcclxuICAgIChwLCBsKSA9PiB7XHJcbiAgICAgIGlmICghcC5zZXQuaGFzKGwuc291cmNlLm5hbWUpKSB7XHJcbiAgICAgICAgcC5zZXQuYWRkKGwuc291cmNlLm5hbWUpO1xyXG4gICAgICAgIHAubGlzdC5wdXNoKGwuc291cmNlKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoIXAuc2V0LmhhcyhsLnRhcmdldC5uYW1lKSkge1xyXG4gICAgICAgIHAuc2V0LmFkZChsLnRhcmdldC5uYW1lKTtcclxuICAgICAgICBwLmxpc3QucHVzaChsLnRhcmdldCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBwO1xyXG4gICAgfSxcclxuICAgIHsgc2V0OiBuZXcgU2V0KCksIGxpc3Q6IFtdIH1cclxuICApO1xyXG5cclxuICAvLyBDbHVzdGVycyBpcyB1c2VkIGZvciB0aGUgaHVsbHNcclxuICBjb25zdCBjbHVzdGVycyA9IGQzLnJvbGx1cHMoXHJcbiAgICBmaWx0ZXJlZExpbmtzLFxyXG4gICAgKHYpID0+IHYubWFwKChsKSA9PiBsLnNvdXJjZSkuY29uY2F0KFt2WzBdLnRhcmdldF0pLFxyXG4gICAgKGQpID0+IGQudGFyZ2V0Lm5hbWVcclxuICApO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgbm9kZXM6IGZpbHRlcmVkTm9kZXNPYmplY3QubGlzdCxcclxuICAgIGxpbmtzOiBsaW5rc0FycmF5LFxyXG4gICAgY2x1c3RlcnM6IGNsdXN0ZXJzXHJcbiAgfTtcclxufVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGF0ZUZtdCA9IGQzLnRpbWVQYXJzZShcIiVtLyVkLyV5XCIpXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ0aWR5RGF0YSA9IGFxXHJcbiAgLmZyb20oZGF0YV9odWJzKVxyXG4gIC5kZXJpdmUoe1xyXG4gICAgXCJjb25vY2ltaWVudG9cIjogKGQpID0+XHJcbiAgICAgIGRbXCJjb25vY2ltaWVudG9cIl0gPT09IG51bGwgPyBbbnVsbF0gOiBvcC5zcGxpdChkW1wiY29ub2NpbWllbnRvXCJdLCBcIixcIiksXHJcbiAgICBcInTDqWNuaWNhXCI6IChkKSA9PlxyXG4gICAgICBkW1widMOpY25pY2FcIl0gPT09IG51bGwgPyBbbnVsbF0gOiBvcC5zcGxpdChkW1widMOpY25pY2FcIl0sIFwiLFwiKSxcclxuICAgIFwiYmxhbmRhXCI6IChkKSA9PlxyXG4gICAgICBkW1wiYmxhbmRhXCJdID09PSBudWxsID8gW251bGxdIDogb3Auc3BsaXQoZFtcImJsYW5kYVwiXSwgXCIsXCIpXHJcbiAgfSlcclxuICAudW5yb2xsKFwiY29ub2NpbWllbnRvXCIpXHJcbiAgLnVucm9sbChcInTDqWNuaWNhXCIpXHJcbiAgLnVucm9sbChcImJsYW5kYVwiKVxyXG5cclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImxpbmtzID0gdGlkeURhdGFcclxuICAuZmlsdGVyKGFxLmVzY2FwZSgoZCkgPT4gIWQueWVhciB8fCBkLnllYXIgPD0gbWluRGF0ZSkpIC8vIEZpbHRlciBieSBEYXRlXHJcbiAgLmRlcml2ZSh7XHJcbiAgICBzb3VyY2U6IChkKSA9PiBkLm5hbWUsXHJcbiAgICB0YXJnZXQ6IGFxLmVzY2FwZSgoZCkgPT4gZFtncm91cEJ5XSlcclxuICB9KVxyXG4gIC5ncm91cGJ5KFtcInNvdXJjZVwiLCBcInRhcmdldFwiXSlcclxuICAuY291bnQoKVxyXG4gIC5maWx0ZXIoKGQpID0+IGQudGFyZ2V0ICYmIGQuc291cmNlKSAvLyBJZ25vcmUgbnVsbHNcclxuICAuZmlsdGVyKGFxLmVzY2FwZSgoZCkgPT4gc2VsZWN0ZWRUYXJnZXRzLmluY2x1ZGVzKGQudGFyZ2V0KSkpIC8vIEZpbHRlciBieSBzZWxlY3RlZFRhcmdldFxyXG4gIC5zZWxlY3QoW1wic291cmNlXCIsIFwidGFyZ2V0XCJdKVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidGFyZ2V0cyA9IGxpbmtzXHJcbiAgLmdyb3VwYnkoXCJ0YXJnZXRcIilcclxuICAuY291bnQoKVxyXG4gIC5yZW5hbWUoeyB0YXJnZXQ6IFwibmFtZVwiIH0pXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJzb3VyY2VzID0gbGlua3NcclxuICAuZ3JvdXBieShcInNvdXJjZVwiKVxyXG4gIC5jb3VudCgpXHJcbiAgLnJlbmFtZSh7IHNvdXJjZTogXCJuYW1lXCIgfSlcclxuICAuZGVyaXZlKHsgdHlwZTogKCkgPT4gXCJCaW9lY29ub215XCIgfSlcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImNvbF9uYW1lcyA9IE9iamVjdC5rZXlzKGRhdGFfaHVic1swXSlcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InRlbXBsYXRlXzIgPSAoaW5wdXRzKSA9PiBcclxuICBodGwuaHRtbGBcclxuICAgIDxkaXYgY2xhc3M9XCJzdHlsZWQtdGVtcGxhdGUtMlwiPlxyXG4gICAgICAke09iamVjdC52YWx1ZXMoaW5wdXRzKX1cclxuICAgIDwvZGl2PlxyXG4gICAgPHN0eWxlPlxyXG4gICAgICAuc3R5bGVkLXRlbXBsYXRlLTIge1xyXG4gICAgICAgIHRleHQtYWxpZ246IGxlZnQ7XHJcbiAgICAgICAgY29sdW1uLWNvdW50OiAyOyAvKiBNYW50aWVuZSAyIGNvbHVtbmFzICovXHJcbiAgICAgICAgY29sdW1uLWdhcDogMjBweDsgLyogRXNwYWNpbyBlbnRyZSBjb2x1bW5hcyAqL1xyXG4gICAgICAgIG1heC13aWR0aDogNjAwcHg7IC8qIEFuY2hvIG3DoXhpbW8gZGVsIGZvcm11bGFyaW8gKi9cclxuICAgICAgICBtYXJnaW4tbGVmdDogMDsgLyogQWxpbmVhIGEgbGEgaXpxdWllcmRhICovXHJcbiAgICAgIH1cclxuICAgICAgLnN0eWxlZC10ZW1wbGF0ZS0yIGxhYmVsIHtcclxuICAgICAgICBmb250LXdlaWdodDogYm9sZDtcclxuICAgICAgICBsaW5lLWhlaWdodDogMjAwJTtcclxuICAgICAgfVxyXG4gICAgICAuc3R5bGVkLXRlbXBsYXRlLTIgbGFiZWw6bm90KGRpdj5sYWJlbCk6OmFmdGVyIHtcclxuICAgICAgICBjb250ZW50OiBcIjpcIjtcclxuICAgICAgfVxyXG4gICAgPC9zdHlsZT5cclxuICBgO1xyXG5cclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InRlbXBsYXRlXzQgPSAoaW5wdXRzKSA9PiBcclxuICBodGwuaHRtbGBcclxuICAgIDxkaXYgY2xhc3M9XCJzdHlsZWRcIj5cclxuICAgICAgJHtPYmplY3QuZW50cmllcyhpbnB1dHMpLm1hcCgoW2tleSwgaW5wdXRdKSA9PiB7XHJcbiAgICAgICAgLy8gRXh0cmFjdCB0aGUgbGFiZWwgdGV4dCBmcm9tIHRoZSBpbnB1dCwgaWYgYW55LCBhbmQgcmVtb3ZlIGl0IHRvIHByZXZlbnQgZHVwbGljYXRpb25cclxuICAgICAgICBjb25zdCBsYWJlbFRleHQgPSBpbnB1dC5xdWVyeVNlbGVjdG9yKCdsYWJlbCcpID8gaW5wdXQucXVlcnlTZWxlY3RvcignbGFiZWwnKS50ZXh0Q29udGVudCA6IFwiXCI7XHJcbiAgICAgICAgaWYgKGlucHV0LnF1ZXJ5U2VsZWN0b3IoJ2xhYmVsJykpIGlucHV0LnF1ZXJ5U2VsZWN0b3IoJ2xhYmVsJykucmVtb3ZlKCk7XHJcbiAgICAgICAgcmV0dXJuIGh0bC5odG1sYFxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImlucHV0LWdyb3VwXCI+XHJcbiAgICAgICAgICAgIDxsYWJlbD4ke2xhYmVsVGV4dH08L2xhYmVsPlxyXG4gICAgICAgICAgICAke2lucHV0fVxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgYDtcclxuICAgICAgfSl9XHJcbiAgICA8L2Rpdj5cclxuICAgIDxzdHlsZT5cclxuICAgICAgZGl2LnN0eWxlZCB7XHJcbiAgICAgICAgdGV4dC1hbGlnbjogbGVmdDtcclxuICAgICAgICBjb2x1bW4tY291bnQ6IDQ7IC8qIFNldCB0byA0IGNvbHVtbnMgKi9cclxuICAgICAgICBjb2x1bW4tZ2FwOiAyMHB4OyAvKiBTcGFjZSBiZXR3ZWVuIGNvbHVtbnMgKi9cclxuICAgICAgfVxyXG4gICAgICBkaXYuaW5wdXQtZ3JvdXAge1xyXG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICAgICAgICBtYXJnaW4tYm90dG9tOiAxMHB4OyAvKiBTcGFjZSBiZXR3ZWVuIGlucHV0cyAqL1xyXG4gICAgICB9XHJcbiAgICAgIGRpdi5pbnB1dC1ncm91cCBsYWJlbCB7XHJcbiAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbiAgICAgICAgbWFyZ2luLWJvdHRvbTogNXB4OyAvKiBTcGFjZSBiZXR3ZWVuIGxhYmVsIGFuZCBjb250cm9sICovXHJcbiAgICAgIH1cclxuICAgIDwvc3R5bGU+XHJcbiAgYDtcclxuXHJcblxyXG5cclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBtaW5EYXRlID0ge1xyXG4gIGNvbnN0IGRhdGVzID0gZGF0YV9odWJzXHJcbiAgICAubWFwKChkKSA9PiBkLnllYXIpXHJcbiAgICAuZmlsdGVyKChkKSA9PiBkKVxyXG4gICAgLnNvcnQoKGEsIGIpID0+IGQzLmFzY2VuZGluZygrYSwgK2IpKTtcclxuICByZXR1cm4gU2NydWJiZXIoZGF0ZXMsIHtcclxuICAgIGRlbGF5OiA1MDAsXHJcbiAgICBhdXRvcGxheTogZmFsc2UsXHJcbiAgICBsb29wOmZhbHNlLFxyXG4gICAgaW5pdGlhbDogZGF0ZXMubGVuZ3RoLTFcclxuICB9KTtcclxufVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGdyb3VwQnkgPSB7XHJcbiAgY29uc3QgYXR0cnMgPSBbXHJcbiAgLy9cInBsYXRhZm9ybWFcIixcclxuICAvL1wiZGVzY3JpcGNpb25cIixcclxuICAvL1wibGlua1wiLFxyXG4gIFwiY29ub2NpbWllbnRvXCIsXHJcbiAgXCJ0w6ljbmljYVwiLFxyXG4gIFwiYmxhbmRhXCIsXHJcbiAgLy9cInBhcnRuZXJzXCIsXHJcbiAgLy9cImNvdW50cnlfaG9zdFwiLFxyXG4gIC8vLy9cInllYXJcIixcclxuICAvL1wiZGVwYXJ0YW1lbnRvc1wiLFxyXG4gIC8vXCJkZWZfYmlvZWNvbm9taWFcIlxyXG4gIC8vXCJyZWxhY2lvbmVzXCJcclxuICAvL1wibG9nb1wiXHJcbiAgLy9cImxvZ29fdml6XCJcclxuICAvL1wibGF0X2hvc3RcIlxyXG4gIC8vXCJsb25nX2hvc3RcIlxyXG4gIF07XHJcbiAgcmV0dXJuIElucHV0cy5zZWxlY3QoYXR0cnMsIHsgbGFiZWw6IFwiR3JvdXBcIiwgdmFsdWU6IFwicGhhc2VzXCIgfSk7XHJcbn1cclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBzZWxlY3RlZFRhcmdldHMgPSB7XHJcbiAgY29uc3QgdGFyZ2V0TmFtZXMgPSB0aWR5RGF0YVxyXG4gICAgLmdyb3VwYnkoZ3JvdXBCeSlcclxuICAgIC5jb3VudCgpXHJcbiAgICAub2JqZWN0cygpXHJcbiAgICAubWFwKChkKSA9PiBkW2dyb3VwQnldKVxyXG4gICAgLmZpbHRlcigoZCkgPT4gZCk7XHJcbiAgY29uc3QgY3IgPSAxNTtcclxuXHJcbiAgY29uc3QgY29udGFpbmVyID0gaHRtbGA8ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcIj48L2Rpdj5gO1xyXG5cclxuICBjb25zdCBzZWxlY3RBbGxDaGVja2JveCA9IElucHV0cy5jaGVja2JveChbXCJTZWxlY3QgQWxsXCJdLCB7XHJcbiAgICB2YWx1ZTogW1wiU2VsZWN0IEFsbFwiXSxcclxuICAgIGxhYmVsOiBcIlNlbGVjdCBBbGwgLyBEZXNlbGVjdCBBbGxcIixcclxuICB9KTtcclxuXHJcbiAgY29uc3Qgb3B0aW9uc0NoZWNrYm94ID0gSW5wdXRzLmNoZWNrYm94KHRhcmdldE5hbWVzLCB7XHJcbiAgICBsYWJlbDogXCJTaG93XCIsXHJcbiAgICB2YWx1ZTogdGFyZ2V0TmFtZXMsXHJcbiAgICBmb3JtYXQ6IChkKSA9PiBodG1sYDxkaXYgc3R5bGU9XCJoZWlnaHQ6ICR7Y3J9cHg7XHJcbiAgICAgIGxpbmUtaGVpZ2h0OiAke2NyfXB4OyBcclxuICAgICAgZGlzcGxheTogZmxleDtcclxuICAgICAgYWxpZ24tY29udGVudDogY2VudGVyO1xyXG4gICAgICBmbGV4LXdyYXA6IHdyYXA7XHJcbiAgICBcIj48c3ZnIHdpZHRoPSR7Y3J9IGhlaWdodD0ke2NyfSBzdHlsZT1cIm1hcmdpbi1yaWdodDo1cHhcIj5cclxuICAgICAgPGNpcmNsZSByPSR7Y3IgLyAyfSBjeD0ke2NyIC8gMn0gY3k9JHtjciAvIDJ9IGZpbGw9XCIke2h1bGxDb2xvcihkKX1cIi8+IFxyXG4gICAgPC9zdmc+JHtkfTwvZGl2PmBcclxuICB9KTtcclxuXHJcbiAgLy8gQWN0dWFsaXphciBvcGNpb25lcyBzZWfDum4gXCJTZWxlY3QgQWxsXCJcclxuICBzZWxlY3RBbGxDaGVja2JveC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgaWYgKHNlbGVjdEFsbENoZWNrYm94LnZhbHVlLmluY2x1ZGVzKFwiU2VsZWN0IEFsbFwiKSkge1xyXG4gICAgICBvcHRpb25zQ2hlY2tib3gudmFsdWUgPSB0YXJnZXROYW1lcztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIG9wdGlvbnNDaGVja2JveC52YWx1ZSA9IFtdO1xyXG4gICAgfVxyXG4gICAgY29udGFpbmVyLnZhbHVlID0gb3B0aW9uc0NoZWNrYm94LnZhbHVlO1xyXG4gICAgY29udGFpbmVyLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwiaW5wdXRcIiwgeyBidWJibGVzOiB0cnVlIH0pKTtcclxuICB9KTtcclxuXHJcbiAgLy8gQWN0dWFsaXphciBcIlNlbGVjdCBBbGxcIiBzZWfDum4gb3BjaW9uZXMgaW5kaXZpZHVhbGVzXHJcbiAgb3B0aW9uc0NoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICBpZiAob3B0aW9uc0NoZWNrYm94LnZhbHVlLmxlbmd0aCA9PT0gdGFyZ2V0TmFtZXMubGVuZ3RoKSB7XHJcbiAgICAgIHNlbGVjdEFsbENoZWNrYm94LnZhbHVlID0gW1wiU2VsZWN0IEFsbFwiXTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGVjdEFsbENoZWNrYm94LnZhbHVlID0gW107XHJcbiAgICB9XHJcbiAgICBjb250YWluZXIudmFsdWUgPSBvcHRpb25zQ2hlY2tib3gudmFsdWU7XHJcbiAgICBjb250YWluZXIuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJpbnB1dFwiLCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xyXG4gIH0pO1xyXG5cclxuICBjb250YWluZXIuYXBwZW5kQ2hpbGQoc2VsZWN0QWxsQ2hlY2tib3gpO1xyXG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZChvcHRpb25zQ2hlY2tib3gpO1xyXG5cclxuICAvLyBFc3RhYmxlY2UgZWwgdmFsb3IgaW5pY2lhbCB5IGV2ZW50b3NcclxuICBjb250YWluZXIudmFsdWUgPSBvcHRpb25zQ2hlY2tib3gudmFsdWU7XHJcblxyXG4gIHJldHVybiBjb250YWluZXI7XHJcbn07XHJcblxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTI0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGZoZWlnaHRfbm9kZSA9IChcclxuICBJbnB1dHMuZm9ybSh7XHJcbiAgaGVpZ2h0OiBJbnB1dHMucmFuZ2UoWzIwMCwgMTQwMF0sIHtsYWJlbDogXCJIZWlnaHRcIiwgc3RlcDoxLCB2YWx1ZTogNDIwfSksXHJcbiAgbm9kZVNpemU6IElucHV0cy5yYW5nZShbMiwgMzBdLCB7bGFiZWw6IFwiTm9kZSBTaXplXCIsdmFsdWU6IDIzLHN0ZXA6IDF9KX0sXHJcbiAge1xyXG4gICAgdGVtcGxhdGU6IHRlbXBsYXRlXzIgXHJcbiAgfSlcclxuICApXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJjaGFydCA9IHtcclxuICBjb25zdCBzdmcgPSBkMy5jcmVhdGUoXCJzdmdcIilcclxuICAgIC5hdHRyKFwid2lkdGhcIiwgd2lkdGgpXHJcbiAgICAuYXR0cihcImhlaWdodFwiLCBmaGVpZ2h0X25vZGUuaGVpZ2h0KVxyXG4gICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFswLCAwLCB3aWR0aCwgZmhlaWdodF9ub2RlLmhlaWdodF0pXHJcbiAgICAuYXR0cihcInN0eWxlXCIsIFwibWF4LXdpZHRoOiAxMDAlOyBoZWlnaHQ6IGF1dG87IGhlaWdodDogaW50cmluc2ljOyBvdmVyZmxvdzogdmlzaWJsZVwiKTtcclxuXHJcbiAgZ3JhcGgubm9kZXMuZm9yRWFjaChmdW5jdGlvbiAoZCkge1xyXG4gICAgZC5yID0gZC50eXBlID09PSBcIkJpb2Vjb25vbXlcIiA/IGZoZWlnaHRfbm9kZS5ub2RlU2l6ZSA6IGZocGFkZGluZ19ib3guZ3JleU5vZGVTaXplO1xyXG4gIH0pO1xyXG5cclxuICBjb25zdCBjaGFyZ2VTY2FsZSA9IGQzLnNjYWxlTGluZWFyKClcclxuICAgIC5kb21haW4oWzIwLCAxNjBdKVxyXG4gICAgLnJhbmdlKFt3aWR0aCA8IDgwMCA/IC0xMDAgOiAtMjAwLCB3aWR0aCA8IDgwMCA/IC01MCA6IC0xMDBdKTtcclxuXHJcbiAgY29uc3QgY2hhcmdlU3RyZW5ndGggPSBmdW5jdGlvbiAoZCkge1xyXG4gICAgcmV0dXJuIChmaGVpZ2h0X25vZGUubm9kZVNpemUgLyAxMCkgKiAoZC5kZWdyZWUgPiAxID8gMSA6IDAuNykgKiBjaGFyZ2VTY2FsZShncmFwaC5ub2Rlcy5sZW5ndGgpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IHNpbXVsYXRpb24gPSBkMy5mb3JjZVNpbXVsYXRpb24oZ3JhcGgubm9kZXMpXHJcbiAgICAuYWxwaGEoMylcclxuICAgIC5mb3JjZShcclxuICAgICAgXCJsaW5rXCIsXHJcbiAgICAgIGQzLmZvcmNlTGluayhncmFwaC5saW5rcylcclxuICAgICAgICAuaWQoZCA9PiBkLm5hbWUpXHJcbiAgICAgICAgLmRpc3RhbmNlKDEwKVxyXG4gICAgICAgIC5zdHJlbmd0aCgwLjEpXHJcbiAgICApXHJcbiAgICAuZm9yY2UoXCJjaGFyZ2VcIiwgZDMuZm9yY2VNYW55Qm9keSgpLnN0cmVuZ3RoKGNoYXJnZVN0cmVuZ3RoKSlcclxuICAgIC5mb3JjZShcImNvbGxpZGVcIiwgZDMuZm9yY2VDb2xsaWRlKGQgPT4gZC5yICsgMykuaXRlcmF0aW9ucyg0KSlcclxuICAgIC5mb3JjZShcInhcIiwgZDMuZm9yY2VYKHdpZHRoIC8gMikuc3RyZW5ndGgoMC4xKSlcclxuICAgIC5mb3JjZShcInlcIiwgZDMuZm9yY2VZKGZoZWlnaHRfbm9kZS5oZWlnaHQgLyAyKS5zdHJlbmd0aCgoMC4wNyAqIHdpZHRoKSAvIGZoZWlnaHRfbm9kZS5oZWlnaHQpKTtcclxuXHJcbiAgY29uc3QgYXJlYSA9IGQzLmxpbmUoKS5jdXJ2ZShkMy5jdXJ2ZUNhcmRpbmFsQ2xvc2VkKTtcclxuICBjb25zdCBocCA9IGZocGFkZGluZ19ib3guaHVsbFBhZGRpbmc7XHJcblxyXG4gIGNvbnN0IGdldEh1bGwgPSBmdW5jdGlvbiAoZCkge1xyXG4gICAgY29uc3QgcG9pbnRzID0gZFsxXVxyXG4gICAgICAuZmlsdGVyKGQgPT4gZmNsYWJlbHNfY2hlY2suc2hvd0dyb3VwaW5nTm9kZXMgfHwgZC50eXBlID09PSBcIkJpb2Vjb25vbXlcIilcclxuICAgICAgLm1hcChuID0+IFtcclxuICAgICAgICBbbi54IC0gKG4uciArIGhwKSwgbi55XSxcclxuICAgICAgICBbbi54ICsgbi5yICsgaHAsIG4ueV0sXHJcbiAgICAgICAgW24ueCwgbi55ICsgbi5yICsgaHBdLFxyXG4gICAgICAgIFtuLngsIG4ueSAtIChuLnIgKyBocCldXHJcbiAgICAgIF0pXHJcbiAgICAgIC5mbGF0KCk7XHJcbiAgICBjb25zdCBodWxsID0gZDMucG9seWdvbkh1bGwocG9pbnRzKTtcclxuICAgIHJldHVybiBodWxsICYmIGFyZWEoaHVsbCk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaHVsbEcgPSBzdmcuYXBwZW5kKFwiZ1wiKS5hdHRyKFwiaWRcIiwgXCJnSHVsbHNcIik7XHJcbiAgY29uc3QgaHVsbCA9IGh1bGxHXHJcbiAgICAuc2VsZWN0QWxsKFwicGF0aC5odWxsXCIpXHJcbiAgICAuZGF0YShcclxuICAgICAgZ3JhcGguY2x1c3RlcnMuZmlsdGVyKGQgPT4gIXRydWUgfHwgZFswXSAhPT0gXCJLaG91cnkgQ29sbGVnZSBvZiBDb21wdXRlciBTY2llbmNlc1wiKSxcclxuICAgICAgZCA9PiBkWzBdXHJcbiAgICApXHJcbiAgICAuam9pbihcInBhdGhcIilcclxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJodWxsXCIpXHJcbiAgICAuYXR0cihcImZpbGxcIiwgZCA9PiBodWxsQ29sb3IoZFswXSkpXHJcbiAgICAuYXR0cihcIm9wYWNpdHlcIiwgMC4zKVxyXG4gICAgLmF0dHIoXCJwb2ludGVyLWV2ZW50c1wiLCBcIm5vbmVcIik7XHJcblxyXG4gIGNvbnN0IGxpbmtHID0gc3ZnLmFwcGVuZChcImdcIikuYXR0cihcImlkXCIsIFwiZ0xpbmtzXCIpO1xyXG4gIGNvbnN0IGxpbmsgPSBsaW5rR1xyXG4gICAgLmF0dHIoXCJzdHJva2VcIiwgXCIjOTk5YVwiKVxyXG4gICAgLmF0dHIoXCJzdHJva2Utb3BhY2l0eVwiLCAxKVxyXG4gICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgMC41KVxyXG4gICAgLmF0dHIoXCJzdHJva2UtbGluZWNhcFwiLCBcInJvdW5kXCIpXHJcbiAgICAuc2VsZWN0QWxsKFwibGluZVwiKVxyXG4gICAgLmRhdGEoXHJcbiAgICAgIGdyYXBoLmxpbmtzLmZpbHRlcihkID0+IGZjbGFiZWxzX2NoZWNrLnNob3dHcm91cGluZ05vZGVzIHx8IGQudGFyZ2V0LnR5cGUgPT09IFwiQmlvZWNvbm9teVwiKSxcclxuICAgICAgZCA9PiBgJHtkLnNvdXJjZS5uYW1lfS0ke2QudGFyZ2V0Lm5hbWV9YFxyXG4gICAgKVxyXG4gICAgLmpvaW4oXCJsaW5lXCIpO1xyXG5cclxuICBjb25zdCBub2RlRyA9IHN2Zy5hcHBlbmQoXCJnXCIpLmF0dHIoXCJpZFwiLCBcImdOb2Rlc1wiKTtcclxuXHJcbiAgLy8gQ3JlYXIgbGFiZWxzIHBhcmEgQmlvZWNvbm9teSB5IG5vZG9zIGdyaXNlcyBwcmltZXJvXHJcbiAgY29uc3QgZ2V0TmFtZUFycmF5ID0gZnVuY3Rpb24gKGQpIHtcclxuICAgIHJldHVybiBkLm5hbWVBcnJheSA/IGQubmFtZUFycmF5IDogZC5uYW1lLnNwbGl0KFwiIFwiKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBsaW5lV2lkdGggPSAxLjk7XHJcblxyXG4gIGNvbnN0IGNyZWF0ZUxhYmVscyA9IGZ1bmN0aW9uIChfZGF0YSwgY2xhc3NOYW1lID0gXCJCaW9lY29ub215TGFiZWxcIikge1xyXG4gICAgcmV0dXJuIHN2Z1xyXG4gICAgICAuc2VsZWN0QWxsKGB0ZXh0LiR7Y2xhc3NOYW1lfWApXHJcbiAgICAgIC5kYXRhKF9kYXRhLCBkID0+IGQubmFtZSlcclxuICAgICAgLmpvaW4oXCJ0ZXh0XCIpXHJcbiAgICAgIC5hdHRyKFwiY2xhc3NcIiwgY2xhc3NOYW1lKVxyXG4gICAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsIFwibWlkZGxlXCIpXHJcbiAgICAgIC5hdHRyKFwiZm9udC1zaXplXCIsIGQgPT4gYCR7ZmhwYWRkaW5nX2JveC5mb250U2l6ZSAqIChkLnR5cGUgPT09IFwiQmlvZWNvbm9teVwiID8gZC5yIC8gZmhlaWdodF9ub2RlLm5vZGVTaXplIC8gMiA6IDEuOCl9cHRgKVxyXG4gICAgICAuYXR0cihcImZvbnQtd2VpZ2h0XCIsIGQgPT4gKGQudHlwZSA9PT0gXCJCaW9lY29ub215XCIgPyBcImxpZ2h0XCIgOiBcImJvbGRlclwiKSlcclxuICAgICAgLmF0dHIoXCJmb250LWZhbWlseVwiLCBcIk9zd2FsZFwiKVxyXG4gICAgICAuYXR0cihcInBvaW50ZXItZXZlbnRzXCIsIFwibm9uZVwiKVxyXG4gICAgICAuc3R5bGUoXCJjbGlwLXBhdGhcIiwgZCA9PiBmY2xhYmVsc19jaGVjay5jbGlwTGFiZWxzICYmIGQudHlwZSA9PT0gXCJCaW9lY29ub215XCIgPyBgY2lyY2xlKCR7ZC5yIC0gMn1weClgIDogXCJcIilcclxuICAgICAgLmVhY2goZnVuY3Rpb24gKGQpIHtcclxuICAgICAgICBkMy5zZWxlY3QodGhpcylcclxuICAgICAgICAgIC5zZWxlY3RBbGwoXCJ0c3BhblwiKVxyXG4gICAgICAgICAgLmRhdGEoZ2V0TmFtZUFycmF5KGQpKVxyXG4gICAgICAgICAgLmpvaW4oXCJ0c3BhblwiKVxyXG4gICAgICAgICAgLmF0dHIoXCJ4XCIsIDApXHJcbiAgICAgICAgICAuYXR0cihcImR5XCIsIGxpbmVXaWR0aCArIFwiY2hcIilcclxuICAgICAgICAgIC50ZXh0KG4gPT4gbik7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5hdHRyKFwieVwiLCBkID0+IChnZXROYW1lQXJyYXkoZCkubGVuZ3RoIC8gMikgKiAtbGluZVdpZHRoICsgXCJjaFwiKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBsYWJlbCA9IGNyZWF0ZUxhYmVscyhcclxuICAgIGdyYXBoLm5vZGVzLmZpbHRlcihkID0+IGQudHlwZSA9PT0gXCJCaW9lY29ub215XCIgPyBkLmRlZ3JlZSA+PSBmaHBhZGRpbmdfYm94Lm1pbkRlZ3JlZSA6IDApLFxyXG4gICAgXCJCaW9lY29ub215TGFiZWxcIlxyXG4gICk7XHJcblxyXG4gIGNvbnN0IGxhYmVsRGVwdHMgPSBjcmVhdGVMYWJlbHMoXHJcbiAgICBncmFwaC5ub2Rlcy5maWx0ZXIoZCA9PiBkLnR5cGUgIT09IFwiQmlvZWNvbm9teVwiKSxcclxuICAgIFwiZGVwYXJ0bWVudExhYmVsXCJcclxuICApO1xyXG5cclxuICAvLyBDcmVhciBub2RvcyB5IGHDsWFkaXIgaW3DoWdlbmVzIHNvYnJlIGxvcyBsYWJlbHNcclxuICBjb25zdCBub2RlID0gbm9kZUdcclxuICAgIC5zZWxlY3RBbGwoXCJjaXJjbGVcIilcclxuICAgIC5kYXRhKFxyXG4gICAgICBncmFwaC5ub2Rlcy5maWx0ZXIoZCA9PiBmY2xhYmVsc19jaGVjay5zaG93R3JvdXBpbmdOb2RlcyB8fCBkLnR5cGUgPT09IFwiQmlvZWNvbm9teVwiKSxcclxuICAgICAgZCA9PiBkLm5hbWVcclxuICAgIClcclxuICAgIC5qb2luKFwiY2lyY2xlXCIpXHJcbiAgICAuYXR0cihcImZpbGxcIiwgZCA9PiAoZC50eXBlICE9PSBcIkJpb2Vjb25vbXlcIiA/IFwiIzk5OVwiIDogaHVsbENvbG9yKGQuY2x1c3RlcikpKVxyXG4gICAgLmF0dHIoXCJzdHJva2Utb3BhY2l0eVwiLCAxKVxyXG4gICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgMSlcclxuICAgIC5hdHRyKFwiclwiLCBkID0+IGQucilcclxuICAgIC5jYWxsKGRyYWcoc2ltdWxhdGlvbikpO1xyXG5cclxuICBjb25zdCBpbWFnZXMgPSBub2RlR1xyXG4gICAgLnNlbGVjdEFsbChcImltYWdlXCIpXHJcbiAgICAuZGF0YShcclxuICAgICAgZmNsYWJlbHNfY2hlY2sudXNlSW1hZ2VzXHJcbiAgICAgICAgPyBncmFwaC5ub2Rlcy5maWx0ZXIoZCA9PiBkLmxvZ29fdml6KVxyXG4gICAgICAgIDogW10sXHJcbiAgICAgIGQgPT4gZC5uYW1lXHJcbiAgICApXHJcbiAgICAuam9pbihcImltYWdlXCIpXHJcbiAgICAuYXR0cihcImhyZWZcIiwgZCA9PiBkLmxvZ29fdml6KVxyXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCBkID0+IGQuciAqIDIgLSA0KVxyXG4gICAgLmF0dHIoXCJoZWlnaHRcIiwgZCA9PiBkLnIgKiAyIC0gNClcclxuICAgIC5hdHRyKFwic3Ryb2tlXCIsIFwiYmxhY2tcIilcclxuICAgIC5hdHRyKFwicHJlc2VydmVBc3BlY3RSYXRpb1wiLCBcInhNaWRZTWlkIHNsaWNlXCIpXHJcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBkID0+IGB0cmFuc2xhdGUoLSR7ZC5yIC0gMn0sIC0ke2QuciAtIDJ9KWApXHJcbiAgICAuc3R5bGUoXCJjbGlwLXBhdGhcIiwgZCA9PiBgY2lyY2xlKCR7ZC5yIC0gMn1weClgKVxyXG4gICAgLmNhbGwoZHJhZyhzaW11bGF0aW9uKSk7XHJcbiAgXHJcbiAgZnVuY3Rpb24gdXBkYXRlVmlzaWJpbGl0eSgpIHtcclxuICBsYWJlbC5hdHRyKFwiZGlzcGxheVwiLCBmY2xhYmVsc19jaGVjay51c2VJbWFnZXMgPyBcIm5vbmVcIiA6IFwiYmxvY2tcIik7XHJcbiAgaW1hZ2VzLmF0dHIoXCJkaXNwbGF5XCIsIGZjbGFiZWxzX2NoZWNrLnVzZUltYWdlcyA/IFwiYmxvY2tcIiA6IFwibm9uZVwiKTtcclxufVxyXG4gIHVwZGF0ZVZpc2liaWxpdHkoKTtcclxuICBmdW5jdGlvbiB0aWNrZWQoKSB7XHJcbiAgICBsaW5rXHJcbiAgICAgIC5hdHRyKFwieDFcIiwgZCA9PiBkLnNvdXJjZS54KVxyXG4gICAgICAuYXR0cihcInkxXCIsIGQgPT4gZC5zb3VyY2UueSlcclxuICAgICAgLmF0dHIoXCJ4MlwiLCBkID0+IGQudGFyZ2V0LngpXHJcbiAgICAgIC5hdHRyKFwieTJcIiwgZCA9PiBkLnRhcmdldC55KTtcclxuXHJcbiAgICBsYWJlbC5hdHRyKFwidHJhbnNmb3JtXCIsIGQgPT4gYHRyYW5zbGF0ZSgke2QueH0sICR7ZC55fSlgKS5jbGFzc2VkKFwic2hhZG93XCIsIHNpbXVsYXRpb24uYWxwaGEoKSA8PSAwLjEpO1xyXG4gICAgbGFiZWxEZXB0cy5hdHRyKFwidHJhbnNmb3JtXCIsIGQgPT4gYHRyYW5zbGF0ZSgke2QueH0sICR7ZC55fSlgKS5jbGFzc2VkKFwic2hhZG93XCIsIHNpbXVsYXRpb24uYWxwaGEoKSA8PSAwLjEpO1xyXG4gICAgXHJcbiAgICBub2RlLmF0dHIoXCJjeFwiLCBkID0+IGQueCkuYXR0cihcImN5XCIsIGQgPT4gZC55KS5jbGFzc2VkKFwic2hhZG93XCIsIHNpbXVsYXRpb24uYWxwaGEoKSA8PSAwLjEpO1xyXG5cclxuICAgIGlmIChmY2xhYmVsc19jaGVjay51c2VJbWFnZXMpIHtcclxuICAgICAgaW1hZ2VzLmF0dHIoXCJ4XCIsIGQgPT4gZC54KS5hdHRyKFwieVwiLCBkID0+IGQueSk7XHJcbiAgICB9XHJcblxyXG4gICAgaHVsbC5hdHRyKFwiZFwiLCBnZXRIdWxsKTtcclxuICB9XHJcblxyXG4gIHNpbXVsYXRpb24ub24oXCJ0aWNrXCIsIHRpY2tlZCk7XHJcblxyXG4gIGZ1bmN0aW9uIGRyYWcoc2ltdWxhdGlvbikge1xyXG4gICAgZnVuY3Rpb24gZHJhZ3N0YXJ0ZWQoZXZlbnQpIHtcclxuICAgICAgaWYgKCFldmVudC5hY3RpdmUpIHNpbXVsYXRpb24uYWxwaGFUYXJnZXQoMC4zKS5yZXN0YXJ0KCk7XHJcbiAgICAgIGV2ZW50LnN1YmplY3QuZnggPSBldmVudC5zdWJqZWN0Lng7XHJcbiAgICAgIGV2ZW50LnN1YmplY3QuZnkgPSBldmVudC5zdWJqZWN0Lnk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZHJhZ2dlZChldmVudCkge1xyXG4gICAgICBldmVudC5zdWJqZWN0LmZ4ID0gZXZlbnQueDtcclxuICAgICAgZXZlbnQuc3ViamVjdC5meSA9IGV2ZW50Lnk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZHJhZ2VuZGVkKGV2ZW50KSB7XHJcbiAgICAgIGlmICghZXZlbnQuYWN0aXZlKSBzaW11bGF0aW9uLmFscGhhVGFyZ2V0KDApO1xyXG4gICAgICBldmVudC5zdWJqZWN0LmZ4ID0gbnVsbDtcclxuICAgICAgZXZlbnQuc3ViamVjdC5meSA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGQzXHJcbiAgICAgIC5kcmFnKClcclxuICAgICAgLm9uKFwic3RhcnRcIiwgZHJhZ3N0YXJ0ZWQpXHJcbiAgICAgIC5vbihcImRyYWdcIiwgZHJhZ2dlZClcclxuICAgICAgLm9uKFwiZW5kXCIsIGRyYWdlbmRlZCk7XHJcbiAgfVxyXG5cclxuXHJcbiAgaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gc2ltdWxhdGlvbi5zdG9wKCkpO1xyXG4gIHRpY2tlZCgpO1xyXG5cclxuICByZXR1cm4gaHRsLmh0bWxgPGRpdj5cclxuICAgIDxoMj4gYmlvZWNvbm9teSBlbmFibGluZyBuZXR3b3JrcyBieSAke2dyb3VwQnl9PC9oMj5cclxuICAgICR7c3ZnLm5vZGUoKX1cclxuICA8L2Rpdj5gO1xyXG59O1xyXG5cclxuXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgY29sb3JJbnRlcnBvbGF0b3IgPSB7XHJcbiAgY29uc3QgY29sb3JTY2hlbWVzID0gW1xyXG4gICAgXCJpbnRlcnBvbGF0ZUJsdWVzXCIsXHJcbiAgICBcImludGVycG9sYXRlQnJCR1wiLFxyXG4gICAgXCJpbnRlcnBvbGF0ZVJkQnVcIixcclxuICAgIFwiaW50ZXJwb2xhdGVSZFlsR25cIixcclxuICAgIFwiaW50ZXJwb2xhdGVSZWRzXCIsXHJcbiAgICBcImludGVycG9sYXRlU2luZWJvd1wiLFxyXG4gICAgXCJpbnRlcnBvbGF0ZVNwZWN0cmFsXCIsXHJcbiAgICBcImludGVycG9sYXRlVHVyYm9cIixcclxuICAgIFwiaW50ZXJwb2xhdGVWaXJpZGlzXCIsXHJcbiAgXTtcclxuICBjb25zdCBjb2xvcnMgPSBuZXcgTWFwKFxyXG4gICAgW1tcIkN1c3RvbSBUdXJib1wiLCAodCkgPT4gZDMuaW50ZXJwb2xhdGVUdXJibygwLjIgKyB0ICogMC44KV1dLmNvbmNhdChcclxuICAgICAgY29sb3JTY2hlbWVzLm1hcCgoYykgPT4gW2MsIGQzW2NdXSlcclxuICAgIClcclxuICApO1xyXG5cclxuICByZXR1cm4gSW5wdXRzLnNlbGVjdChjb2xvcnMsIHtcclxuICAgIGxhYmVsOiBcIkNvbG9yIFNjaGVtZVwiLFxyXG4gICAgZm9ybWF0OiAoZCkgPT4gZFswXVxyXG4gIH0pO1xyXG59XHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgZmhwYWRkaW5nX2JveCA9IChcclxuICBJbnB1dHMuZm9ybSh7XHJcbiAgICBodWxsUGFkZGluZzogSW5wdXRzLnJhbmdlKFswLCAxMDBdLCB7bGFiZWw6IFwiSHVsbCBQYWRkaW5nXCIsIHZhbHVlOiA5LCBzdGVwOiAxfSksXHJcbiAgICBtaW5EZWdyZWU6IElucHV0cy5yYW5nZShbMCwgZDMubWF4KGdyYXBoLm5vZGVzLCAoZCkgPT4gZC5kZWdyZWUpICsgMV0sIHtcclxuICAgICAgbGFiZWw6IFwiTWluIERlZ3JlZSBmb3IgTGFiZWxcIixcclxuICAgICAgdmFsdWU6IDEsXHJcbiAgICAgIHN0ZXA6IDFcclxuICAgIH0pLFxyXG4gICAgZm9udFNpemU6IElucHV0cy5yYW5nZShbMSwgMzZdLCB7bGFiZWw6IFwiRm9udCBzaXplXCIsIHZhbHVlOiA1LCBzdGVwOiAxfSksXHJcbiAgICBncmV5Tm9kZVNpemU6IElucHV0cy5yYW5nZShbMSwgMzBdLCB7bGFiZWw6IFwiQ29ubmVjdGluZyBOb2RlIFNpemVcIiwgdmFsdWU6IDUsIHN0ZXA6IDF9KVxyXG4gIH0sXHJcbiAge1xyXG4gICAgdGVtcGxhdGU6IHRlbXBsYXRlXzQgLy8gRXNwZWPDrWZpY2FtZW50ZSB1c2FuZG8gdGVtcGxhdGVfNCBwYXJhIDQgY29sdW1uYXNcclxuICB9KVxyXG4pO1xyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTI4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGZjbGFiZWxzX2NoZWNrID0gKFxyXG4gIElucHV0cy5mb3JtKHtcclxuICB1c2VJbWFnZXM6SW5wdXRzLnRvZ2dsZSh7bGFiZWw6IFwiVXNlIEltYWdlc1wiLCB2YWx1ZTogdHJ1ZX0pLFxyXG4gIHNob3dHcm91cGluZ05vZGVzOklucHV0cy50b2dnbGUoe2xhYmVsOiBcIlNob3cgZ3JleSBub2Rlc1wiLCB2YWx1ZTogdHJ1ZX0pLFxyXG4gIGNsaXBMYWJlbHM6IElucHV0cy50b2dnbGUoe2xhYmVsOiBcIkNsaXAgTGFiZWxzXCIsIHZhbHVlOiB0cnVlfSksXHJcbiAgdXNlU2hhZG93c1RleHQ6IElucHV0cy50b2dnbGUoe2xhYmVsOiBcIlVzZSBUZXh0IFNoYWRvd3NcIiwgdmFsdWU6IHRydWV9KX0sXHJcbiAge1xyXG4gICAgdGVtcGxhdGU6IHRlbXBsYXRlXzQgXHJcbiAgfSlcclxuICApXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmaWx0ZXJlZFNraWxsc0RhdGEgPSB7XHJcbiAgY29uc3QgY29sdW1uID0gZ3JvdXBCeTsgLy8gT2J0w6luIGxhIGNvbHVtbmEgc2VsZWNjaW9uYWRhIGVuIGVsIHNlbGVjdG9yIHZpZXdvZiBncm91cEJ5XHJcbiAgcmV0dXJuIGFxXHJcbiAgICAuZnJvbShza2lsbHNEYXRhKVxyXG4gICAgLnBhcmFtcyh7IGNvbHVtbiB9KSAvLyBEZWZpbmUgXCJjb2x1bW5cIiBjb21vIHVuIHBhcsOhbWV0cm8gZGluw6FtaWNvXHJcbiAgICAuZmlsdGVyKGQgPT4gZC50aXBvX2hhYmlsaWRhZCA9PT0gY29sdW1uKTsgLy8gVXNhIGVsIHBhcsOhbWV0cm8gZGluw6FtaWNvXHJcbn1cclxuXHJcbnZpZXdvZiBza2lsbHNUYWJsZSA9IElucHV0cy50YWJsZShcclxuICBmaWx0ZXJlZFNraWxsc0RhdGEub2JqZWN0cygpLCAvLyBDb252aWVydGUgbG9zIGRhdG9zIGZpbHRyYWRvcyBlbiB1biBhcnJlZ2xvIGRlIG9iamV0b3NcclxuICB7XHJcbiAgICBsYXlvdXQ6IFwiZml4ZWRcIiwgLy8gRmlqYSBlbCBkaXNlw7FvIGRlIGxhIHRhYmxhXHJcbiAgICB3aWR0aDogeyAgICAgICAgIC8vIERlZmluZSBlbCBhbmNobyBwYXJhIGNhZGEgY29sdW1uYVxyXG4gICAgICB0aXBvX2hhYmlsaWRhZDogXCIyMCVcIiwgLy8gMjAlIGRlbCBhbmNobyB0b3RhbFxyXG4gICAgICBoYWJpbGlkYWQ6IFwiNjAlXCIsICAgICAgLy8gNjAlIGRlbCBhbmNobyB0b3RhbFxyXG4gICAgICBjYW50aWRhZDogXCIyMCVcIiAgICAgICAgLy8gMjAlIGRlbCBhbmNobyB0b3RhbFxyXG4gICAgfSxcclxuICAgIHNvcnRhYmxlOiB0cnVlLCAgIC8vIFBlcm1pdGUgb3JkZW5hciBsYXMgY29sdW1uYXNcclxuICAgIGZpbHRlcmFibGU6IHRydWUsIC8vIFBlcm1pdGUgZmlsdHJhciBsYXMgY29sdW1uYXNcclxuICAgIHJvd3M6IDEwICAgICAgICAgIC8vIE11ZXN0cmEgMTAgZmlsYXMgcG9yIHDDoWdpbmFcclxuICB9XHJcbik7XHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnbWluRGF0ZScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdncm91cEJ5JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NlbGVjdGVkVGFyZ2V0cycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdmaGVpZ2h0X25vZGUnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnY29sb3JJbnRlcnBvbGF0b3InKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnZmhwYWRkaW5nX2JveCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdmY2xhYmVsc19jaGVjaycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdza2lsbHNUYWJsZScpIn1dfQ==
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../..";
window._ojs.paths.runtimeToRoot = "../../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>